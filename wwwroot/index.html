<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>DCSoft.WASM</title>

    <!--<script src="./loginResource/api/api.js"></script>
    <script>
        // 解开后，将启用用户登录功能
        try {
            var userAndPassword = localStorage.getItem('userLoginInfo');
            if (userAndPassword == null || userAndPassword.length == 0) {
                //hasUser = false;
                // $.messager.alert('警告','未查询到用户名和密码,需重新登录' , function (r) {
                //    window.location.href = './login.html'
                // });
                //window.alert('未查询到用户名和密码,需重新登录');
                window.location.href = './login.html?isNoUser=true'
            } else {
                //解析html
                var obj = JSON.parse(userAndPassword);
                let nowDate = +new Date();
                let ExpirationDuration = 604800000 //7天，单位:毫秒 
                if ((obj.loginDate && ((nowDate - obj.loginDate) >= ExpirationDuration)) || (!obj.UserName || !obj.UserPwd)) {
                    //hasUser = false;
                    // $.messager.alert('警告', '未查询到正确的用户名或密码，需重新登录', function (r) {
                    //    window.location.href = './login.html'
                    // });
                    //window.alert('未查询到正确的用户名或密码，需重新登录');
                    window.location.href = './login.html?isNoUser=true'
                }
            }
        } catch (error) {
            var paramList = window.location.search.substr(1).split('&')
            if (paramList.length == 3) {
                let user = atob(paramList[0])
                let password = atob(paramList[1])
                let obj = {
                    UserName: user.split('=')[1],
                    UserPwd: password.split('=')[1],
                }
                DCLogin(obj, res => {
                    let code = $(res).find('string').text()
                    if (code == '验证成功') {
                        console.log(code);
                        let time = atob(paramList[2])
                        if (Date.now() - time > 30000) {
                            window.location.href = './login.html?isNoUser=true'
                            alert('浏览器阻止Cookie,请允许所有Cookie')
                        }
                    } else {
                        window.location.href = './login.html?isNoUser=true'
                    }
                })
            } else {
                window.location.href = './login.html?isNoUser=true'
            }
        }

    </script> -->
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="./js/easyui/easyui.css" rel="stylesheet" />
    <script src="http://www.dcwriter.cn:8099/Jquery/jquery-1.7.2.min.js"></script>

    <style>
        html,
        body {
            height: 100%;
            overflow: hidden;
        }

        #box {
            width: 100%;
            height: calc(100% - 160px);
        }

        #tt {
            height: 100%;
            overflow: hidden;
            background-color: white;
        }

        .tabs-panels {
            height: calc(100% - 34px);
        }

        .tabs-panels>.panel-htop,
        .panel-body {
            height: 100%;
        }

        .tabs-title-change::after {
            content: '*';
            margin-left: 5px;
        }

        .tabs li.tabs-selected a.tabs-inner {
            border-radius: 1px;
        }

        .tabs-title {
            font-size: 14px;
            font-family: "宋体";
        }

        .l-btn-text {
            font-size: 14px;
            font-family: "宋体";
        }

        #myWriterControl {
            border: 2px solid #e6e6e6;
        }

        .tabs-header,
        .tabs-scroller-left,
        .tabs-scroller-right,
        .tabs-tool,
        .tabs,
        .tabs-panels,
        .tabs li a.tabs-inner,
        .tabs-header-right {
            border-color: transparent !important;
        }

        .tabs-header,
        .tabs-tool {
            background-color: #e6e6e6;
            /* background-color: #fff; */
        }

        .panel-body {
            border-bottom: 1px solid #c6c6c6;
        }

        .presentationDocumentBox {
            width: 300px;
            background-color: #fff;
            box-sizing: border-box;
            /* overflow-y: auto !important; */
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .presentationDocumentContent {
            flex: 1;
            overflow: auto;
            padding-left: 20px;
            padding-bottom: 10px;

        }

        .parentItem {
            text-align: left;
            line-height: 30px;
            font-size: 14px;
        }

        .parentItem_p:hover {
            cursor: pointer;
            background: linear-gradient(to bottom, #EFF5FF 0, #E0ECFF 100%);
        }

        .parentItem_p {
            font-family: '宋体';
            display: inline-block;

        }

        .childrenItem {
            text-align: left;
            margin-left: 20px;
            cursor: pointer;
            display: none;
            line-height: 30px;
            height: 30px;
        }

        .childrenItem_p {
            display: inline-block;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            width: 100%;
            display: inline-block;
            font-family: '宋体';
        }

        .fileTextImg {
            width: 16px;
            height: 16px;
            display: inline-block;
            margin-top: -3px;
            margin-right: 4px;
        }

        .wjjImg {
            width: 24px;
            height: 24px;
            display: inline-block;
            margin-right: 5px;
            margin-top: -4px;
        }

        .childrenItem:hover {
            background: linear-gradient(to bottom, #EFF5FF 0, #E0ECFF 100%);
        }

        .disableButton {
            cursor: no-drop;
            color: #8c8c8c;
        }

        .presentationDocumentBox .head {
            line-height: 24px;
            text-align: center;
            font-size: 24px;
            font-weight: 700;
            margin: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid;
        }

        .backImg {
            cursor: pointer;
            width: 26px;
            height: 26px;
            position: absolute;
            right: 2px;
            top: 5px;
        }

        .presentationDocumentBox .tabBox .tabItem {
            height: 30px;
            line-height: 30px;
            padding: 0 6px;
            border-radius: 2px;
            margin-right: 4px;
            background: linear-gradient(to bottom, #EFF5FF 0, #E0ECFF 100%);
            cursor: pointer;
        }

        .presentationDocumentBox .tabBox .tabItem.active {
            background: #ffffff;
            color: #3f51b5;
            font-weight: bold;
            outline: none;
        }

        /* .presentationDocumentBox #courseListBox, */
        .presentationDocumentBox #TracesList,
        .presentationDocumentBox #DragElementList {
            display: none;
        }

        .resize {
            width: 2px;
            height: 100%;
            background-color: #fff;
            cursor: w-resize;
            float: left;
            border-right: 1px solid #c6c6c6;
            display: none;
        }

        .presentationDocumentBox .tabBox {
            display: flex;
            width: 100%;
            border-bottom: 1px solid #d2d2d2;
            font-size: 14px;
            background: #e6e6e6;
            padding-top: 3px;
            box-sizing: border-box;
            font-family: "宋体";
        }

        .presentationDocumentBox .boxItem {
            flex: 1;
            height: 100%;
            overflow: auto;
        }

        .presentationDocumentBox .boxItem .listItem {
            overflow: auto;
            padding-left: 20px;
            padding-bottom: 10px;
            height: calc(100% - 56px);
        }

        .courseListItem {
            text-align: left;
            line-height: 30px;
            font-size: 14px;
        }

        .courseListItem_p {
            font-family: '宋体';
            display: inline-block;
            width: 100%;
            cursor: pointer;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            width: 100%;
        }

        .courseListItem:hover {
            background: linear-gradient(to bottom, #EFF5FF 0, #E0ECFF 100%);
        }

        .refreshImg {
            cursor: pointer;
            width: 22px;
            height: 22px;
            float: right;
        }

        .presentationDocumentBox .TracesListContentItem {
            width: 100%;
            display: flex;
            flex-direction: column;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            box-sizing: border-box;
            margin-bottom: 14px;
            font-size: 13px;
            box-shadow: 0 2px 12px 0 rgba(0, 0, 0, .1);
            background: #fff;
            cursor: pointer;
        }

        .presentationDocumentBox .TracesListContentItem:hover {
            transform: scale(101%);
        }

        .presentationDocumentBox .boxItem .TracesListContent {
            padding: 0 10px;
            box-sizing: border-box;
        }

        #abortText {
            height: 20px;
            text-align: left;
            background-color: #e6e6e6;
            border-bottom: 1px solid black;
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
        }

        #FullScreenButton {
            position: fixed;
            top: 23px;
            right: 24px;
            cursor: pointer;
            width: 34px;
            height: 34px;
            background: #fff;
            padding: 4px;
            border-bottom: 1px solid #ccc;
            border-radius: 4px;
        }

        #FullScreenButton:hover,
        #EXIDFullScreenButton:hover {
            background: #ecf5ff;
            transform: scale(1.1);
        }

        #EXIDFullScreenButton {
            position: fixed;
            top: 23px;
            right: 24px;
            cursor: pointer;
            width: 34px;
            height: 34px;
            background: #fff;
            padding: 4px;
            border-bottom: 1px solid #ccc;
            border-radius: 4px;
        }

        #scaleBox {
            position: fixed;
            right: 0;
            width: 300px;
            height: 20px;
            padding: 8px 5px;
            bottom: 3px;
            z-index: 9;
        }

        #progress {
            height: 6px;
            width: 200px;
            background-color: #fff;
            border-radius: 5px;
            position: relative;
        }

        #progress_pill {
            position: absolute;
            border-radius: 5px 0 0px 5px;
            height: 100%;
            background-color: #b1caeb;
            left: 0;
            top: 0;
            width: 37px;
        }

        #progress #bar {
            position: absolute;
            top: -2px;
            left: 37px;
            height: 10px;
            width: 10px;
            background-color: #b1caeb;
            cursor: pointer;
        }

        .confirmContent {
            position: fixed;
            top: 50%;
            left: 50%;
            background: #e6f0ff;
            width: 300px;
            height: 200px;
            padding: 10px;
            box-sizing: border-box;
            font-size: 14px;
            z-index: 999;
        }

        .confirmContentHeader {
            width: 100%;
            height: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 900;
        }

        .confirmContentClose {
            width: 24px;
            height: 24px;
        }

        .confirmContainer {
            height: 108px;
            background: #FFF;
            padding: 10px 20px;
        }

        .confirmButtons {
            width: 100%;
            height: 43px;
            border-color: #dddddd #ffffff #ffffff #ffffff;
            background: #F4F4F4;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .confirmYes,
        .confirmNo {
            width: 70px;
            height: 30px;
            background: #fff;
            color: #000000;
            border: 1px solid #ccc;
            filter: none;
            border-radius: 4px;
            text-align: center;
            line-height: 30px;
            margin: 0 2px;
        }

        .confirmYes:hover,
        .confirmNo:hover {
            background: #e6f0ff;
            border: 1px solid #b7d2ff;
        }

        .colorBox {
            width: 300px;
            height: 330px;
            position: fixed;
            background: #ccc;
            z-index: 99;
        }

        .colorBox button {
            width: 80px;
            cursor: pointer;
            background: #fff;
            border: 1px solid #dcdfe6;
            color: #606266;
            height: 30px;
            box-shadow: 0px 0px 1px 0px #999;
            margin-right: 10px;
        }

        .colorBox button:hover {
            color: #409eff;
            background: #ecf5ff;
            border-color: #b3d8ff;
        }

        .color_container {
            width: 300px;
            padding: 10px;
            font-size: 0;
        }

        .color_container>div {
            display: inline-block;
            background: #fff;
            vertical-align: top;
            box-shadow: 0px 0px 5px 0px #999;
        }

        .color_container .main_con {
            width: 260px;
            height: 200px;
            background: red;
        }

        .color_container .main_con .bg {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        .color_container .main_con .left_white_bg {
            background: linear-gradient(to right, #fff 0%, transparent 100%)
        }

        .color_container .main_con .bottom_black_bg {
            background: linear-gradient(to bottom, transparent 0%, #000 100%);
        }

        .color_container .side_con {
            width: 10px;
            height: 200px;
            background: linear-gradient(to bottom, red 0%, #ff0 17%, lime 33%, cyan 50%, blue 66%, #f0f 83%, red 100%)
        }

        .color_container .main_wrap,
        .color_container .side_wrap {
            position: relative;
        }

        .color_container .side_wrap {
            margin-left: 10px;
        }

        .color_container .main_drag,
        .color_container .side_drag {
            position: absolute;
            border: 1px solid #fff;
            background: rgba(0, 0, 0, .3);
            cursor: pointer;
        }

        .color_container .main_drag {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            z-index: 3;
            left: -7px;
            top: -7px;
        }

        .color_container .side_drag {
            height: 8px;
            width: 16px;
            border-radius: 2px;
            left: -3px;
            top: -4px;
        }

        .color_container .find_color {
            width: 60px;
            height: 60px;
            position: absolute;
            top: 0;
            left: -70px;
            background: #fff;
        }

        .color_container .show_color {
            margin: 10px 0 0;
            display: block;
            height: auto;
        }

        .color_container .color_full {
            display: inline-block;
            width: 58px;
            height: 58px;
            border: 1px solid #ccc;
        }

        .color_container .color_text {
            display: inline-block;
            margin-left: 30px;
            height: 58px;
            line-height: 58px;
            text-align: center;
            font-size: 14px;
            vertical-align: top;
        }

        .color_container .color_text input {
            width: 36px;
            border: none;
        }

        #RenderColor,
        #RenderBackColor {
            width: 50px;
            height: 20px;
            border: 1px solid #000;
            background: #000;
            display: inline-block;
        }

        #RenderBackColor {
            background: #fff;
        }

        #colorDialogBox {
            width: 100%;
            height: 100%;
            opacity: 0;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 9;
            background: #ccc;
        }

        .dragElementItem {
            cursor: pointer;
            font-size: 14px;
            width: 100%;
            line-height: 28px;
            padding: 0 5px;
            box-sizing: border-box;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .dragElementItem>p {
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .dragChildrenItem {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .dragElementItemNodeText:hover {
            background: linear-gradient(to bottom, #EFF5FF 0, #E0ECFF 100%);
        }

        .dragChildrenItem {
            margin-left: 20px;
        }

        .dragChildrenItem:hover {
            background: linear-gradient(to bottom, #EFF5FF 0, #E0ECFF 100%);
        }
    </style>
</head>

<body style="background-color:gray;text-align:center;width: 100%;height: 100%;" onload="dragControllerDiv()">
    <div style="text-align:left;background-color:#e0ecff;width: 100%;height: 100%;">
        <!-- 这是最上层的工具栏 -->
        <div class="easyui-ribbon" id="sqcd" style="width: 100%; height: 140px">
            <div title="文件">
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="关于" class="easyui-linkbutton" data-options="plain:true"
                            onclick="GetCurrentWriterControl().ShowAboutDialog()">关于</a><br />
                        <a href="#" title="打开" class="easyui-linkbutton" data-options="plain:true"
                            onclick="fileOpen()">打开</a><br />
                        <a href="#" title="新建" class="easyui-linkbutton" data-options="plain:true"
                            onclick="FileNew()">新建</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="保存XML" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SaveXmlString()">保存XML</a><br />
                        <a href="#" title="保存JSON" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SaveJsonString()">保存JSON</a><br />
                        <a href="#" id="presentationDocumentButton" isFlag="hide" title="演示文档" class="easyui-linkbutton"
                            data-options="plain:true" onclick="PresentationDocument()">演示文档</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="下载XML" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('xml');">下载Xml</a><br />
                        <a href="#" title="下载JSON" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('json');">下载Json</a><br />
                        <a href="#" title="下载TXT" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('text')">下载TXT</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="下载PDF" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('pdf');">下载Pdf</a><br />
                        <a href="#" title="下载Html" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('html');">下载Html</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('longimg');">下载长图片</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="下载RTF" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('rtf');">下载Rtf</a><br />
                        <a href="#" title="下载doc" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DownLoadFile('doc')">下载Doc</a><br />
                        <a href="#" title="刷新" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Refresh()">刷新</a><br />
                    </div>


                    <div class="ribbon-toolbar">
                        <a href="#" title="选择内容保存为Json" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SaveSelection('json')">选择内容保存为Json</a><br />
                        <a href="#" title="选择内容保存为TXT" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SaveSelection('txt')">选择内容保存为TXT</a><br />
                        <a href="#" title="选择内容保存为XML" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SaveSelection('xml')">选择内容保存为XML</a><br />
                    </div>


                    <div class="ribbon-group-title">文件</div>
                </div>
                <div class="ribbon-group-sep"></div>

                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="页面设置" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PageSetting()">页面设置</a><br />
                        <a href="#" title="文档网格线" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PageGridLine()">文档网格线</a><br />

                    </div>
                    <div class="ribbon-toolbar">

                        <a href="#" title="水印" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Watermark()">水印设置</a><br />
                        <a href="#" title="装订线" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Gutter()">装订线设置</a><br />

                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="违禁关键字" class="easyui-linkbutton" data-options="plain:true"
                            onclick="ExcludeKeywords()">设置违禁关键字</a><br />
                        <a href="#" title="获取违禁关键字" class="easyui-linkbutton" data-options="plain:true"
                            onclick="GetExcludeKeywords()">获取违禁关键字</a><br />
                        <a href="#" title="批注校验" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DocumentValueValidateWithCreateDocumentComments()">批注校验</a><br />

                    </div>
                    <div class="ribbon-group-title">页面设置</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="subdir/WriterPrintPreviewControl.html" target="_blank" class="easyui-linkbutton"
                            data-options="plain:true">打印预览控件</a><br />
                        <a href="./testDropDown.html" target="_blank" class="easyui-linkbutton"
                            data-options="plain:true">拖拽</a><br />
                        <a href="./testAssistList.html" target="_blank" class="easyui-linkbutton"
                            data-options="plain:true">快捷辅助录入</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="./indexCourseDisease.html" target="_blank" class="easyui-linkbutton"
                            data-options="plain:true">病程</a><br />
                        <a href="./performance/index.html" target="_blank" class="easyui-linkbutton"
                            data-options="plain:true">查看性能</a><br />
                        <a href="./testApi/index.html" target="_blank" class="easyui-linkbutton"
                            data-options="plain:true">测试API</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="GetCurrentWriterControl().__DCWriterReference.invokeMethod('BeginRecordUIEvent');">记录操作</a><br />
                        <a href="./testEventPage.html" target="_blank" class="easyui-linkbutton"
                            data-options="plain:true">事件</a><br />
                    </div>

                    <div class="ribbon-group-title">其他功能演示</div>
                </div>
            </div>
            <div title="编辑">
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="复制(Ctrl+C)" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true" onclick="Copy()">复制(Ctrl+C)</a><br />
                        <a href="#" title="粘贴(Ctrl+V)" class="easyui-linkbutton" onclick="Paste()"
                            data-options=" iconCls:'icon-paste-font',plain:true">粘贴(Ctrl+V)</a><br />

                    </div>
                    <div class="ribbon-toolbar">

                        <a href="#" title="纯文本复制" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CopyAsText()">纯文本复制</a><br />
                        <a href="#" title="纯文本粘贴" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="PasteAsText()">纯文本粘贴</a><br />
                        <a href="#" title="剪切(Ctrl+X)" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Cut()">剪切</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="撤销(Ctrl+Z)" onclick="Undo()" dccommandName="Undo"
                            data-options=" iconCls:'icon-undo-font',plain:true">撤销(Ctrl+Z)</a><br />
                        <a href="#" class="easyui-linkbutton" title="重做(Ctrl+Y)" onclick="Redo()" dccommandName="Redo"
                            data-options=" iconCls:'icon-redo-font',plain:true">重做(Ctrl+Y)</a><br />
                        <a href="#" class="easyui-linkbutton" title="查找" onclick="Search();"
                            data-options="plain:true">查找</a><br />
                    </div>
                    <div class="ribbon-group-title">常规</div>
                </div>

                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar" style="margin-right: 10px;">
                        <a href="#" title="字体" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Font()">字体</a><br />
                        <select style="width: 84px;margin:5px 0;" id="fontfamilySelect"
                            onchange="FontChange(this.options[this.selectedIndex].text)" class="colour">
                        </select><br />
                        <select style="width: 84px;" id="fontSizeSelect"
                            onchange="FontSize(this.options[this.selectedIndex].text)">
                            <!-- <option value="三号">三号</option>
                            <option value="小三">小三</option>
                            <option value="四号">四号</option>
                            <option value="小四">小四</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option> -->
                        </select><br />
                    </div>

                    <div class="ribbon-toolbar">
                        <a href="#" title="斜体" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-italic',plain:true" onclick="Italic()">斜体</a><br />
                        <a href="#" title="粗体" class="easyui-linkbutton" data-options=" iconCls:'icon-bold',plain:true"
                            onclick="Bold()">粗体</a><br />
                        <a href="#" title="格式刷" class="easyui-linkbutton" data-options="iconCls:'icon-paste',plain:true"
                            onclick="FormatBrush()">格式刷</a><br />

                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="下划线"
                            data-options=" iconCls:'icon-underline',plain:true" onclick="UnderLine()">下划线</a><br />

                        <a href="#" class="easyui-linkbutton" title="删除线"
                            data-options=" iconCls:'icon-strikethrough',plain:true" onclick="Strikeout()">删除线</a><br />
                        <a href="#" class="easyui-linkbutton" title="字符串边框" data-options=" plain:true"
                            dccommandName="Subscript" onclick="FontBorder()">字符边框</a><br />

                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="上标"
                            data-options=" iconCls:'icon-superscript',plain:true" dccommandName="Superscript"
                            onclick="Superscript()">上标</a><br />
                        <a href="#" class="easyui-linkbutton" title="下标"
                            data-options=" iconCls:'icon-subscript',plain:true" dccommandName="Subscript"
                            onclick="Subscript()">下标</a><br />
                        <a href="#" class="easyui-linkbutton" title="文本套圈" data-options="plain:true"
                            dccommandName="CharacterCircle" onclick="CharacterCircle()">文本套圈</a><br />

                    </div>
                    <div class="ribbon-toolbar">
                        前景色：
                        <span id="RenderColor"></span>
                        <br />
                        背景色：
                        <span id="RenderBackColor"></span>
                    </div>
                    <div class="ribbon-toolbar" id="colorBoxdialog">
                        <div class="colorBox" id="colorBox" style="display: none;">
                            <div id="PrevColorBox"></div>
                            <div style="display: flex;justify-content: center;">
                                <button commendStr="Color" id="PrevColorButton">确定</button>
                                <button id="PrevColorButtonCancel">取消</button>
                            </div>
                        </div>
                        <div id="colorDialogBox" style="display: none;"></div>
                    </div>
                    <div class="ribbon-group-title">字体</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="居左对齐" onclick="AlignLeft()"
                            data-options=" iconCls:'icon-align-left',plain:true">居左</a><br />
                        <a href="#" class="easyui-linkbutton" title="居右对齐" onclick="AlignRight()"
                            data-options=" iconCls:'icon-align-right',plain:true">居右</a><br />
                        <a href="#" class="easyui-linkbutton" title="居中对齐" onclick="AlignCenter()"
                            data-options=" iconCls:'icon-align-center',plain:true">居中</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="分散对齐" onclick="AlignDistribute()"
                            data-options=" iconCls:'icon-align-right',plain:true">分散对齐</a><br />
                        <a href="#" class="easyui-linkbutton" title="段落" onclick="paragraphFormat()"
                            data-options=" plain:true">段落</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="首行缩进" onclick="Indent()"
                            data-options=" plain:true">首行缩进</a><br />
                        <a href="#" class="easyui-linkbutton" title="悬挂缩进" onclick="HangIndent()"
                            data-options=" plain:true">悬挂缩进</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="有序列表" onclick="insertorderedlist()"
                            data-options=" plain:true">有序列表</a><br />
                        <a href="#" class="easyui-linkbutton" title="无序列表" onclick="insertunorderedlist()"
                            data-options=" plain:true">无序列表</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="行间距" onclick="lineheight()"
                            data-options=" iconCls:'icon-hjj',plain:true">行间距</a><br />
                        <a href="#" class="easyui-linkbutton" title="段前距" onclick="Rowspacing()"
                            data-options=" iconCls:'icon-dqj',plain:true">段前距</a><br />
                        <a href="#" class="easyui-linkbutton" title="段后距" onclick="Rowspacing2()"
                            data-options=" iconCls:'icon-dhj',plain:true">段后距</a><br />
                    </div>
                    <div class="ribbon-group-title">段落</div>
                </div>

                <div class="ribbon-group-sep"></div>
            </div>
            <div title="视图">
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="阅读模式" class="easyui-linkbutton" data-options="plain:true"
                            onclick="ReadView()">阅读模式</a><br />
                        <a href="#" title="只读切换" class="easyui-linkbutton" data-options="plain:true"
                            onclick="ReadOnly()">只读切换</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="表单模式" class="easyui-linkbutton" data-options="plain:true"
                            onclick="FormViewMode()">表单模式</a><br />
                        <a href="#" title="内容保护" class="easyui-linkbutton" data-options="plain:true"
                            onclick="ContentProtect()">内容保护</a><br />
                        <a href="#" title="管理员模式" class="easyui-linkbutton" data-options="plain:true"
                            onclick="AdministratorViewMode()">管理员模式</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            dccommandName="JumpPrintMode">续打模式</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            dccommandName="OffsetJumpPrintMode">偏移续打模式</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="设计模式" class="easyui-linkbutton" data-options="plain:true"
                            onclick="DesignMode()">设计模式</a><br />
                        <a href="#" title="留痕模式" class="easyui-linkbutton" data-options="plain:true"
                            onclick="ComplexViewMode()">留痕模式</a><br />
                        <a href="#" title="清洁模式" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CleanViewMode()">清洁模式</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="清除痕迹时会将被标记为逻辑删除的内容给去掉逻辑删除的标记，可以显示出来。请在管理员模式下使用。" class="easyui-linkbutton"
                            data-options="plain:true" onclick="ClearAllUserTrace()">清除所有痕迹</a><br />
                        <a href="#" title="清除当前用户痕迹" class="easyui-linkbutton" data-options="plain:true"
                            onclick="ClearUserTrace()">清除当前用户痕迹</a><br />
                        <a href="#" title="删除所有被逻辑删除的元素。请在管理员模式下使用。" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CommitUserTrace()">提交用户痕迹</a><br />
                    </div>


                    <div class="ribbon-group-title">视图</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="张三主任医师" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Login('009','张三主任医师','192.103.1.123',2,'觉得有问题')">张三主任医师</a><br />
                        <a href="#" title="张三主任医师" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Login( '011','李四主治医师','192.103.1.122',1,'临时加号的')">李四主治医师</a><br />
                        <a href="#" title="张三主任医师" class="easyui-linkbutton" data-options="plain:true"
                            onclick="Login('0019','王五住院医师','192.103.1.109',0,'俺是小医生')">王五住院医师</a><br />
                    </div>
                    <div class="ribbon-group-title">用户登录</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="单栏展示" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SetPageLayoutMode('SingleColumn')">单栏展示</a><br />
                        <a href="#" title="多栏展示" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SetPageLayoutMode('MultiColumn')">多栏展示</a><br />
                        <a href="#" title="水平铺开" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SetPageLayoutMode('Horizontal')">水平铺开</a><br />
                    </div>
                    <div class="ribbon-group-title">页面布局</div>
                </div>
                <div class="ribbon-group-sep"></div>


            </div>
            <div title="插入元素">
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="插入文本输入域" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="InsertInputFieldElement()">插入文本输入域</a><br />
                        <a href="#" title="插入下拉输入域" class="easyui-linkbutton" onclick="InsertListInputFieldElement()"
                            data-options=" iconCls:'icon-paste-font',plain:true">插入下拉输入域</a><br />
                        <a href="#" title="插入时间输入域" class="easyui-linkbutton"
                            onclick="InsertDateTimeInputFieldElement()"
                            data-options=" iconCls:'icon-paste-font',plain:true">插入时间输入域</a><br />
                    </div>
                    <div class="ribbon-group-title">输入域</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="插入条形码" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="InsertBarcode()">插入条形码</a><br />
                        <a href="#" title="插入二维码" class="easyui-linkbutton" onclick="InsertTDBarcode()"
                            data-options=" iconCls:'icon-paste-font',plain:true">插入二维码</a><br />
                        <a href="#" title="插入页码" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="InsertPageInfo()">插入页码</a><br />
                    </div>
                    <div class="ribbon-group-title">条形码</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="月经史公式1" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression1()">月经史公式1</a><br />
                        <a href="#" title="月经史公式2" class="easyui-linkbutton" onclick="MedicalExpression2()"
                            data-options=" iconCls:'icon-copy-font',plain:true">月经史公式2</a><br />
                        <a href="#" title="月经史公式3" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression3()">月经史公式3</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="月经史公式4" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression4()">月经史公式4</a><br />
                        <a href="#" title="眼球突出度" class="easyui-linkbutton"
                            data-options="iconCls:'icon-paste-font',plain:true"
                            onclick="EyeballProtrusion()">眼球突出度</a><br />
                        <a href="#" title="斜视符号" class="easyui-linkbutton"
                            data-options="iconCls:'icon-paste-font',plain:true" onclick="SquintSymbol()">斜视符号</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="胎心图" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression6()">胎心图</a><br />
                        <a href="#" title="瞳孔图" class="easyui-linkbutton" onclick="MedicalExpression5()"
                            data-options="iconCls:'icon-paste-font',plain:true">瞳孔图</a><br />
                    </div>
                    <div class="ribbon-toolbar">

                        <a href="#" title="恒牙牙位图" class="easyui-linkbutton" onclick="MedicalExpression8()"
                            data-options="iconCls:'icon-copy-font',plain:true">恒牙牙位图</a><br />
                        <a href="#" title="乳牙牙位图" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression9()">乳牙牙位图</a><br />
                        <a href="#" title="标尺公式" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression7()">标尺公式</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="病变上牙" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression11()">病变上牙</a><br />
                        <a href="#" title="病变下牙" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression12()">病变下牙</a><br />
                        <a href="#" title="分数公式" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="MedicalExpression10()">分数公式</a><br />
                    </div>
                    <div class="ribbon-group-title">医学表达式</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="插入单选框" class="easyui-linkbutton" onclick="InsertRadioBox()"
                            data-options=" iconCls:'icon-paste-font',plain:true">插入单选框</a><br />
                        <a href="#" title="插入复选框" class="easyui-linkbutton" onclick="InsertCheckBox()"
                            data-options=" iconCls:'icon-paste-font',plain:true">插入复选框</a><br />
                        <a href="#" title="单复选框属性" class="easyui-linkbutton" onclick="RadioBoxProperties()"
                            data-options=" iconCls:'icon-paste-font',plain:true">单复选框属性</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="插入标签文本" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true" onclick="InsertLabel()">插入标签文本</a><br />
                        <a href="#" title="插入水平线" class="easyui-linkbutton" onclick="InsertHorizontalLine()"
                            data-options=" iconCls:'icon-paste-font',plain:true">插入水平线</a><br />
                        <a href="#" title="插入按钮" class="easyui-linkbutton" onclick="InsertButton()"
                            data-options=" iconCls:'icon-paste-font',plain:true">插入按钮</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="插入图片" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true" onclick="InsertImage()">插入图片</a><br />
                        <a href="#" title="插入特殊字符" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true"
                            onclick="InsertSpecifyCharacter()">插入特殊字符</a><br />
                    </div>
                    <div class="ribbon-group-title">其他</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="插入批注" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-copy-font',plain:true" onclick="NewComment()">插入批注</a><br />
                        <a href="#" title="删除当前批注" class="easyui-linkbutton" onclick="deleteComment2()"
                            data-options=" iconCls:'icon-paste-font',plain:true">删除当前批注</a><br />
                        <a href="#" title="显示或隐藏批注" class="easyui-linkbutton" onclick="setCommentVisible()"
                            data-options=" iconCls:'icon-paste-font',plain:true">显示或隐藏批注</a><br />
                    </div>
                    <div class="ribbon-group-title">批注</div>
                </div>
                <div class="ribbon-group-sep"></div>
            </div>
            <div title="表格">
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="插入表格" id="insert_table"
                            data-options=" iconCls:'icon-table-large',iconAlign:'top',size:'large'"
                            style="border: 0; padding-top: 15px" onclick="InsertTable()">插入表格</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="删除表格"
                            data-options=" iconCls:'icon-tabledel-large',iconAlign:'top',size:'large'"
                            style="border: 0; padding-top: 15px" onclick="DeleteTable()">删除表格</a><br />
                    </div>
                    <div class="ribbon-group-title">表格</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="删除行" class="easyui-linkbutton" data-options=" iconCls:'icon-delh',plain:true"
                            onclick="DeleteTableRow()">删除行</a><br />
                        <a href="#" title="删除列" class="easyui-linkbutton" data-options=" iconCls:'icon-dell',plain:true"
                            onclick="DeleteTableColumn()">删除列</a><br />
                    </div>
                    <div class="ribbon-group-title">删除</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="在上面插入行"
                            data-options=" iconCls:'icon-inserth',plain:true" onclick="InsertRowUp()">在上面插入行</a><br />
                        <a href="#" class="easyui-linkbutton" title="在下面插入行"
                            data-options=" iconCls:'icon-inserth',plain:true" onclick="InsertRowDown()">在下面插入行</a><br />

                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" title="插入列"
                            data-options=" iconCls:'icon-insertl',plain:true"
                            onclick="InsertColumnLeft()">在左面插入列</a><br />
                        <a href="#" class="easyui-linkbutton" title="插入列"
                            data-options=" iconCls:'icon-insertl',plain:true"
                            onclick="InsertColumnRight()">在右面插入列</a><br />
                    </div>
                    <div class="ribbon-group-title">插入</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="合并单元格" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-hebing',plain:true" onclick="MegeCell()">合并单元格</a><br />
                        <a href="#" title="拆分单元格" class="easyui-linkbutton"
                            data-options=" iconCls:'icon-hebing',plain:true" onclick="SplitCell()">拆分单元格</a><br />

                    </div>
                    <div class="ribbon-group-title">单元格</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="背景编号" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="ShowBackgroundCellID()">背景编号</a><br />
                        <a href="#" title="单元格网格线" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="SetTableCellGridLineInfo()">单元格网格线</a><br />
                        <a href="#" title="单元格斜分线" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="SetTableCellSlantSplitlineStyle()">单元格斜分线</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="表格边框" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SetTableBorder()">表格边框</a><br />
                        <a href="#" title="单元格边框" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="SetTableCellBorder()">单元格边框</a><br />
                        <a href="#" title="自适应宽度" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="AutoFixTableWidth()">自适应宽度</a><br />
                    </div>
                    <div class="ribbon-group-title">设置</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="顶端左对齐" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="CellAlign('AlignTopLeft')">顶端左对齐</a><br />
                        <a href="#" title="顶端右对齐" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CellAlign('AlignTopRight')">顶端右对齐</a><br />
                        <a href="#" title="顶端中间对齐" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CellAlign('AlignTopCenter')">顶端中间对齐</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="垂直居中水平左对齐" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="CellAlign('AlignMiddleLeft')">垂直居中水平左对齐</a><br />
                        <a href="#" title="垂直居中水平右对齐" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CellAlign('AlignMiddleRight')">垂直居中水平右对齐</a><br />
                        <a href="#" title="垂直居中水平中间对齐" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CellAlign('AlignMiddleCenter')">垂直居中水平中间对齐</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="垂直居中水平左对齐" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="CellAlign('AlignBottomLeft')">底端左对齐</a><br />
                        <a href="#" title="垂直居中水平右对齐" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CellAlign('AlignBottomRight')">底端右对齐</a><br />
                        <a href="#" title="垂直居中水平中间对齐" class="easyui-linkbutton" data-options="plain:true"
                            onclick="CellAlign('AlignBottomCenter')">底端中间对齐</a><br />
                    </div>
                    <div class="ribbon-group-title">对齐方式</div>
                </div>
                <div class="ribbon-group-sep"></div>
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" title="背景编号" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="TableProperties()">表格属性</a><br />
                        <a href="#" title="单元格网格线" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="TableCellProperties()">单元格属性</a><br />
                    </div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="单元格网格线" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="TableRowProperties()">表格行属性</a><br />
                        <a href="#" title="单元格网格线" class="easyui-linkbutton" data-options=" plain:true"
                            onclick="TableColumnProperties()">表格列属性</a><br />
                    </div>
                    <div class="ribbon-group-title">属性</div>
                </div>
                <div class="ribbon-group-sep"></div>

            </div>
            <div title="打印">
                <div class="ribbon-group">
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="GetCurrentWriterControl().ClosePrintPreview();">关闭打印预览</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="GetCurrentWriterControl().LoadPrintPreview();">打印预览</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="GetCurrentWriterControl().LoadPrintPreview({PrintRange:'CurrentPage'});">预览当前页</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>
                    <div class="ribbon-toolbar">
                        <a href="#" title="全部打印" class="easyui-linkbutton" data-options="plain:true"
                            onclick="GetCurrentWriterControl().PrintDocument({CompletedCallback:function(){alert('打印成功');}});">全部打印</a><br />
                        <a href="#" title="打印当前页" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PrintCurrentPage()">打印当前页</a><br />
                        <a href="#" title="打印指定页" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PrintSpecifyPage()">打印指定页</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>
                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PrintSelection();">打印选择的内容</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PrintOdd();">打印奇数页</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PrintEven();">打印偶数页</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>

                    <div class="ribbon-toolbar">
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PrintAsPDF();">打印为PDF</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="PrintAsHtml();">打印为HTML</a><br />
                        <a href="#" class="easyui-linkbutton" data-options="plain:true"
                            onclick="LocalPrint();">本地打印</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>

                    <div class="ribbon-toolbar">
                        <span class="l-btn-text">开始页：</span>
                        <input id="FromPage" type="number" value="0" min="0" max="100" step="1" style="width:50px" />
                        <br />
                        <span class="l-btn-text">结束页：</span>
                        <input id="ToPage" type="number" value="0" min="0" max="100" step="1" style="width:50px" />
                        <br />
                        <a href="#" title="打印页码范围" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SomePagesPrint()">打印页码范围</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>

                    <div class="ribbon-toolbar">
                        <span class="l-btn-text">指定页码列表：</span>
                        <input id="SpecifyPages" type="text" title="例如：1,3,6-11,12" value="2-4" min="0" max="100"
                            step="1" style="width:70px" />
                        <br />
                        <a href="#" title="打印页码列表" class="easyui-linkbutton" data-options="plain:true"
                            onclick="SpecifyPagesPrint()">打印页码列表</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>

                    <div class="ribbon-toolbar">
                        <a href="#" title="续打" class="easyui-linkbutton" data-options="plain:true"
                            onclick="JumpPrintMode()">鼠标续打</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>
                    <div class="ribbon-toolbar">
                        <span class="l-btn-text">开始元素编号：</span>
                        <input id="JumpPrintStartElementID" type="text" title="编号" value="" min="0" max="100" step="1"
                            style="width:70px" /><br />

                        <span class="l-btn-text">结束元素编号：</span>
                        <input id="JumpPrintEndElementID" type="text" title="编号" value="" min="0" max="100" step="1"
                            style="width:70px" /><br />

                        <a href="#" title="元素编号续打" class="easyui-linkbutton" data-options="plain:true"
                            onclick="JumpPrintModeByElementID()">元素编号续打</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>


                    <div class="ribbon-toolbar">
                        <span class="l-btn-text">开始页码：</span><input id="JumpPageIndex" type="number" value="0" min="0"
                            max="100" step="1" style="width:50px" />
                        <br />
                        <span class="l-btn-text">开始位置：</span><input id="JumpPosition" type="number" value="0" min="0"
                            max="100" step="1" style="width:50px" />
                        <br />
                    </div>
                    <div class="ribbon-toolbar">
                        <span class="l-btn-text">结束页码：</span><input id="JumpEndPageIndex" type="number" value="0"
                            min="0" max="100" step="1" style="width:50px" />
                        <br />
                        <span class="l-btn-text">结束位置：</span><input id="JumpEndPosition" type="number" value="0" min="0"
                            max="100" step="1" style="width:50px" />
                        <br />
                        <a href="#" title="续打" class="easyui-linkbutton" data-options="plain:true"
                            onclick="JumpPrint()">位置续打</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>


                    <div class="ribbon-toolbar">
                        <span class="l-btn-text">纵向偏移量：</span><input id="BodyLayoutOffset" type="number" value="0"
                            min="0" max="100" step="1" style="width:50px" />
                        <br />
                        <a href="#" title="偏移续打" class="easyui-linkbutton" data-options="plain:true"
                            onclick="LayoutOffsetPrint()">偏移续打</a><br />
                    </div>
                    <div class="ribbon-group-sep"></div>



                    <div class="ribbon-group-title"></div>


                </div>


            </div>
        </div>
        <div id="box" style="display:flex;flex-wrap:wrap;background:#fff;">
            <div class="presentationDocumentBox" style="display: none;user-select:none;" id="presentationDocumentBox">
                <img class="backImg" src="./img/xiangzuoshuangxian.png" alt="">
                <div class="tabBox">
                    <div class="tabItem active" id="PresentationDocumentcenterACtive"
                        tabId="presentationDocumentcenter">模板列表</div>
                    <!-- <div class="tabItem" tabId="courseListBox">病程记录</div> -->
                    <div class="tabItem" tabId="TracesList" id="TracesListButton">痕迹列表</div>
                    <div class="tabItem" tabId="DragElementList" id="DragElementListButton">拖拽元素列表</div>
                </div>
                <div class="boxItem" id="presentationDocumentcenter">
                    <div class="head">
                        模板列表
                    </div>
                    <div id="presentationDocumentContent" class="presentationDocumentContent listItem"></div>
                </div>
                <div class="boxItem" id="TracesList">
                    <div class="head">
                        痕迹列表
                        <img class="refreshImg" title="刷新" id="RefreshTracesList" src="./img/shuaxin.png" alt="">
                    </div>
                    <div id="TracesListContent" class="TracesListContent listItem"></div>
                </div>
                <div class="boxItem" id="DragElementList">
                    <div class="head">
                        拖拽元素列表
                    </div>
                    <div id="DragElementListContent" class="DragElementListContent listItem"></div>
                </div>
            </div>
            <div class="resize" id="resize" ref="resize"></div>
            <!-- 在此处写tab页的最外层包裹元素 -->
            <div id="tt" class="easyui-tabs" style="flex: 1;width:100%">

            </div>
            <div id="abortText">
                状态：<span id="lblStatus">...</span>
            </div>
            <div id="scaleBox">
                <div style="display: flex;">
                    <span style="margin-right:4px;margin-top: -4px;">0.1</span>
                    <div id="progress">
                        <div id="progress_pill"></div>
                        <span id="bar"></span>
                    </div>
                    <span style="margin-right:4px;margin-top: -4px;">&nbsp;5.0</span>
                    <span id="progress_text" style="margin-top:-4px;">当前:1.0</span>
                </div>
            </div>
            <img src="./img/quanping.png" title="全屏" onclick="FullScreen()" id="FullScreenButton" />
            <img src="./img/tuichuquanping.png" title="退出全屏" onclick="EXIDFullScreen()" id="EXIDFullScreenButton"
                style="display: none;" />

            <div id="blazor-error-ui">
                控制台有错误
                <a href="" class="reload">重新加载</a>
                <a class="dismiss">🗙</a>
            </div>
        </div>
    </div>
    <script src="./js/colorPicker/ColorPicker.js"></script>
    <script src="./js/DragElement/DragElement.js"></script>
    <script>
        var colorPicker = new ColorPicker()
        jQuery('#RenderColor').click(() => {
            renderColorClass('Color')
        })
        jQuery('#RenderBackColor').click(() => {
            renderColorClass('BackColor')
        })
        jQuery('#PrevColorButton').click(function () {
            let colorStr = colorPicker.getcolor()
            let commendStr = document.getElementById('PrevColorButton').getAttribute('commendStr')
            if (colorStr == null || colorStr == "") {
                return;
            }
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand(commendStr, false, colorStr);
            document.getElementById('Render' + commendStr).style.background = colorStr
            removeColorClass()
        })
        jQuery('#PrevColorButtonCancel').click(function () {
            removeColorClass()
        })
        function renderColorClass(type) {
            document.getElementById('PrevColorButton').setAttribute('commendStr', type)
            document.getElementById('colorBox').style.display = 'block'
            document.getElementById('colorDialogBox').style.display = 'block'
            colorPicker.LoadColorHtml('PrevColorBox')
            colorPicker.fnColorPicker()
        }
        function removeColorClass() {
            document.getElementById('colorBox').style.display = 'none'
            document.getElementById('colorDialogBox').style.display = 'none'
            jQuery('#PrevColorBox').children().remove()
        }
        document.getElementById('colorDialogBox').addEventListener('click', function (e) {
            removeColorClass()
        })

    </script>
    <script>
        var dragElement = new DragElement()
        dragElement.getDragData()
        document.getElementById('DragElementListContent').addEventListener('click', function (e) {
            if (e && e.target) {
                if (e.target.className && e.target.className.indexOf('dragElementItemNodeText') !== -1) {
                    dragElement.setClickZContainer(e)
                }
            }
        })
        document.getElementById("DragElementListContent").ondragstart = function (e) {
            if (e.target.getAttribute && e.target.getAttribute('title')) {
                var options = e.target.getAttribute('title');
                e.dataTransfer.setData("text/plain", options);
            }
        };
    </script>
    <script language="javascript">
        function LogHightTime(title) {
            var dtm = new Date();
            console.log(title + ":" + dtm.toLocaleTimeString() + "." + dtm.getMilliseconds());
        }
        LogHightTime("加载HTML页面");
    </script>
    <!-- <script src="_framework/dcwriter5.js"></script> -->
    <script src="http://www.dcwriter.cn:8099/ServicePage.aspx?wasmres=dcwriter5.js"></script>
    <script src="DemoApp.js"></script>
    <script src="js/easyui/easyui.js"></script>
    <script src="./static/indexStrDemoFileXml.js"></script>
    <script language="javascript">
        var WRITERCONTROLOPTIONS = `dctype = "WriterControlForWASM" 
                                    DoubleBuffer = "true"
                                    PrintServicePageUrl = "http://localhost:23345"
                                    RuleVisible = "true"
                                    RuleBackColor = "rgb(230, 230, 230)"
                                    PageCssString333 = "box-shadow:1px 1px 1px grey" 
                                    PageTitlePosition = "BottomRight"
                                    PageBorderColor = "rgb(230, 230, 230)" 
                                    CaretCss = "3,Blue"
                                    DocumentOptions.BehaviorOptions.ResetTextFormatWhenCreateNewLine = "true"
                                    DocumentOptions.BehaviorOptions.SelectionTextIncludeBackgroundText = "false"
                                    DocumentOptions.BehaviorOptions.AutoAssistInsertString = "true"
                                    DocumentOptions.BehaviorOptions.AutoAssistInsertStringDetectTextLength = "1"
                                    DocumentOptions.BehaviorOptions.HandleCommandException = "false"
                                    DocumentOptions.BehaviorOptions.OutputFormatedXMLSource = "false"
                                    DocumentOptions.BehaviorOptions.ParagraphFlagFollowTableOrSection = "true"
                                    DocumentOptions.BehaviorOptions.PromptJumpBackForSearch = "false"
                                    DocumentOptions.BehaviorOptions.CommentEditableWhenReadonly = "true"
                                    DocumentOptions.ViewOptions.EnableEncryptView = "true"
                                    DocumentOptions.ViewOptions.ShowInputFieldStateTag = "true"
                                    DocumentOptions.ViewOptions.IgnoreFieldBorderWhenPrint = "false"
                                    DocumentOptions.ViewOptions.PrintBackgroundText = "false"
                                    DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint = "true"
                                    DocumentOptions.ViewOptions.FieldBorderPrintVisibility = "hidden"
                                    DocumentOptions.ViewOptions.FieldInvalidateValueForeColor = "Blue"
                                    DocumentOptions.ViewOptions.TagColorForNormalField = "Green"
                                    DocumentOptions.ViewOptions.TagColorForValueInvalidateField = "Blue"
                                    DocumentOptions.ViewOptions.UnEditableFieldBorderColor = "Yellow"
                                    DocumentOptions.ViewOptions.ShowParagraphFlag = "true"
                                    DocumentOptions.SecurityOptions.EnablePermission = "true"
                                    DocumentOptions.SecurityOptions.EnableLogicDelete = "true"
                                    DocumentOptions.SecurityOptions.ShowLogicDeletedContent = "true"
                                    DocumentOptions.SecurityOptions.ShowPermissionTip = "true"
                                    DocumentOptions.SecurityOptions.ShowPermissionMark = "true"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel0.BackgroundColor = "Transparent"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel0.DeleteLineColor = "Blue"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel0.DeleteLineNum = "1"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel0.Enabled = "true"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel0.UnderLineColor = "Blue"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel0.UnderLineColorNum = "1"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel1.BackgroundColor = "Transparent"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel1.DeleteLineColor = "Yellow"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel1.DeleteLineNum = "2"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel1.Enabled = "true"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel1.UnderLineColor = "Yellow"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel1.UnderLineColorNum = "2"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel2.BackgroundColor = "Transparent"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel2.DeleteLineColor = "Green"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel2.DeleteLineNum = "2"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel2.Enabled = "true"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel2.UnderLineColor = "Green"
                                    DocumentOptions.SecurityOptions.TrackVisibleLevel2.UnderLineColorNum = "2"`

        var WRITERCONTROLHTML = ` <div title="入院记录" data-options="closable:true" style="display:none;width: 100%;">
                    <!-- 第一页的html   ServicePageUrl="http://localhost:9901/dcwritersvp"-->
                    <div id="myWriterControl"
                        style="height: 100%; background-color: rgb(230, 230, 230); border-bottom: 0px solid black; background-attachment: fixed; background-size: cover; background-position: center top; "
                        ${WRITERCONTROLOPTIONS}
                        OnLoad="this.LoadDocumentFromString(strDemoFileXml, 'xml');">
                        正在加载...
                    </div>
                </div>`
        document.getElementById('tt').innerHTML = WRITERCONTROLHTML
        var subXml1 = SUBXML1
        var strDemoFileXml = STRDEMOFILEXML

        function FullScreen() {
            if (jQuery('#presentationDocumentButton').attr('isflag') === 'show') {
                jQuery('#presentationDocumentBox').hide()
            }
            jQuery('#EXIDFullScreenButton').show()
            jQuery('#FullScreenButton').hide()
            let el = document.getElementById('box') // 获取需要全屏显示的因素
            let rfs = el.requestFullScreen
                || el.webkitRequestFullScreen
                || el.mozRequestFullScreen
                || el.msRequestFullScreen
            // 获取实现全屏的方法，此处兼容了火狐、谷歌、IE、safari浏览器
            if (typeof rfs != "undefined" && rfs) {
                rfs.call(el)
                setTimeout(function () {
                    jQuery(el).find('#tt').css('height', 'calc(100% - 20px)')
                }, 300)
                return
            }
        }
        function EXIDFullScreen() {
            if (jQuery('#presentationDocumentButton').attr('isflag') === 'show') {
                jQuery('#presentationDocumentBox').show()
            }
            jQuery('#EXIDFullScreenButton').hide()
            jQuery('#FullScreenButton').show()
            let el = document
            let cfs = el.cancelFullScreen
                || el.webkitCancelFullScreen
                || el.mozCancelFullScreen
                || el.exitFullScreen
            if (typeof cfs != "undefined" && cfs) {
                cfs.call(el)
                return
            }
            if (typeof window.ActiveXObject != "undefined") {
                let wscript = new ActiveXObject("WScript.Shell")
                if (wscript != null) {
                    wscript.SendKeys("{F11}")
                }
            }
        }


        window.onresize = function () {
            let isFull = document.mozFullScreen
                || document.fullScreen
                || document.webkitIsFullScreen
                || document.webkitFullScreen
                || document.msFullScreen
            if (!isFull) {
                EXIDFullScreen()
            }
        }

        jQuery(document).ready(function () {
            if (/Mobi|Android|iPhone/i.test(navigator.userAgent)) {
                // 当前设备是移动设备
                window.location.href = "./demoDocMobileTerminal.html"
            }
        });


        /**获得当前的编辑器控件对象 */
        function GetCurrentWriterControl() {
            var pp = jQuery('#tt').tabs('getSelected');
            //判断目前的根元素
            var targetId = pp[0].children[0].getAttribute('id');
            return document.getElementById(targetId);
        }
        LogHightTime("加载HTML后续页面");
        function WriterControl_EventElementLostFocus(eventSender, args) {
            console.log("LostFocus");
            console.log(args);
        }
        function WriterControl_EventElementGotFocus(eventSender, args) {
            console.log("GotFocus");
            console.log(args);
        }

        function WriterControl_DocumentLoad(eventSender, args) {

        };


        /**
         * 控件加载完毕后会自动执行名为 WriterControl_OnLoad 的函数.该函数内的this变量指向HTML根元素
         * @param { WriterControl } rootElement
         */
        function WriterControl_OnLoad(rootElement) {
            let strNotSupportFontNames = rootElement.GetNotSupportFontNames();
            if (strNotSupportFontNames != null && strNotSupportFontNames.length > 0) {
                console.log("该文档中包含不支持的字体:" + strNotSupportFontNames);
            }
            try {
                //存储加载文档花费毫秒，用于提供给性能页面
                let indexPerformanceTiming = {}
                if (window.localStorage.getItem('indexPerformanceTiming')) {
                    indexPerformanceTiming = {
                        ...JSON.parse(window.localStorage.getItem('indexPerformanceTiming'))
                    }
                }
                indexPerformanceTiming['myWriterControl'] = {
                    ...(indexPerformanceTiming.myWriterControl || {}),
                    [rootElement.id]: {
                        ...indexPerformanceTiming['myWriterControl'][rootElement.id],
                        endTime: (new Date()).valueOf(),
                    }
                }
                window.localStorage.setItem('indexPerformanceTiming', JSON.stringify(indexPerformanceTiming))
            } catch (error) {

            }


            console.log('WriterControl_OnLoad')
            if (jQuery('#sqcd').find(".tabs-header")[0].offsetWidth !== document.body.offsetWidth) {
                jQuery('#sqcd').width('100%')
                jQuery('#tt').width('100%')
                jQuery('#sqcd').find(".tabs-header,.tabs-wrap,.tabs-panels,.panel,.panel-body").width("100%");
                jQuery("#tt").find(".tabs-header,.tabs-wrap,.tabs-panels,.panel,.panel-body").width("100%");
            }

            LogHightTime("控件加载完毕");
            rootElement.SelectionChanged = function (eventSender, args) {
                var txt =
                    "第" + (this.FocusedPageIndexBase0 + 2) + "页,第" +
                    this.CurrentLineIndexInPage + "行，第" +
                    this.CurrentColumnIndex + "列.";
                if (this.SelectionLength != 0) {
                    txt = txt + "选择了" +
                        Math.abs(this.SelectionLength) + "个元素";
                }
                var p = this.SelectionStartPosition;
                txt = txt + " X:" + p.X + " Y:" + p.Y;
                document.getElementById('lblStatus').innerText =
                    txt + " 当前字体:" + this.CurrentFontName + "," + this.CurrentFontSize;
                var fontfamilySelect = document.getElementById("fontfamilySelect");
                fontfamilySelect.value = this.CurrentFontName;
                var fontSizeSelect = document.getElementById("fontSizeSelect");
                fontSizeSelect.value = this.CurrentFontSize;
            };
            rootElement.DocumentLoad = function (eventSender, args) {
                LogHightTime("文件加载完毕");
            };


            rootElement.EventPageResize = function (args) {

                console.log("EventPageResize事件", this.id);
            }
            rootElement.EventResize = function (args) {

                console.log("EventResize事件", this.id);
            }

            /** lxy20230714 兼容四代接口EventBeforeExecuteCommand，获取命令的名称，可以阻止命令的执行
            * 执行编辑器命令 
            * @param {string} CommandName 命令名称
            * @return {boolen} true:阻止命令执行，fales：不阻止 （默认返回false，不阻止）
            */
            rootElement.EventBeforeExecuteCommand = function (CommandName) {
                // // 例：
                // if (CommandName === 'ComplexViewMode') {
                //     return true
                // }
                return false
            }

            //保存文档格式校验的错误回调
            rootElement.EventSaveDocumentToStringValidate = function (validate) {
                console.log(validate, '=============保存时SaveDocumentToString，对结果进行校验，判定是否是合法的XML和JSON，给与错误回调。')
            }

            rootElement.EventShowContextMenu = Handle_EventShowContextMenu;// 这个函数定义在DemoApp.js中
            rootElement.EventUpdateToolarState = Handle_EventUpdateToolarState;// 这个函数定义在DemoApp.js中
            rootElement.EventCanInsertObject = function (eventSender, eventArgs) {
                eventArgs.Result = true;
            };
            rootElement.EventInsertObject = function (eventSender, eventArgs) {
                // 这个eventArgs 类型定义在WriterControl_Event.js中的InsertObjectEventArgs类中。
                if (eventArgs.GetDataPresent("Text") && eventArgs.InputSource == "DragDrop") {
                    var txt = eventArgs.GetData("Text");
                    rootElement.DCExecuteCommand("InsertInputField", false, {
                        "ContentReadonly": "Inherit",
                        "UserEditable": true,
                        "ToolTip": txt,
                        "BackgroundText": txt,
                        "Text": "",
                        "InnerValue": null,
                        "ValidateStyle": null,
                        "EnableValueValidate": true,
                        "Name": '',
                        "ID": new Date().valueOf(),
                        "Alignment": "Near",
                        "BackgroundTextColor": null,
                        "TextColor": null,
                        "SpecifyWidth": 0,
                        "StartBorderText": null,
                        "EndBorderText": null,
                        "UnitText": null,
                    });
                    eventArgs.Handled = true; //设置Handle=true,表示事件已经处理了，不需要后续的默认处理。
                }
            };
            rootElement.QueryListItems = function (sender, eventObject) {
                //console.log(sender.__DCWriterReference.invokeMethod("GetPrintResult"));
                eventObject.Async = true;
                window.setTimeout(function () {
                    // 异步加载数据
                    console.log("QueryListItems获取的编号：" + eventObject.ElementID + "，获取的数据来源名称：" + eventObject.ListSourceName);
                    eventObject.AddResultItemByTextValue("刘一", "liuyi");
                    eventObject.AddResultItemByTextValue("陈二", "chener");
                    eventObject.AddResultItemByTextValue("张三", "zhangsan");
                    eventObject.AddResultItemByTextValue("李四", "lisi");
                    eventObject.AddResultItemByTextValue("王五", "wangwu");
                    eventObject.AddResultItemByTextValue("赵六", "zhaoliu");
                    eventObject.AddResultItemByTextValue("孙七", "sunqi");
                    eventObject.AddResultItemByTextValue("周八", "zhouba");
                    eventObject.AddResultItemByTextValue("吴九", "wujiu");
                    eventObject.AddResultItemByTextValue("郑十", "zhengshi");
                    eventObject.Completed();
                }, 100);

            }
            rootElement.EventChangeSearchInputSpellCode = function (eventSender, eventObj) {
                console.log("EventChangeSearchInputSpellCode获取的用户输入信息：" + eventObj);
                for (var i = 0; i < 10; i++) {
                    eventObj.AddResultItemByTextValue(eventObj.Value + i, i);
                }
                eventObj.ChangeSpellCode();//不使用该接口，将始终在QueryListItems已添加的数据中赛选文本；添加后将在EventChangeSearchInputSpellCode中动态添加
            }
            fillFontSelectOptions().then(function (state) {
                // state 方法返回值
                if (state == true) {
                    console.log("填充字体下拉完成时间=>", new Date())
                }
            });
            //缩放toobar
            var progress = document.getElementById('progress')
            var progress_pill = document.getElementById('progress_pill')
            var progress_text = document.getElementById('progress_text')
            var bar = progress.children[1]
            var moveWidth = progress.offsetWidth - bar.offsetWidth
            bar.onmousedown = function (event) {
                var e = window.event || event
                var clientX = event.clientX - bar.offsetLeft
                console.log(progress.offsetWidth)
                document.body.onmousemove = function (event) {
                    event = event || window.event;
                    var moveX = event.clientX - clientX
                    if (moveX <= 0) {
                        moveX = 0
                    } else if (moveX >= moveWidth) {
                        moveX = moveWidth
                    }
                    bar.style.left = moveX + 'px'
                    progress_pill.style.width = moveX + 'px'
                    progress_text.innerHTML = '当前:' + (moveX / moveWidth * 5).toFixed(1)
                    SetZoomRate((moveX / moveWidth * 5).toFixed(1))
                    return false
                }
                document.body.onmouseup = function () {
                    document.body.onmousemove = null
                }
            }
            document.onmousewheel = function () {
                SetMouseWheelScaleChange()
            }

        };

        function SetMouseWheelScaleChange() {
            if (GetCurrentWriterControl() && GetCurrentWriterControl().__DCWriterReference) {
                let scaleNum = GetCurrentWriterControl().__DCWriterReference.invokeMethod("get_ZoomRate")
                progress_text.innerHTML = '当前:' + scaleNum.toFixed(1)
                progress_pill.style.width = (scaleNum.toFixed(1) * (progress.offsetWidth / 5)) + 'px'
                bar.style.left = ((scaleNum.toFixed(1) * (progress.offsetWidth / 5)) - 5) + 'px'
            }
        }
        async function fillFontSelectOptions() {
            // 填充字体下拉状态,true不需要再次调用
            if (window.FillFontSelectOptionsState == true) {
                return false;
            }
            window.FillFontSelectOptionsState = true;
            var ctl = GetCurrentWriterControl();
            // 字号大小
            var dataFontSize = [8, 9, 10, 10.5, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72, "初号", "小初", "一号", "小一", "二号", "小二", "三号", "小三", "四号", "小四", "五号", "小五", "六号", "小六", "七号", "八号"];
            var arrFont = [];
            if (window.WriterControl_SupportFontFamilys && window.WriterControl_SupportFontFamilys.length) {
                arrFont = window.WriterControl_SupportFontFamilys;
            } else {
                arrFont = window.WriterControl_SupportFontFamilys = await ctl.getSupportFontFamilys();
            }
            if (arrFont.length > 0) {
                var fontfamilySelect = document.getElementById("fontfamilySelect");
                var selectHtml = "";
                for (var i = 0; i < arrFont.length; i++) {
                    var ch = arrFont[i].ch;
                    selectHtml += "<option value='" + ch + "' style='font-family:" + ch + ";'>" + ch + "</option>";
                }
                fontfamilySelect.innerHTML = selectHtml;
            }
            var fontSizeSelect = document.getElementById("fontSizeSelect");
            var selectSizeHtml = "";
            for (var i = 0; i < dataFontSize.length; i++) {
                selectSizeHtml += "<option value='" + dataFontSize[i] + "'>" + dataFontSize[i] + "</option>";
            }
            fontSizeSelect.innerHTML = selectSizeHtml;
            return true;
        }
        function WriterControl_InsertObject(rootElement, args) {
            console.log("WriterControl_InsertObject" + args);
        };
        /** 文档内容发生改变事件*/
        function WriterControl_DocumentContentChanged(rootElement) {
            console.log(rootElement.id + " 内容发生改变");
            var pp = $('#tt').tabs('getSelected');
            var tab = pp.panel('options').tab;
            var titleEle = tab[0].querySelector('.tabs-title');
            titleEle.classList.add('tabs-title-change');
            //获取痕迹列表
            let IsFlagPresentationDocumentShow = document.getElementById('presentationDocumentButton').getAttribute('isflag') // 演示文档是否展开
            let TracesListButtonClassList = JSON.stringify(document.getElementById('TracesListButton').classList) // 痕迹列表是否展开
            if (TracesListButtonClassList.includes('active') && (IsFlagPresentationDocumentShow === 'show')) {
                GetTracesList()
            }
            //titleEle.classList.remove('tabs-title-change');
        };
        function BindCommand() {
            var elements = document.getElementsByTagName("A");
            for (var iCount = 0; iCount < elements.length; iCount++) {
                var element = elements[iCount];
                var cmdName = element.getAttribute("dccommandName");
                if (cmdName != null && cmdName.length > 0) {
                    if (element.onclick == null) {
                        element.onclick = function () {
                            GetCurrentWriterControl().DCExecuteCommand(this.getAttribute("dccommandName"), true, null);
                        };
                    }
                }
            }
        };
        BindCommand();

        window.__Tick_Start = new Date().valueOf();
        window.__Tick_Last = new Date().valueOf();
        window.__LogTick = function (strName) {
            var tick = new Date().valueOf();
            console.log(strName + " \t| 时刻:" + (tick - window.__Tick_Start) + ",距离上次时刻:" + (tick - window.__Tick_Last));
            window.__Tick_Last = tick;
        };
        window.__LogTick("开始加载页面.");

        function parsexml() {
            var tick99 = new Date().valueOf();
            for (var iCount = 0; iCount < 100; iCount++) {
                var arr = GetXmlStringArray(strDemoFileXml);
                var tick = new Date().valueOf();
                var len2 = GetCurrentWriterControl().__DCWriterReference.invokeMethod(
                    "TestMethod", arr[0], arr[1]);
                if (len2 != arr[0].length) {
                    alert("sssssssssss");
                }
                tick = new Date().valueOf() - tick;
                //alert("传递数组毫秒:" + tick );
            }
            tick99 = new Date().valueOf() - tick99;
            alert("处理XML完成:" + tick99);
        }
        /**
         * 根据XML获得数组
         * @param {string} strXML XML字符串
         * @returns {Array} 数组信息对象
        * */
        function GetXmlStringArray(strXML) {
            if (strXML == null || strXML.length == 0) {
                // 参数为空，不处理
                return null;
            }
            var strHeader = strXML.substr(0, 100);
            if (strHeader.indexOf("<XTextDocument") < 0) {
                // 不是标准的XML，不处理。
                return null;
            }
            var tick = new Date().valueOf();
            var tick2 = tick;
            var pr = new DOMParser();
            var xmldoc = pr.parseFromString(strXML, "text/xml");//"application/xml" "text/xml"
            tick2 = new Date().valueOf() - tick2;
            var strTable = new Array();
            var strTableValues = new Array();
            var idNames = new Set();
            var GetStringIndex = function (txt, isName) {
                if (txt == null || txt.length == 0) {
                    return -1;
                }
                //var index = strTable.indexOf( txt );//[ txt ];
                //if(index <0){
                //    strTable.push( txt );
                //    index = strTable.length - 1;
                //}
                var index = strTable[txt];
                if (typeof (index) == "undefined") {
                    index = strTableValues.length;
                    strTableValues.push(txt);
                    strTable[txt] = index;
                }
                if (isName == true) {
                    idNames.add(index);
                }
                //if (strTableValues[ index ] != txt )
                //{
                //    var len4 = txt;
                //}
                return index;
            };
            var funcOutputAttributes = function (attributes, array) {
                var attrLen = attributes.length;
                array.push(attrLen);
                for (var iCount = 0; iCount < attrLen; iCount++) {
                    var attr = attributes[iCount];
                    array.push(GetStringIndex(attr.localName, true));
                    array.push(GetStringIndex(attr.nodeValue, false));
                }
            };
            var funcOutputNodes = function (firstNode, array) {
                //var nodeLen = nodes.length;
                array.push(0);
                var lenIndex = array.length - 1;
                array.push(0);
                var outputLength = 0;
                //for (var iCount = 0; iCount < nodeLen; iCount++) {
                var preNode = null;
                for (var node = firstNode; node != null; node = node.nextSibling) {
                    //var node = nodes[iCount];
                    var nodeType = node.nodeType;
                    if (nodeType == 1) {
                        // 元素
                        funcOutputOneNode(node, array);
                        outputLength++;
                    }
                    else if (nodeType == 3) {
                        // #text
                        var strText = node.nodeValue;
                        if (strText.charCodeAt(0) == 13 || strText.charCodeAt(0) == 10) {
                            if (preNode == null || preNode.nodeType == 1) {
                                var nextNode = node.nextSibling;
                                if (nextNode == null || nextNode.nodeType == 1) {
                                    if (strText.trim().length == 0) {
                                        // 为一个无意义的空行
                                        continue;
                                    }
                                }
                            }
                        }
                        array.push(0);
                        array.push(GetStringIndex(node.nodeValue, false));
                        outputLength++;
                    }
                    preNode = node;
                }//for
                array[lenIndex] = outputLength;
                array[lenIndex + 1] = array.length - 1;
            };
            /**@param { HTMLElement} rootElement
             @param {Array} array*/
            var funcOutputOneNode = function (rootElement, array) {
                var attrLen = 0;
                if (rootElement.hasAttributes()) {
                    attrLen = rootElement.attributes.length;
                }
                var firstChild = rootElement.firstChild;
                if (attrLen == 0 && firstChild == null) {
                    // 没有任何数据
                    array.push(1);//ElementType.EmptyElement
                    array.push(GetStringIndex(rootElement.nodeName, true));
                }
                else if (attrLen == 0 && firstChild != null) {
                    // 没有属性，有子节点
                    if (firstChild.nodeType == 3 && firstChild.nextSibling == null) {
                        // 只有一个文本数据
                        array.push(2);//ElementType.ElementString
                        array.push(GetStringIndex(rootElement.nodeName, true));
                        array.push(GetStringIndex(firstChild.nodeValue, false));
                        return;
                    }
                    array.push(3);// ElementType.ElementNoAttribute
                    array.push(GetStringIndex(rootElement.nodeName, true));
                    funcOutputNodes(firstChild, array);
                }
                else if (attrLen > 0 && firstChild == null) {
                    // 有属性，没有子节点
                    array.push(4);// ElementType.ElementNoChild
                    array.push(GetStringIndex(rootElement.nodeName, true));
                    funcOutputAttributes(rootElement.attributes, array);
                }
                else {
                    // 有属性有子节点
                    array.push(5);//ElementType.ElementFull
                    array.push(GetStringIndex(rootElement.nodeName, true));
                    funcOutputAttributes(rootElement.attributes, array);
                    funcOutputNodes(firstChild, array);
                }
            };
            var list = new Array();
            funcOutputOneNode(xmldoc.documentElement, list);
            tick = new Date().valueOf() - tick;
            //strTable.push( list.toString());
            var byteIndexs = new Uint8Array(new Int32Array(list).buffer);
            var byteIndexNames = new Uint8Array(new Int32Array(idNames).buffer);
            //alert("处理XML毫秒:" + tick2 + "/" + tick + "   " + byteIndexs.length );
            strTable = null;
            list = null;
            idNames = null;
            //index2.from( strIndexs);
            return [strTableValues, byteIndexs, byteIndexNames];
        }

        function SaveXmlString() {
            console.log("测试SaveDocumentToString");
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.SaveDocumentToString('xml');
            console.log(result);
        }
        function PageSetting() {
            var ctl = GetCurrentWriterControl();
            ctl.DocumentSettingsDialog(null, PageSettingCallback);
        }
        function PageSettingCallback() {
            console.log('==========>页面设置的回调函数')
        }
        function PrintDocument() {
            console.log("测试PrintDocument");
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.PrintDocument();
        }
        function AdministratorViewMode() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('AdministratorViewMode', false, null);
        }
        function CommitUserTrace() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('CommitUserTrace', false, null);
        }
        function ClearUserTrace() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('ClearUserTrace', false, null);
        }
        function ClearAllUserTrace() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('ClearAllUserTrace', false, null);
        }
        function FontBorder() {
            var ctl = document.getElementById("myWriterControl");
            ctl.DCExecuteCommand("Fontborder", false, null);
        }
        function CharacterCircle() {
            var ctl = document.getElementById("myWriterControl");
            ctl.DCExecuteCommand("CharacterCircle", false, null);
        }

        function AutoFixTableWidth() {
            var ctl = document.getElementById("myWriterControl");
            ctl.AutoFixTableWidth();
        }


        function Cut() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Cut', false, null);
        }
        // 复制
        function Copy() {
            var myWriterControl = GetCurrentWriterControl();
            //myWriterControl.Copy();
            myWriterControl.DCExecuteCommand('Copy', false, null);
        }

        //字体
        function Font() {
            var ctl = GetCurrentWriterControl();
            ctl.DCExecuteCommand('Font', true, null);
        }
        function Search() {
            var ctl = GetCurrentWriterControl();
            ctl.SearchAndReplaceDialog(null, ctl);
            //var name = prompt("请输入需要查找的内容：", "")
            //if (name != null && name != "") {
            //   var options = {
            //      "searchstring": name,//要查找的字符串
            //      "enablereplacestring": false,//是否启用替换
            //      "backward": true,//是否向后替换
            //      "ignorecase": true,//是否区分大小写
            //      "logundo": true,//记录撤销操作信息
            //      "excludebackgroundtext": true,//忽略掉背景文字
            //      "SearchID": true //是否限制为查询元素编号
            //   }
            //   var ctl = GetCurrentWriterControl();
            //   var result = ctl.Search(options);
            //   alert("查找结果：" + result);
            //}
        }
        function Paste() {
            console.log("测试Paste");
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Paste', false, null);
        }
        function ReadOnly() {
            console.log("测试ReadOnly");
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.Readonly;
            myWriterControl.Readonly = !result;
        }
        function FormView() {
            console.log("测试FormView");
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.FormView;

            if (result == 0) {
                myWriterControl.FormView = 2;//Normal;
            }
            else {
                myWriterControl.FormView = 0;//Disable
            }
        }
        function ReadViewMode() {
            console.log("测试ReadViewMode");
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.ReadViewMode;
            myWriterControl.ReadViewMode = !result;
        }
        function HeaderFooterReadonly() {
            console.log("测试HeaderFooterReadonly");
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.HeaderFooterReadonly;
            myWriterControl.HeaderFooterReadonly = !result;
        }
        function RefreshDocument() {
            console.log("测试RefreshDocument");
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.RefreshDocument();
        }
        function CurrentStyle() {
            console.log("测试CurrentStyle");
            var myWriterControl = GetCurrentWriterControl();
            console.log(myWriterControl.CurrentStyle);
        }
        function paragraphFormat() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.DCExecuteCommand("paragraphformat", true, null);
            console.log(result);
        }
        function DownLoadFile(format) {
            if (format == null || format == "") {
                format = "xml";
            }
            if (format == 'doc') {
                DownLoadFiledoc();
            }
            else {
                let ctl = GetCurrentWriterControl();
                ctl.DownLoadFile(format);
            }

        }
        function DownLoadFiledoc() {
            let myWriterControl = GetCurrentWriterControl();
            var strServicePageUrl = myWriterControl.getAttribute("servicepageurl");
            let format = 'rtf';
            if (strServicePageUrl == null || strServicePageUrl.length == 0) {
                console.log("DCWriter:未配置ServicePageUrl,无法生成文件" + format);
                return false;
            }
            var strFileName = Date.now();
            var strUrl = strServicePageUrl + "?wasm=downloadfile&format=" + format + "&dcbid2022=" + DCTools20221228.GetClientID();
            if (strFileName != null && strFileName.length > 0) {
                strUrl = strUrl + "&filename=" + decodeURI(strFileName);
            }
            var postData = myWriterControl.__DCWriterReference.invokeMethod("InnerForDownloadFile");
            var strDataType = null;

            strDataType = "application/msword;charset=utf-8";
            strFileName = strFileName + ".doc";

            var xhr = new XMLHttpRequest();
            xhr.open("POST", strUrl, true);
            xhr.responseType = "blob";
            xhr.onload = function () {
                if (this.status == 200) {
                    var blob = this.response;
                    let downloadElement = document.createElement("a");
                    let href = window.URL.createObjectURL(blob); //创建下载的链接
                    downloadElement.href = href;
                    downloadElement.download = strFileName;// file.name; //下载后文件名
                    document.body.appendChild(downloadElement);
                    downloadElement.click(); //点击下载
                    document.body.removeChild(downloadElement); //下载完成移除元素
                    window.URL.revokeObjectURL(href); //释放掉blob对象
                }
            };
            xhr.send(postData);
        }
        function AutoZoom() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.AutoZoom;

            myWriterControl.AutoZoom = !result;
            myWriterControl.RefreshDocument();
        }
        function SelectedText() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.SelectedText;
            alert(result);
        }
        function SelectedHtml() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.GetHtmlText(true);
            alert(result);
        }
        function SelectedXml() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.Selection.XMLText;
            console.log(result);
            alert(result);
        }
        function SetCurrentInputText() {
            var myWriterControl = GetCurrentWriterControl();
            let input = myWriterControl.CurrentInputField;
            console.log(input);
            if (input != null) {
                let id = input.ID;
                myWriterControl.SetElementTextByID(id, "XXXXX");
            }
        }

        // 清空
        function ClearContent() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.ClearContent();
            console.log(result);
        }

        // 新建
        function FileNew() {
            var myWriterControl = GetCurrentWriterControl();
            if (myWriterControl.getModified()) {

                let res = confirm('内容已经改变，是否确认要清空？');
                if (res == true) {
                    var result = myWriterControl.DCExecuteCommand("FileNew", false, null);
                    console.log(result);
                    return;
                }
            }
            else {
                var result = myWriterControl.DCExecuteCommand("FileNew", false, null);
                console.log(result);
            }
        }
        function setCommentVisible() {
            var myWriterControl = GetCurrentWriterControl();
            let cv = myWriterControl.DocumentOptions.BehaviorOptions.CommentVisibility;
            if (cv.toLowerCase() == "auto" || cv.toLowerCase() == "visible") {
                myWriterControl.DocumentOptions.BehaviorOptions.CommentVisibility = "Hide";
            }
            else {
                myWriterControl.DocumentOptions.BehaviorOptions.CommentVisibility = "Auto";
            }
            myWriterControl.ApplyDocumentOptions();
            myWriterControl.RefreshDocument();
        }

        // 保存xml
        function SaveXmlString() {
            let startTime = +new Date()
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.SaveDocumentToString('xml');
            console.log(result);
            let endTime = +new Date()
            let saveId = myWriterControl.id

            try {
                //存储加载文档花费毫秒，用于提供给性能页面
                let indexPerformanceTiming = {}
                if (window.localStorage.getItem('indexPerformanceTiming')) {
                    indexPerformanceTiming = {
                        ...JSON.parse(window.localStorage.getItem('indexPerformanceTiming'))
                    }
                }
                indexPerformanceTiming['saveXmlWriterControlTime'] = {
                    ...(indexPerformanceTiming.saveXmlWriterControlTime || []),
                    [saveId]: endTime - startTime
                }
                window.localStorage.setItem('indexPerformanceTiming', JSON.stringify(indexPerformanceTiming))
            } catch (error) {

            }


        }

        // 保存json
        function SaveJsonString() {
            let startTime = +new Date()
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.SaveDocumentToString('json');
            console.log(result);
            let endTime = +new Date()
            let saveId = myWriterControl.id
            try {
                //存储加载文档花费毫秒，用于提供给性能页面
                let indexPerformanceTiming = {}
                if (window.localStorage.getItem('indexPerformanceTiming')) {
                    indexPerformanceTiming = {
                        ...JSON.parse(window.localStorage.getItem('indexPerformanceTiming'))
                    }
                }
                indexPerformanceTiming['saveJsonWriterControlTime'] = {
                    ...(indexPerformanceTiming.saveJsonWriterControlTime || []),
                    [saveId]: endTime - startTime
                }
                window.localStorage.setItem('indexPerformanceTiming', JSON.stringify(indexPerformanceTiming))
            } catch (error) {

            }
        }
        //ajax获取模板列表
        function getPresentationDocument() {
            if (window['presentationDocumentList']) {
                // renderPresentation(window['presentationDocumentList'], 'presentationDocumentContent')
                return
            }
            $.ajax({
                type: "Post",
                url: 'http://www.dcwriter.cn:6969/DCWebServiceConvert.asmx/GetDocumentList',
                contentType: "application/json; charset=utf-8",
                success: (data) => {
                    if (data && data.d && data.d.Obj) {
                        //缓存模板列表
                        window['presentationDocumentList'] = [...data.d.Obj]
                        renderPresentation(data.d.Obj, 'presentationDocumentContent')
                    }
                }
            })
        }
        //渲染模板列表dom
        function renderPresentation(data, parentId) {
            let parentNodeStr = ''
            for (var i = 0; i < data.length; i++) {
                let obj = data[i]
                let childrenItem = ''
                if (obj.ChildNodes && obj.ChildNodes.length) {
                    for (var j = 0; j < obj.ChildNodes.length; j++) {
                        childrenItem += `<div class="childrenItem" id="${obj.ChildNodes[j].NodeName}" fildUrl="${obj.NodeName}/${obj.ChildNodes[j].NodeName}">
                                     <p  class="childrenItem_p"  title="${obj.ChildNodes[j].NodeName}" ><img class="fileTextImg" src="./img/fileText.png" />${obj.ChildNodes[j].NodeName}</p>
                                  </div>`
                    }
                }
                parentNodeStr += `<div class="parentItem" isFlag="hide" id="${obj.NodeName}">
                               <p class="parentItem_p"><img class="wjjImg" src="./img/wjj.png"/>${obj.NodeName}</p>
                               ${childrenItem}
                            </div>`
            }
            document.getElementById(parentId).innerHTML = parentNodeStr

            //模板文件夹绑定点击事件
            jQuery('.parentItem').click(function () {
                if (this.getAttribute('isFlag')) {
                    if (this.getAttribute('isFlag') === 'hide') {
                        jQuery(this).find('.childrenItem').show()
                        jQuery(this).attr('isFlag', 'show')
                    } else if (this.getAttribute('isFlag') === 'show') {
                        jQuery(this).find('.childrenItem').hide()
                        jQuery(this).attr('isFlag', 'hide')
                    }
                }
            })
            //模板文件绑定点击事件
            jQuery('.childrenItem').click(function (event) {
                event.stopPropagation();
                var itemNode = jQuery(this);
                var controlid = itemNode.attr("controlid");
                if (controlid) {
                    var wasmNode = jQuery("#" + controlid + "[dctype=WriterControlForWASM]");
                    if (wasmNode.length == 1) {
                        var _id = this.id;
                        console.log(_id)
                        if ($('#tt').tabs("exists", _id)) {
                            $('#tt').tabs("select", _id);
                        }
                        return;
                    };
                }
                //请求xml文档
                let fileName = jQuery(this).attr('id')
                if (jQuery(this).attr('fildUrl')) {
                    jQuery.ajax({
                        url: `http://www.dcwriter.cn:6969/演示文档/${jQuery(this).attr('fildUrl')}.xml`,
                        success: (data) => {
                            if (data) {
                                //获取到最后一个tab页
                                var strServicePageUrl = null;
                                var allControl = document.querySelectorAll("div[dctype='WriterControlForWASM']");
                                var lastIndex = 0;
                                if (allControl != null && allControl.length > 0) {
                                    lastIndex = allControl[allControl.length - 1].getAttribute('id').match(/[0-9]+/g);
                                    strServicePageUrl = allControl[0].getAttribute("servicepageurl");
                                    if (lastIndex == null) {
                                        lastIndex = 0;
                                    } else {
                                        lastIndex = lastIndex[0];
                                    }
                                }
                                var newControlID = "myWriterControl" + (parseFloat(lastIndex) + 1);
                                itemNode.attr("controlid", newControlID);
                                //在此处切换tab页
                                $('#tt').tabs('add', {
                                    title: fileName,
                                    content: `<div id="${newControlID}"
                                 dctype="WriterControlForWASM"
                                 style="height: 100%; background-color: rgb(230, 230, 230); border-bottom: 0px solid black; background-attachment: fixed; background-size: cover; background-position: center top; "
                                 ${WRITERCONTROLOPTIONS}>正在加载...</div>`,
                                    closable: true,
                                });
                                var newCtl = document.getElementById(newControlID);
                                newCtl.setAttribute("servicepageurl", strServicePageUrl);
                                window.CreateWriterControlForWASM(newCtl);
                                newCtl.LoadDocumentFromString(data.documentElement.outerHTML, 'xml');
                            }
                        }
                    })
                }

            })
        }

        //获取痕迹列表
        function GetTracesList() {
            let ctl = GetCurrentWriterControl();
            let data = ctl.GetDocumentUserTrackInfos()
            let parentNodeStr = ''
            for (var i = 0; i < data.length; i++) {
                let obj = data[i]
                parentNodeStr += `
                <div class="TracesListContentItem" NativeHandle="${obj.NativeHandle}">
                   <p style="width: 100%;border-bottom:1px solid #ebeef5;font-weight: 600;">${obj.UserName}</p>
                   <div style="width: 100%;margin-top:10px;word-break: break-all;white-space: pre-wrap;">${obj.InfoType === 'Create' ? '输入' : '删除'}：${obj.Text}</div>
                   <p style="width: 100%;text-align: right;color:#8c8c8c;">${times(obj.SaveTime)}</p>
                </div>`
            }
            document.getElementById('TracesListContent').innerHTML = parentNodeStr
            jQuery('.TracesListContentItem').click(function () {
                let NativeHandle = this.getAttribute('NativeHandle')
                ctl.NavigateByUserTrackInfo(Number(NativeHandle))
            })
        }
        //时间转换
        function times(savetime) {
            var time = new Date(savetime);
            var years = time.getFullYear();
            var months = time.getMonth() + 1;
            var dates = time.getDate();
            var hours = time.getHours().toString().padStart(2, "0");
            var minutes = time.getMinutes().toString().padStart(2, "0");
            var Senconds = time.getSeconds().toString().padStart(2, "0");
            var myTime = ` ${years}年${months}月${dates}日${hours}:${minutes}:${Senconds} `
            return myTime;
        }
        //演示文档弹框打开
        function PresentationDocument() {
            let isFlag = jQuery("#presentationDocumentButton").attr('isFlag')
            if (isFlag && isFlag === 'hide') {
                jQuery("#presentationDocumentBox").show(300)
                jQuery("#resize").show(300)
                jQuery("#presentationDocumentButton").attr('isFlag', 'show')
                jQuery("#tt").find(".tabs-header,.tabs-wrap,.tabs-panels,.panel,.panel-body").width("100%");
                jQuery("#presentationDocumentButton").addClass('disableButton')
                //tab切换
                jQuery('.tabItem').click(function () {
                    if (![...this.classList].includes('active')) {
                        jQuery('.tabItem').removeClass('active')
                        jQuery(this).addClass('active')
                        jQuery('.boxItem').hide()
                        jQuery(`#${jQuery(this).attr('tabId')}`).show()
                        // if (jQuery(this).attr('tabId') === 'courseListBox') {
                        //     // getCourseList()
                        // }
                        if (jQuery(this).attr('tabId') === 'TracesList') {
                            GetTracesList()
                        }
                    }
                })
                getPresentationDocument()//默认展示模板列表
                jQuery('.backImg').click(() => { closePresentationDocumentBox() })//关闭演示文档的方法
                // jQuery('.refreshImg').click(() => { getCourseList() })
                jQuery('#RefreshTracesList').click(() => { GetTracesList() })
            }
        }
        //关闭演示文档的方法
        function closePresentationDocumentBox() {
            jQuery('#presentationDocumentBox').hide(300)
            jQuery("#resize").hide(300)
            jQuery("#presentationDocumentButton").attr('isFlag', 'hide')
            jQuery("#presentationDocumentButton").removeClass('disableButton')
            jQuery("#tt").find(".tabs-header,.tabs-wrap,.tabs-panels,.panel,.panel-body").width("100%");
        }

        //边框拖拽
        function dragControllerDiv() {
            var resize = document.getElementById('resize');
            var lleft = document.getElementById('presentationDocumentBox');
            var box = document.getElementById('box');
            var rright = document.getElementById('tt');
            var rw = resize.offsetWidth;
            var w = box.offsetWidth;
            resize.onmousedown = function (e) {
                var startX = e.clientX;
                resize.left = resize.offsetLeft;
                // 鼠标拖动事件
                document.onmousemove = function (e) {
                    var moveLen = resize.left + (e.clientX - startX);
                    resize.style.left = moveLen;
                    lleft.style.width = moveLen + 'px';
                    rright.style.width = (w - rw - moveLen) + 'px';
                }
                // 鼠标松开事件
                document.onmouseup = function (evt) {
                    document.onmousemove = null;
                    document.onmouseup = null;
                    resize.releaseCapture && resize.releaseCapture();
                }
                resize.setCapture && resize.setCapture();
            }
        }
        // 打开本地文件
        function fileOpen() {
            let myWriterControl = GetCurrentWriterControl();
            let file = document.createElement('input');
            file.setAttribute('id', 'dcInputFile');
            file.setAttribute('type', 'file');
            file.setAttribute('accept', '.xml,.json,.rtf,.html,.htm,.odt');
            file.style.display = 'none';
            myWriterControl.appendChild(file);
            file.click();
            //file文件选中事件
            file.onchange = function () {
                let fileList = this.files;
                if (fileList.length > 0) {
                    console.log(fileList[0]);
                    let reader = new FileReader();
                    reader.readAsText(fileList[0], "UFT-8");
                    reader.onload = function (e) {
                        //获取到文件内容
                        let strFileContent = e.target.result;
                        //获取文件格式
                        let fileFormat = "xml";
                        var fileName = '新建文档';
                        fileFormat = fileList[0].name.substring(fileList[0].name.lastIndexOf(".") + 1);
                        fileName = fileList[0].name.substring(0, fileList[0].name.lastIndexOf("."));
                        console.log(fileName, '==========fileName')
                        //let myWriterControl = GetCurrentWriterControl();

                        //获取到最后一个tab页
                        var strServicePageUrl = null;
                        var allControl = document.querySelectorAll("div[dctype='WriterControlForWASM']");
                        var lastIndex = 0;
                        if (allControl != null && allControl.length > 0) {
                            lastIndex = allControl[allControl.length - 1].getAttribute('id').match(/[0-9]+/g);
                            strServicePageUrl = allControl[0].getAttribute("servicepageurl");
                            if (lastIndex == null) {
                                lastIndex = 0;
                            } else {
                                lastIndex = lastIndex[0];
                            }
                        }
                        var newControlID = "myWriterControl" + (parseFloat(lastIndex) + 1);
                        //在此处切换tab页
                        $('#tt').tabs('add', {
                            title: fileName,
                            content: `<div id="${newControlID}"
                                 style="height: 100%; background-color: rgb(230, 230, 230); border-bottom: 0px solid black; background-attachment: fixed; background-size: cover; background-position: center top; "
                                 ${WRITERCONTROLOPTIONS}>正在加载...</div>`,
                            closable: true,
                        });
                        //此处为加载样式，未初始化所以暂时注释
                        var newCtl = document.getElementById(newControlID);
                        newCtl.setAttribute("servicepageurl", strServicePageUrl);
                        window.CreateWriterControlForWASM(newCtl);
                        newCtl.LoadDocumentFromString(strFileContent, fileFormat, null, function (validate) {
                            alert(validate)
                            console.log(validate, '===================文档格式校验')
                        });
                    }
                }
            }
            //在编辑器的window重新获取焦点时,确保点击取消或X时能正确删除file
            window.addEventListener('focus', function () {
                setTimeout(function () {
                    if (file.parentNode == myWriterControl) {
                        myWriterControl.removeChild(file);
                    }
                }, 100);
            }, { once: true })
        }

        // 刷新
        function Refresh() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.RefreshDocument();
        }
        function PdfPrintPreview() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.SaveDocumentToString('xml');
            var data = { "xml": result };
            $.ajax({
                url: "http://www.dcwriter.cn:6969/DCWebServiceConvert.asmx/TransformXMLToBase64PDF",
                type: "post",
                data: JSON.stringify(data),
                contentType: "application/json",
                dataType: "json",
                success: function (data) {
                    // alert(data.d);
                    var str = "data:application/pdf;base64," + data.d;
                    var embed = document.createElement("embed");
                    embed.setAttribute("src", str);
                    embed.setAttribute("type", "application/pdf");
                    embed.style.width = "100%";
                    embed.style.height = "100%";
                    var myWindow = window.open('', '');
                    myWindow.document.body.style.margin = 0;
                    myWindow.document.body.appendChild(embed);
                    myWindow.focus();
                },
                error: function (eer) {
                    alert("发送ajax请求失败！");
                    console.log(eer);
                }
            });
        }

        function MedicalExpression1() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression1",
                "ExpressionStyle": "FourValues1",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:14;Value2:14;Value3:14;Value4:14"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression2() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression2",
                "ExpressionStyle": "FourValues2",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:14;Value2:14;Value3:14;Value4:14"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression3() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression3",
                "ExpressionStyle": "ThreeValues",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:14;Value2:14;Value3:14"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression4() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression4",
                "ExpressionStyle": "FourValues",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:14;Value2:14;Value3:14;Value4:14"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression5() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression5",
                "ExpressionStyle": "Pupil",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:14;Value2:14;Value3:14;Value4:14;Value5:14;Value6:14;Value7:14;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression6() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression6",
                "ExpressionStyle": "FetalHeart",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:14;Value2:14;Value3:14;Value4:14;Value5:14;Value6:14;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        //眼球突出度
        function EyeballProtrusion() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression7",
                "ExpressionStyle": "ThreeValues2",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:0;Value2:1;Value3:2;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        //斜视符号
        function SquintSymbol() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression8",
                "ExpressionStyle": "StrabismusSymbol",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:L;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression7() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression9",
                "ExpressionStyle": "PainIndex",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:14;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression8() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression10",
                "ExpressionStyle": "PermanentTeethBitmap",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:1;Value2:2;Value3:3;Value4:4;Value5:5;Value6:6;Value7:7;Value8:8;Value9:9;Value10:10;Value11:11;Value12:12;Value13:13;Value14:14;Value15:15;Value16:16;Value17:17;Value18:18;Value19:19;Value20:20;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression9() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression11",
                "ExpressionStyle": "DeciduousTeech",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:1;Value2:2;Value3:3;Value4:4;Value5:5;Value6:6;Value7:7;Value8:8;Value9:9;Value10:10;Value11:11;Value12:12;Value13:13;Value14:14;Value15:15;Value16:16;Value17:17;Value18:18;Value19:19;Value20:20;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression10() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression12",
                "ExpressionStyle": "Fraction",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:1;Value2:2;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression11() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression13",
                "ExpressionStyle": "DiseasedTeethTop",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:1;Value2:2;Value3:2;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }
        function MedicalExpression12() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ID": "expression14",
                "ExpressionStyle": "DiseasedTeethBotton",
                "Type": "XTextNewMedicalExpressionElement",
                "FontSize": "12",
                "Width": "112px",
                "Height": "46px",
                "Values": "Value1:1;Value2:2;Value3:2;"
            };
            ctl.DCExecuteCommand("insertmedicalexpression", true, options);
        }

        // 选择内容保存
        function SaveSelection(format) {
            if (format == null || format == "") {
                format = "xml";
            }
            var myWriterControl = GetCurrentWriterControl();
            if (format == 'html') {
                var result = myWriterControl.SelectionHtml(true);
                console.log(result);
                alert(result);
            }
            else if (format == 'txt') {
                var result = myWriterControl.SelectionText(true);
                console.log(result);
                alert(result);
            }
            else if (format == 'xml') {
                var result = myWriterControl.SelectionXml(true);
                console.log(result);
                alert(result);
            }
            else if (format == 'json') {
                var result = myWriterControl.SelectionJson(true);
                console.log(result);
                alert(result);
            }
        }

        // 打印当前页
        function PrintCurrentPage() {
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                PrintRange: "CurrentPage"
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        function PrintSpecifyPage() {
            var specifyPages = prompt("请输入打印的指定页：", '0')
            if (specifyPages != null && specifyPages != "") {
                console.log(specifyPages);
                var ctl = GetCurrentWriterControl();
                let CreatePrintOptions =
                {
                    PrintRange: "SomePages",
                    SpecifyPageIndexs: specifyPages,
                    CleanMode: true
                };
                ctl.PrintDocument(CreatePrintOptions);
            }

        }
        function PrintSelection() {
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                PrintRange: "Selection",//打印被选中的内容
                CleanMode: true
            };
            ctl.PrintDocument(CreatePrintOptions);
        };
        function PrintOdd() {
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                PrintMode: "EvenPage",//由于是0开始，所以奇偶数颠倒
                CleanMode: true
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        function PrintEven() {
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                PrintMode: "OddPage",//由于是0开始，所以奇偶数颠倒
                CleanMode: true
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        function SomePagesPrint() {
            var frompage = $('#FromPage').val();
            var topage = $('#ToPage').val();

            frompage = parseInt(frompage);
            topage = parseInt(topage);
            if (Number.isInteger(frompage) == false || Number.isInteger(topage) == false) {
                alert("请在开始页和结束页中输入数字");
                return;
            }
            if (frompage < 0 || topage < 0 || frompage > topage) {
                alert("开始页码数和结束页码数不正确");
                return;
            }

            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                PrintMode: "SomePages",
                FromPage: frompage, // 默认0，从0开始计算的打印开始页码
                ToPage: topage,//默认为总页数, 从0开始计算的打印结束开始页码
                CleanMode: true
            };
            ctl.PrintDocument(CreatePrintOptions);

        }

        function SpecifyPagesPrint() {
            var SpecifyPages = $('#SpecifyPages').val();
            if (SpecifyPages != null && SpecifyPages != "") {

                var ctl = GetCurrentWriterControl();
                let CreatePrintOptions =
                {
                    PrintMode: "SomePages",
                    SpecifyPageIndexs: SpecifyPages,
                    CleanMode: true
                };
                ctl.PrintDocument(CreatePrintOptions);
            }
        }
        function JumpPrintModeBySubID() {
            var JumpPrintStartSubID = $('#JumpPrintStartSubID').val();
            var JumpPrintEndSubID = $('#JumpPrintEndSubID').val();
            if (JumpPrintStartSubID != null && JumpPrintStartSubID != "" && JumpPrintEndSubID != null && JumpPrintEndSubID != "") {
                var ctl = GetCurrentWriterControl();
                let CreatePrintOptions =
                {
                    JumpPrintStartElementID: JumpPrintStartSubID,// 续打开始处的文档元素编号，若该属性值有效，则续打开始位置为该指定ID的元素的上边缘。
                    JumpPrintEndElementID: JumpPrintEndSubID,// 续打结束处元素编号，若该属性值有效，则结束处续打的开始位置为指定ID的元素的下边缘。
                    CleanMode: true,
                    CompletedCallback: function () {
                        let lastPrintresult = ctl.GetPrintResult();
                        console.log("打印的结果", lastPrintresult);
                    }
                };
                ctl.PrintDocument(CreatePrintOptions);
            }
        }

        function JumpPrintModeByElementID() {
            var JumpPrintStartElementID = $('#JumpPrintStartElementID').val();
            var JumpPrintEndElementID = $('#JumpPrintEndElementID').val();
            if (JumpPrintStartElementID != null && JumpPrintStartElementID != "" && JumpPrintEndElementID != null && JumpPrintEndElementID != "") {
                var ctl = GetCurrentWriterControl();
                let CreatePrintOptions =
                {
                    JumpPrintStartElementID: JumpPrintStartElementID,// 续打开始处的文档元素编号，若该属性值有效，则续打开始位置为该指定ID的元素的上边缘。
                    JumpPrintEndElementID: JumpPrintEndElementID,// 续打结束处元素编号，若该属性值有效，则结束处续打的开始位置为指定ID的元素的下边缘。
                    CleanMode: true
                };
                ctl.PrintDocument(CreatePrintOptions);
            }
        }
        function LayoutOffsetPrint() {
            var BodyLayoutOffset = $('#BodyLayoutOffset').val();

            BodyLayoutOffset = parseInt(BodyLayoutOffset);
            if (Number.isInteger(BodyLayoutOffset) == false) {
                alert("请输入偏移量数字");
                return;
            }
            if (BodyLayoutOffset < 0) {
                alert("偏移量不正确");
                return;
            }
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                BodyLayoutOffset: BodyLayoutOffset,
                CleanMode: true
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        function JumpPrint() {

            var PageIndex = $('#PageIndex').val();
            var Position = $('#Position').val();
            var EndPageIndex = $('#EndPageIndex').val();
            var EndPosition = $('#EndPosition').val();

            PageIndex = parseInt(PageIndex);
            Position = parseInt(Position);
            EndPageIndex = parseInt(EndPageIndex);
            EndPosition = parseInt(EndPosition);

            if (PageIndex > EndPageIndex) {
                alert("开始页码数和结束页码数不正确");
                return;
            }

            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                JumpPrint: { // 续打信息
                    PageIndex: PageIndex,// 从0开始计算的续打开始的页码
                    Position: Position,// 开始续打的位置
                    EndPageIndex: EndPageIndex,// 从0开始计算的下端续打的页码
                    EndPosition: EndPosition// 下端续打的位置
                },
                CleanMode: true
            };
            ctl.PrintDocument(CreatePrintOptions);

        }





        function LocalPrint() {

            var printserver = "http://localhost:8181";
            var name = prompt("请输入本地打印服务地址：）：", printserver)
            if (name != null && name != "") {

                let ctl = GetCurrentWriterControl();
                var options = {
                    ShowUI: false,  //是否弹出打印对话框
                    PrinterName: null,  //自定义打印机名称，若为空则选择默认打印机
                    PrintPageRange: "all",  //支持格式"2,5-7,9"等混合格式
                    OffsetY: 0,
                    AutoFitPageSize: true,
                    CleanMode: true,
                    ManualDuplex: false,
                    Files: null,   //为空则打印当前文档，可设为二维数组支持混合合并文档打印
                    JumpPrintPosition: null,
                    JumpPrintEndPosition: null

                };
                ctl.setAttribute("PrintServicePageUrl", name);
                ctl.LocalPrintDocuments(options, function (args) {
                    console.log(args);
                });
            }
        }

        // 打印选择内容
        function SelectionPrint() {
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                CleanMode: true,
                PrintRange: "Selection"
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        // 区域选择打印
        function BoundsSelectionPrint() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('BoundsSelectionViewMode', false, null);
        }
        function CleanModePrint(value) {
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                CleanMode: value
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        function JumpPrintMode() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('JumpPrintMode', false, null);
        }
        //参数续打
        function JumpPrint() {
            var ctl = GetCurrentWriterControl();
            let CreatePrintOptions =
            {
                CleanMode: true,
                JumpPrint: { // 续打信息
                    PageIndex: 1,// 从0开始计算的续打开始的页码
                    Position: 500,// 开始续打的位置
                    EndPageIndex: 2,// 从0开始计算的下端续打的页码
                    EndPosition: 500// 下端续打的位置
                }
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        // 偏移续打
        function OffetJumpPrint() {

            var name = prompt("请输入偏移续打位置：", '500')
            if (name != null && name != "") {
                var setvalue = parseFloat(name);
                var ctl = GetCurrentWriterControl();
                let CreatePrintOptions =
                {
                    CleanMode: true,
                    BodyLayoutOffset: setvalue
                };
                ctl.PrintDocument(CreatePrintOptions);
            }
        }
        //打印为PDF
        function PrintAsPDF() {
            let ctl = GetCurrentWriterControl()
            ctl.PrintAsPDF();
            //{CompletedCallback:function(){alert('打印成功');}}
        }
        // 打印为Html
        function PrintAsHtml() {
            let ctl = GetCurrentWriterControl();
            ctl.PrintAsHtml(null, null, {
                isPrint: true,
                printCallBack: function (html, printFun) {
                    //console.log(html);
                    printFun();
                }
            });
        }
        //打印选择内容
        function SelectionPrint() {
            let ctl = GetCurrentWriterControl();

            let CreatePrintOptions =
            {
                PrintRange: "Selection"
            };
            ctl.PrintDocument(CreatePrintOptions);
        }
        //插入输入域
        function InsertInputFieldElement() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ContentReadonly": null,
                "UserEditable": true,
                "Deleteable": true,
                "ToolTip": "请输入年龄",
                "BackgroundText": "年龄",
                "Text": "30",
                "InnerValue": "30",
                "ValidateStyle": {
                    "BinaryLength": false,
                    "CheckDecimalDigits": false,
                    "CheckMaxValue": true,
                    "CheckMinValue": false,
                    "CustomMessage": "",
                    "DateTimeMaxValue": "1980/1/1 上午12:00:00",
                    "DateTimeMinValue": "1980/1/1 上午12:00:00",
                    "ExcludeKeywords": "",
                    "IncludeKeywords": "",
                    "Level": "Error",
                    "MaxDecimalDigits": 0,
                    "MaxLength": 0,
                    "MaxValue": 0,
                    "Message": null,
                    "MinLength": 0,
                    "MinValue": 0,
                    "Range": null,
                    "RegExpression": "",
                    "Required": false,
                    "RequiredInvalidateFlag": false,
                    "ValueName": null,
                    "ValueType": "Text"
                },
                "EnableValueValidate": true,
                "Name": "年龄",
                "ID": "txtAge",
                "Alignment": "Near",
                "BackgroundTextColor": null,
                "TextColor": "red",
                "SpecifyWidth": "0",
                "BackgroundColor": "yellow",
                "StartBorderText": "【",
                "EndBorderText": "】",
                "LabelText": "年龄：",
                "UnitText": "岁",
                "EditorActiveMode": "F2, MouseDblClick, MouseClick"
            };
            ctl.DCExecuteCommand("InsertInputField", true, options);
        }

        function InsertListInputFieldElement() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ToolTip": "请双击",
                "BackgroundText": "下拉域",
                "ID": "txtList",
                "Alignment": "Far",
                "BackgroundTextColor": "blue",
                "TextColor": "red",
                "SpecifyWidth": "300",
                "InnerEditStyle": "DropDownList",
                "BackgroundColor": "yellow",
                "ListItems": [
                    {
                        Text: "男",
                        Value: "0"
                    },
                    {
                        Text: "女",
                        Value: "1"
                    },
                    {
                        Text: "未知",
                        Value: "3"
                    },
                ],
                "EditorActiveMode": "F2, MouseDblClick, MouseClick"

            };
            ctl.DCExecuteCommand("InsertInputField", true, options);
        }

        function InsertDateTimeInputFieldElement() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "ToolTip": "请双击",
                "BackgroundText": "时间域",
                "ID": "txtDate",
                "Alignment": "Far",
                "DisplayFormat": {
                    Format: "yyyy年MM月dd日",
                    Style: "DateTime"
                },
                "BackgroundTextColor": "blue",
                "TextColor": "red",
                "SpecifyWidth": "300",
                "InnerEditStyle": "DateTime",
                "BackgroundColor": "yellow",
                "EditorActiveMode": "F2, MouseDblClick, MouseClick"

            };
            ctl.DCExecuteCommand("InsertInputField", true, options);
        }

        //条形码、二维码
        function InsertBarcode() {
            var ctl = GetCurrentWriterControl();
            var options = {
                ID: "barcode1",
                Text: "1234566",
                Width: "1000",
                Height: "300",
                ShowText: true,
                TextAlignment: "Right",
                ValueBinding: {
                    DataSource: "datasourceforbarcode",
                    BindingPath: "path1"
                }
            };
            ctl.DCExecuteCommand("InsertBarcodeElement", true, options);
        }

        function InsertTDBarcode() {
            var ctl = GetCurrentWriterControl();
            var tdoptions = {
                ID: 'tdbarcode1', //元素ID
                Text: "http://www.dcwriter.cn:6788/", //二维码内容文本
                Width: 300, //像素宽度
                Height: 300, //像素高度
                ValueBinding: {
                    DataSource: "datasourcefortdbarcode",
                    BindingPath: "path2"
                }
            }
            ctl.DCExecuteCommand('InsertTDBarcodeElement', true, tdoptions)
        }
        function InsertPageInfo() {
            var ctl = GetCurrentWriterControl();
            var options = {
                ID: "pageinfo1", //页码ID，可为空
                Height: "65",   //页码元素高度，可为空
                Width: "400",   //页码元素宽度，可为空
                ValueType: "PageIndex", //页码元素类型,PageIndex代表显示为当前页号，NumOfPages显示为总页数，可为空
                FormatString: "第[%PageIndex%]页 共[%NumOfPages%]页" //页码文本格式化字符串，可为空
                //SpecifyPageIndexTextList: "1,2,3,4"//自定义页码序号列表，可为空
            };
            ctl.DCExecuteCommand('InsertPageInfoElement', true, options)
        }
        function InsertMedicalExpression() {
            var ctl = GetCurrentWriterControl();
            if (ctl != null) {
                var options = {
                    ID: "medical",
                    ExpressionStyle: "FourValues2",
                    Width: "500",
                    Height: "500",
                    Values: "Value1: 14; Value2: 7; Value3: 38; Value4: 30"
                };
                ctl.DCExecuteCommand("InsertMedicalExpression", true, options);
            }
        };
        function InsertRadioBox() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "Name": "name001", //单选框的Name属性相同
                "Type": "radio", //radio、checkbox
                "ListItems": [
                    {
                        "ID": "chk1",
                        "ToolTip": "提示信息1",
                        "MultiLine": "true",
                        "Checked": "false",
                        "StringTag": "附加数据1",
                        "VisualStyle": "RadioBox", //"Default", "CheckBox", "RadioBox", "SystemDefault", "SystemCheckBox", "SystemRadioBox"
                        "Text": "男性",
                        "Value": "值1",
                        "CaptionFlowLayout": "true"
                    },
                    {
                        "ID": "chk2",
                        "ToolTip": "提示信息2",
                        "MultiLine": "false",
                        "Checked": "true",
                        "StringTag": "附加数据2",
                        "VisualStyle": "RadioBox", //"Default", "CheckBox", "RadioBox", "SystemDefault", "SystemCheckBox", "SystemRadioBox"
                        "Text": "女性",
                        "Value": "值2",
                        "CaptionFlowLayout": "true"
                    }
                ]
            };
            ctl.DCExecuteCommand("InsertCheckBoxOrRadio", true, options);
        };
        //单选框属性
        function RadioBoxProperties() {
            var ctl = GetCurrentWriterControl();
            var element = ctl.CurrentElement("xtextradioboxelement");
            console.log(element);
            ctl.CheckboxAndRadioDialog({});
        }
        function InsertCheckBox() {
            var ctl = GetCurrentWriterControl();
            var options = {
                "Name": "name001", //单选框的Name属性相同
                "Type": "checkbox", //radio、checkbox
                "ListItems": [
                    {
                        "ID": "chk1",
                        "ToolTip": "提示信息1",
                        "MultiLine": "true",
                        "Checked": "false",
                        "StringTag": "附加数据1",
                        "VisualStyle": "CheckBox", //"Default", "CheckBox", "RadioBox", "SystemDefault", "SystemCheckBox", "SystemRadioBox"
                        "Text": "高血压",
                        "Value": "值1",
                        "CaptionFlowLayout": "true"
                    },
                    {
                        "ID": "chk2",
                        "ToolTip": "提示信息2",
                        "MultiLine": "false",
                        "Checked": "true",
                        "StringTag": "附加数据2",
                        "VisualStyle": "CheckBox", //"Default", "CheckBox", "RadioBox", "SystemDefault", "SystemCheckBox", "SystemRadioBox"
                        "Text": "冠心病",
                        "Value": "值2",
                        "CaptionFlowLayout": "true"
                    }
                ]
            };
            ctl.DCExecuteCommand("InsertCheckBoxOrRadio", true, options);
        };
        function InsertLabel() {
            var ctl = GetCurrentWriterControl();
            var options = {
                ID: "label1",       //标签ID
                Text: "测试用标签",   //标签文本
                Bold: true,        //标签文本是否加粗，不设置则不加粗
                Deletable: true,   //标签是否可以删除，不设置则可以删除
                TitleLevel: -1,       //标签大纲级别，值从0到7，若不设置则此标签不作为大纲节点
                Attributes: {       //自定义属性，直接传JSON对象
                    Name: "张三",
                    Sex: "男",
                    Age: "20"
                },
                PageTexts: [
                    {
                        PageIndex: 0,
                        PageIndexText: "自定义文本aaa"
                    },
                    {
                        PageIndex: 1,
                        PageIndexText: "自定义文本bbb"
                    },
                    {
                        PageIndex: 2,
                        PageIndexText: "自定义文本ccc"
                    },
                    {
                        PageIndex: 3,
                        PageIndexText: "自定义文本ddd"
                    }
                ],
                ContactAction: "Normal",    //连接模式
                AttributeNameForContactAction: "科室",    //连接模式提取值的来源属性名称
                LinkTextForContactAction: "-"   //连接字符串
            };
            ctl.DCExecuteCommand("InsertLabelElement", true, options);
        }
        function InsertHorizontalLine() {
            var ctl = GetCurrentWriterControl();
            if (ctl != null) {
                var options = {
                    LineLengthInCM: "100px",
                    LineSize: "10px",
                    Color: "red",
                    LineStyle: "dashed",
                    ID: "hr1"
                };
                ctl.DCExecuteCommand('InsertHorizontalLine', true, options);
            }
        }
        function InsertButton() {
            var ctl = GetCurrentWriterControl();
            var options = {
                ID: "button1",
                Height: "100",
                Width: "500",
                Deleteable: false,
                PrintVisibility: "Visible",
                Name: "btnName",
                Enabled: true,
                PrintAsText: false,
                AutoSize: false,
                Text: "按钮文本",
                ScriptTextForClick: "",
                CommandName: "",
                ImgBase64: null,
                ImgBase64ForDown: bluepicbase64data,
                ImgBase64ForOver: null,
                ScriptTextForClick: "alert('哦呵呵呵呵呵')"
            };
            ctl.DCExecuteCommand('InsertButton', true, options)
            //ctl.EventButtonClick = function(eventSender , args ){
            //    //目前必须要定义一个前端EventButtonClick事件。
            //    //否则按钮元素的ScriptTextForClick会无法触发
            //}
        }
        function InsertPieElement() {
            var ctl = GetCurrentWriterControl();
            if (ctl != null) {
                var options = {
                    ID: "pie1",
                    Name: "pieName",
                    Width: 300,//注意这里给的是数字，单位是像素
                    Height: 300, //注意这里给的是数字，单位是像素
                    ShowLegend: "false",//是否显示图例
                    Thickness: 100,//饼图的厚度
                    PieDatas: [
                        {
                            Text: "aa",
                            Value: 10
                        },
                        {
                            Text: "bb",
                            Value: 20
                        },
                        {
                            Text: "cc",
                            Value: 40
                        }
                    ]
                };
                ctl.DCExecuteCommand("InsertPieElement", false, options);
            }
        }
        var bluepicbase64data = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAR8AAADeCAIAAACL9pO/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKWSURBVHhe7dOhDcAwEARBdxaaxtyLi3FRCQ6xApaNNOjh63Zc9wYK6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqAsq6oKKuqCiLqioCyrqgoq6oKIuqKgLKuqCirqgoi6oqIuztdac83PkSF2cvWmNYSq/eRlU1AUVdUFFXVBRF1TUBRV1QUVdUFEXVNQFFXVBRV1QURdU1AUVdUFFXVBRF1TUBRV1QUVdUFEXVNQFFXVBRV1QURdU1AUVdUFFXVBRF1TUBRV1QUVdUFEXVNQFFXVBRV1QURdU1AUVdUFFXVBRF1TUBRV1QUVdUFEXVNQFFXVBRV1QURdU1AUVdUFFXVBRF1TUBRV1QUVdUFEXVNQFFXVBRV1QURdU1AUVdUFFXVBRF1TUBRV1QUVdUFEXVNQFFXVBRV1QURdU1AUVdUFFXdC49wNy06ZYIL3nJAAAAABJRU5ErkJggg==";
        var redpicbase64data = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAR8AAADeCAYAAAAElAToAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAL/SURBVHhe7dYxEcJQEEDBH3SkjDFKNKSlRABe0BIJ0QBNNORlmN3m7gy8uWmfl+8AONntmACnEh8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxIe/9Xk9x/txPy6uRnz4W9u2jXVdj4urmfZ5+R47wGl8PkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+AAJ8QES4gMkxAdIiA+QEB8gIT5AQnyAhPgACfEBEuIDJMQHSIgPkBAfICE+QEJ8gIT4AAnxARLiAyTEB0iID5AQHyAhPkBCfICE+ACBMX4xbQ1I/hNElwAAAABJRU5ErkJggg==";
        var switchvalue = 0;
        function InsertImage() {
            var ctl = GetCurrentWriterControl();
            var options = {
                ID: "img1",
                Width: 200,
                Height: 200,
                SaveContentInFile: true,
                Src: bluepicbase64data
            };
            ctl.DCExecuteCommand("InsertImage", true, options);
        }
        //插入特殊字符
        function InsertSpecifyCharacter() {
            var ctl = GetCurrentWriterControl();
            ctl.DCExecuteCommand("InsertSpecifyCharacter", true, {});
        }
        function NewComment() {
            var ctl = GetCurrentWriterControl();
            var opts = {
                BackColor: "#FFFF00",
                BorderColor: "#FFFF00",
                ForeColor: "#000000",
                Text: "请检查这里的内容是否正确",
                author: "李四主任医师",
                AuthorID: "lisi",
            }
            ctl.DCExecuteCommand("insertcomment", true, opts);
        }
        function deleteComment2() {
            var ctl = GetCurrentWriterControl();
            var result = ctl.GetCurrentComment();
            console.log(result);
            if (result != null && result.Index != null && result.Index >= 0) {
                var x = confirm("是否确认删除该批注？");
                if (x) {
                    ctl.DCExecuteCommand('DeleteComment', false, null);
                    //var result = ctl.DeleteComment(result.Index);
                    //console.log(result);
                    myWriterControl.RefreshDocument();
                }
            }


        }
        function setCommentContent() {
            var ctl = GetCurrentWriterControl();
            var result = ctl.GetCurrentComment();
            console.log(result);
            if (result != null && result.Text != null && result.Text != "") {
                var name = prompt("请输入批注内容：", result.Text)
                if (name != null && name != "") {
                    var result2 = ctl.setCommentContent(result.Index, name);
                    console.log(result2);
                    myWriterControl.RefreshDocument();
                }
            }
        }

        // 网格线
        function PageGridLine() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DocumentGridLineDialog();
        }
        // 装订线
        function Gutter() {
            var ctl = GetCurrentWriterControl();
            ctl.DocumentGutterDialog();
        }
        // 水印
        function Watermark() {
            var ctl = GetCurrentWriterControl();
            ctl.WatermarkDialog();
        }

        // 违禁关键字
        function ExcludeKeywords() {
            var myWriterControl = GetCurrentWriterControl();

            let result = myWriterControl.GetExcludeKeywords();
            console.log(result);
            if (result == null || result == "" || result == "null") {
                result = "产科,卵巢,产褥期,子宫";
            }
            var name = prompt("请输入违禁关键词（多个词以英文逗号分割）：", result)
            if (name != null && name != "") {
                myWriterControl.SetExcludeKeywords(name);
            }
        }

        // 获取违禁关键字
        function GetExcludeKeywords() {
            var myWriterControl = GetCurrentWriterControl();
            let result = myWriterControl.GetExcludeKeywords();
            alert(result);
        }

        // 批注校验
        function DocumentValueValidateWithCreateDocumentComments() {
            var myWriterControl = GetCurrentWriterControl();
            let result = myWriterControl.DCExecuteCommand("DocumentValueValidateWithCreateDocumentComments", false, null);//.DocumentValueValidateWithCreateDocumentComments();
            if (result == null || result.length == 0) {
                alert("校验通过，病历中未发现违禁关键词。");
            }
            else {
                alert("校验未通过，病历中发现违禁关键词。");
            }
            console.log(result);
        }

        // 格式刷
        function FormatBrush() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('FormatBrush', false, null);
        }
        // 纯文本复制
        function CopyAsText() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('CopyAsText', false, null);
        }
        // 纯文本粘贴
        function PasteAsText() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('PasteAsText', false, null);
        }

        // 撤销
        function Undo() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Undo', false, null);
        }
        // 重做
        function Redo() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Redo', false, null);
        }

        // 对齐
        function AlignLeft() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.DCExecuteCommand('AlignLeft', false, null);
        }
        function AlignRight() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.DCExecuteCommand('AlignRight', false, null);
        }
        function AlignCenter() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.DCExecuteCommand('AlignCenter', false, null);
        }
        function AlignDistribute() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.DCExecuteCommand('AlignDistribute', false, null);
        }
        function AlignJustify() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.DCExecuteCommand('AlignJustify', false, null);
        }

        // 首行缩进
        function Indent() {
            let ctl = GetCurrentWriterControl();
            ctl.DCExecuteCommand("Indent", false, null);
        }
        function HangIndent() {
            let ctl = GetCurrentWriterControl();
            var options = {
                firstlineindent: "-88",
                leftindent: "236"
            };
            ctl.DCExecuteCommand("hangingindent", false, options);
        }
        //有序列表
        function insertorderedlist() {
            let ctl = GetCurrentWriterControl();
            ctl.DCExecuteCommand("insertorderedlist", false, null);
        }
        //无序列表
        function insertunorderedlist() {
            let ctl = GetCurrentWriterControl();
            ctl.DCExecuteCommand("insertunorderedlist", false, null);
        }
        function Rowspacing() {
            let result = prompt("请输入段前距的值：", "")
            if (result != null && result != "") {
                result = parseFloat(result)
                let ctl = GetCurrentWriterControl();
                ctl.DCExecuteCommand("rowspacing", false, result + ',top');
            }
        }
        function Rowspacing2() {
            let result = prompt("请输入段后距的值：", "")
            if (result != null && result != "") {
                result = parseFloat(result)
                let ctl = GetCurrentWriterControl();
                ctl.DCExecuteCommand("rowspacing", false, result + ',bottom');
                ctl.RefreshDocument();
            }
        }
        function lineheight() {
            let result = prompt("请输入行间距倍数：", "")

            if (result != null && result != "") {
                result = parseFloat(result)
                let ctl = GetCurrentWriterControl();
                ctl.DCExecuteCommand("lineheight", false, result);
                ctl.RefreshDocument();
            }
        }

        // 字体
        function FontChange(fontname) {
            if (fontname == null || fontname == "") {
                return;
            }
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('FontName', false, fontname);
        }

        // 字体大小
        function FontSize(size) {
            if (size == null || size == "") {
                return;
            }
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('FontSize', false, size);
        }
        // 加粗
        function Bold() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Bold', false, null);
        }
        // 斜体
        function Italic() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Italic', false, null);
        }

        // 下划线
        function UnderLine() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('UnderLine', false, null);
        }

        // 删除线
        function Strikeout() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Strikeout', false, null);
        }

        // 上标
        function Superscript() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Superscript', false, null);
        }

        // 下标
        function Subscript() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand('Subscript', false, null);
        }
        //放大缩小
        function SetZoomRate(value) {
            var rate = parseFloat(value);
            let ctl = GetCurrentWriterControl();
            var result = ctl.SetZoomRate(rate);
        }

        // 放大
        function ZoomIn() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("ZoomIn", false, null);
        }
        // 缩小
        function ZoomOut() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("ZoomOut", false, null);
        }
        // 表单模式
        function FormViewMode() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("FormViewMode", true, null);
        }

        // 设计模式
        function DesignMode() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("DesignMode", false, null);
        }

        // 普通表单模式
        function FormViewModeNormal() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("FormViewMode", false, "Normal");
        }
        //严格表单模式
        function FormViewModeStrict() {
            var ctl = GetCurrentWriterControl();
            ctl.DCExecuteCommand("FormViewMode", false, "Strict");
        }
        // 阅读模式
        function ReadView() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("ReadViewMode", false, null);
        }

        // 只读切换
        function ReadOnly() {
            var myWriterControl = GetCurrentWriterControl();
            var result = myWriterControl.Readonly;
            myWriterControl.Readonly = !result;
        }

        // 留痕模式
        function ComplexViewMode() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("ComplexViewMode", false, null);
        }
        // 清洁模式
        function CleanViewMode() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("CleanViewMode", false, null);
        }
        // 取消内容保护
        function ContentProtect(option) {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("ContentProtect", false, option);
        }
        function ContentProtect() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("ContentProtect", true, null);
        }

        // 用户登录
        function Login(ID1, Name1, ClientName1, PermissionLevel1, Description1) {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.UserLoginByUserLoginInfo(
                {
                    ID: ID1,// 用户编号
                    Name: Name1, // 用户名
                    ClientName: ClientName1, // 客户端电脑名称
                    PermissionLevel: PermissionLevel1, // 用户授权等级
                    Description: Description1 // 其他说明
                }, true);
            window.alert(Name1 + '登录成功');
        }

        // 页面展示
        function SetPageLayoutMode(value) {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.SetPageLayoutMode(value);
        }

        // 插入表格
        function InsertTable() {
            var myWriterControl = GetCurrentWriterControl();

            myWriterControl.DCExecuteCommand('InsertTable', true, null);

        }
        // 删除表格
        function DeleteTable() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_DeleteTable", false, null);
        }

        // 删除行删除列
        function DeleteTableRow() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_DeleteRow", false, null);
        }
        function DeleteTableColumn() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_DeleteColumn", false, null);
        }

        // 插入行列
        function InsertRowUp() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_InsertRowUp", false, null);
        }
        function InsertRowDown() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_InsertRowDown", false, null);
        }
        function InsertColumnLeft() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_InsertColumnLeft", false, null);
        }
        function InsertColumnRight() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_InsertColumnRight", false, null);
        }
        function TableProperties() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("TableProperties", true, null);
        }
        function TableRowProperties() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("TableRowProperties", true, null);
        }
        function TableColumnProperties() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("tableColumnproperties", true, null);
        }
        function TableCellProperties() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("TableCellProperties", true, null);
        }

        // 单元格
        function MegeCell() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_MergeCell", false, null);
        }
        function SplitCell() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_SplitCellExt", true, '2,3');
        }
        //单元格网格线
        function SetTableCellGridLineInfo() {
            var ctl = GetCurrentWriterControl();
            ctl.cellGridlineDialog(null, ctl);
        }
        //单元格斜分线
        function SetTableCellSlantSplitlineStyle() {
            var ctl = GetCurrentWriterControl();
            ctl.cellDiagonalLineDialog(null, ctl);
        }
        //背景编号
        function ShowBackgroundCellID() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("ShowBackgroundCellID", false, null);
        }
        //单元格边框
        function SetTableBorder() {
            var ctl = GetCurrentWriterControl();
            ctl.bordersShadingDialog();
        }
        function SetTableCellBorder() {
            var ctl = GetCurrentWriterControl();
            ctl.borderShadingcellDialog();
        }



        // 对齐方式
        function CellAlign(value) {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand(value, false, null);
        }

        //插入
        function InsertXml() {
            var myWriterControl = GetCurrentWriterControl();
            let str = SUBXML.InsertXmlStr;
            myWriterControl.DCExecuteCommand('InsertXML', false, str);
        }
        //确认弹框
        function errorDialog(isDelete, title, callback = null) {
            let confirmBox = `
            <div id="confirmContent" class="confirmContent">
                    <div class="confirmContentHeader">
                        <p style="color:#0E2D5F;">${isDelete ? '确认' : '警告'}</p>  
                        <img id="confirmContentClose" class="confirmContentClose" src="./img/xiangzuoshuangxian.png" alt="">
                    </div>
                    <div class="confirmContainer">${title}</div>
                    <div class="confirmButtons">
                        <p id="confirmYes" class="confirmYes">确认</p>
                        ${isDelete ? '<p id="confirmNo" class="confirmNo">取消</p>' : ''}
                    </div>
                </div>    
            <div id="confirmContentMask" style="position:fixed;width:100%;height:100%;left:0;top:0;background:#ccc;opacity:0.5;"></div>
        `;
            jQuery('#box').append(confirmBox)
            jQuery('#confirmContentClose').click(function () {
                removeNodeConfirmContent()
            })
            jQuery('#confirmYes').click(function () {
                if (isDelete) {
                    callback && callback()
                }
                removeNodeConfirmContent()
            })
            if (isDelete) {
                jQuery('#confirmNo').click(function () {
                    removeNodeConfirmContent()
                })
            }

            function removeNodeConfirmContent() {
                jQuery('#confirmContentMask').remove()
                jQuery('#confirmContent').remove()
            }
        }


        //对标签页的操作
        $('#tt').tabs({
            onBeforeClose: function (title, index) {
                //获取到最后一个tab页
                var allControl = document.querySelectorAll('[id^=myWriterControl]');
                //判断是否只存在一个
                if (allControl != null && allControl.length == 1) {
                    errorDialog(false, '最后一个tab页，无法删除!')
                } else {
                    var target = this;
                    errorDialog(true, '你想要删除' + title, function () {
                        var ctl = GetCurrentWriterControl();
                        if (ctl != null) {
                            ctl.Dispose();
                        }
                        var opts = $(target).tabs('options');
                        var bc = opts.onBeforeClose;
                        opts.onBeforeClose = function () { };  // allowed to close now
                        $(target).tabs('close', index);
                        opts.onBeforeClose = bc;  // restore the event function
                    })
                }
                return false;
            }
        });

        $('#tt').tabs({
            onSelect: function (title, index) {
                var target = this;
                setTimeout(function () {
                    // getCourseList()
                    GetTracesList()
                    SetMouseWheelScaleChange()
                })
            }
        });

        //病程相关
        //获取一个随机字符串
        function randomString(length) {
            var str = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
            var result = '';
            for (var i = length; i > 0; --i)
                result += str[Math.floor(Math.random() * str.length)];
            return result;
        }

        function GetAllSubDocumentIDs() {
            let ctl = GetCurrentWriterControl();
            let result = ctl.GetAllSubDocuments();
            console.log(result)
        }


        function SubDocCrossPage(value) {
            let ctl = GetCurrentWriterControl();
            let id = ctl.CurrentSubDoc();
            let result = ctl.SubDocCrossPage(id, value);
            ctl.RefreshDocument();
            alert(result)
        }




        function LoadSubDocumentFromString() {
            let ctl = GetCurrentWriterControl();
            var xml2 = subXml1;
            var options = {
                FileContentXML: xml2,
                ID: '123',
                Usebase64: false,
                ShowMaskUI: true
            };
            let result = ctl.LoadSubDocumentFromString(options);
            alert(result)
        }
        var contentSaveSubDocumentToBase64String = "";
        var contentSaveSubDocumentToString = "";
        function SaveSubDocumentToString() {
            let ctl = document.getElementById("myWriterControl");
            let id = ctl.CurrentSubDoc();
            if (id != null && id != "") {
                var options = {
                    FileFormat: 'xml',
                    SubDocID: id,
                    Usebase64: false,
                    CommitUserTrace: true,
                    OutputFormatXML: false,
                    SaveHeaderFooter: true,
                    SaveOriginHeaderFooter: false,
                    LogUserEditTrack: false
                };
                contentSaveSubDocumentToString = ctl.SaveSubDocumentToString(options);
            }
        }

        function SaveSubDocumentToBase64String() {
            let ctl = document.getElementById("myWriterControl");
            let id = ctl.CurrentSubDoc();
            if (id != null && id != "") {

                contentSaveSubDocumentToBase64String = ctl.SaveSubDocumentToBase64String('xml', id);
                console.log(contentSaveSubDocumentToBase64String)
            }
        }

        function LoadBySaveSubDocumentToBase64String() {
            let ctl = GetCurrentWriterControl();
            ctl.LoadDocumentFromBase64String(contentSaveSubDocumentToBase64String, 'xml');
        }
        function LoadBySaveSubDocumentToString() {
            let ctl = GetCurrentWriterControl();
            ctl.LoadDocumentFromString(contentSaveSubDocumentToString, 'xml');
        }

        // //术前小结
        // var sub6 = SUBXML.sub6
        // //手术
        // var sub7 = SUBXML.sub7
        //术后首次
        // var sub8 = SUBXML.sub8
        //日常
        // var sub9 = SUBXML.sub9
        // var subXml3 = SUBXML.subXml3
        // var subXml2 = SUBXML.subXml2

        // var xmlForSubBinding = SUBXML.xmlForSubBinding

    </script>
    <script>
        // 计算性能指标
        (() => {
            const createConsole = (desc, val) => console.log(
                `%c${desc}`,
                'color:#fff;background:red;padding:2px 6px;border-radius:3px;',
                val);

            window.addEventListener('load', () => {
                if (performance && performance.timing) {
                    const timing = performance.timing;
                    let performanceTiming = {
                        indexPage: [{
                            title: "DNS 解析耗时",
                            useTime: timing.domainLookupEnd - timing.domainLookupStart
                        },
                        {
                            title: "TCP连接耗时",
                            useTime: timing.connectEnd - timing.connectStart
                        },
                        {
                            title: "网络请求耗时",
                            useTime: timing.responseStart - timing.requestStart
                        },
                        {
                            title: "数据传输耗时",
                            useTime: timing.responseEnd - timing.requestStart
                        },
                        {
                            title: "页面首次渲染时间",
                            useTime: timing.responseEnd - timing.navigationStart
                        },
                        {
                            title: "首次可交互时间",
                            useTime: timing.domInteractive - timing.navigationStart
                        },
                        {
                            title: "DOM解析耗时",
                            useTime: timing.domInteractive - timing.responseEnd
                        },
                        {
                            title: "DOM构建耗时",
                            useTime: timing.domComplete - timing.domInteractive
                        },
                        {
                            title: "HTML 加载完成,DOM Ready",
                            useTime: timing.domContentLoadedEventEnd - timing.navigationStart
                        },
                        {
                            title: "页面完全加载耗时",
                            useTime: timing.loadEventStart - timing.navigationStart
                        }]
                    }
                    try {
                        window.localStorage.setItem('indexPerformanceTiming', JSON.stringify(performanceTiming))
                    } catch (error) {

                    }

                    createConsole('DNS 解析耗时', timing.domainLookupEnd - timing.domainLookupStart);
                    createConsole('TCP连接耗时', timing.connectEnd - timing.connectStart);
                    createConsole('网络请求耗时', timing.responseStart - timing.requestStart);
                    createConsole('数据传输耗时', timing.responseEnd - timing.requestStart);
                    createConsole('页面首次渲染时间', timing.responseEnd - timing.navigationStart);
                    createConsole('首次可交互时间', timing.domInteractive - timing.navigationStart);
                    createConsole('DOM解析耗时', timing.domInteractive - timing.responseEnd);
                    createConsole('DOM构建耗时', timing.domComplete - timing.domInteractive);
                    createConsole('HTML 加载完成,DOM Ready', timing.domContentLoadedEventEnd - timing.navigationStart);
                    createConsole('页面完全加载耗时', timing.loadEventStart - timing.navigationStart);
                }
            });
        })();

    </script>
</body>

</html>