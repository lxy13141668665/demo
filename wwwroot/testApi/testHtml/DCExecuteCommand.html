<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <title></title>
    <base href="/" target="_blank">
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            padding: 0px;
            box-sizing: border-box;
            margin: 0;
        }

        .container {
            width: 100%;
            height: 100%;
        }

        .header-box {
            width: 48%;
            float: left;
            border-bottom: 1px solid #ccc;
            padding-left: 10px;
            box-sizing: border-box;
            font-weight: 900;
        }

        #main {
            width: 48%;
            height: 100%;
            float: right;
            padding: 10px;
            box-sizing: border-box;
        }

        .testButton {
            cursor: pointer;
            height: 24px;
            width: 80px;
            border-radius: 4px;
            color: #fff;
            line-height: 24px;
            text-align: center;
            background-color: #208c99;
            font-size: 14px;
            margin-left: 24px;
        }
    </style>


</head>

<body>
    <div class="container">
        <div class="header-box">
            第三个参数为null的命令测试
            <!--<button onclick="DownLoadFile('xml');">下载xml</button>-->
            <button onclick="FileOpen()">打开</button>
            <br />
            <input type="button" value="第三个参数为null的命令测试" onclick="ParameterfreeDCExecuteCommand();" /> 命令名称：
            <select id="slt">
                <option value="AboutControl">关于-AboutControl</option>
                <option value="AdministratorViewMode">管理员视图-AdministratorViewMode</option>
                <option value="AlignBottomCenter">单元格底端居中对齐-AlignBottomCenter</option>
                <option value="AlignBottomLeft">单元格底端左对齐-AlignBottomLeft</option>
                <option value="AlignBottomRight">单元格底端右对齐-AlignBottomRight</option>
                <option value="AlignCenter">段落居中对齐-AlignCenter</option>
                <option value="AlignDistribute">段落分散对齐-AlignDistribute</option>
                <option value="AlignJustify">段落两端对齐-AlignJustify</option>
                <option value="AlignLeft">段落左对齐-AlignLeft</option>
                <option value="AlignRight">段落右对齐-AlignRight</option>
                <option value="AlignMiddleCenter">单元格垂直水平居中-AlignMiddleCenter</option>
                <option value="AlignMiddleLeft">单元格垂直水平左对齐-AlignMiddleLeft</option>
                <option value="AlignMiddleRight">单元格垂直水平右对齐-AlignMiddleRight</option>
                <option value="AlignTopCenter">单元格顶端居中对齐-AlignTopCenter</option>
                <option value="AlignTopLeft">单元格顶端居左对齐-AlignTopLeft</option>
                <option value="AlignTopRight">单元格顶端居右对齐-AlignTopRight</option>
                <option value="Backspace">退格删除-Backspace</option>
                <option value="Bold">粗体-Bold</option>
                <option value="BulletedList">圆点列表-BulletedList</option>
                <option value="CharacterCircle">字符套圈-CharacterCircle</option>
                <option value="CleanViewMode">整洁视图模式-CleanViewMode</option>
                <option value="ClearAllFieldValue">清空文档中所有输入域内容-ClearAllFieldValue</option>
                <option value="ClearBodyContent">清空文档正文内容-ClearBodyContent</option>
                <option value="ClearCurrentFieldValue">清空当前输入域内容-ClearCurrentFieldValue</option>
                <option value="ClearFormat">清除选择内容的样式-ClearFormat</option>
                <option value="ClearInputFieldValue">清空所有输入域中的内容-ClearInputFieldValue</option>
                <option value="ClearJumpPrintMode">退出续打模式-ClearJumpPrintMode</option>
                <option value="ClearUndo">清除撤销操作信息列表-ClearUndo</option>
                <option value="ClearValueValidateResult">清空校验结果-ClearValueValidateResult</option>
                <option value="ComplexViewMode">留痕视图模式-ComplexViewMode</option>
                <option value="ConvertContentToField">选中内容转换成输入域-ConvertContentToField</option>
                <option value="ConvertFieldToContent">将输入域转成文本内容-ConvertFieldToContent</option>
                <option value="ConvertTextContentToElementLabel">选中内容转换成标签文本元素-ConvertTextContentToElementLabel</option>
                <option value="Copy">复制-Copy</option>
                <option value="CopyAsText">纯文本复制-CopyAsText</option>
                <option value="CopyWithClearFieldValue">带清空输入域内容的复制-CopyWithClearFieldValue</option>
                <option value="CtlMoveDown">向下滚动一行不改变插入点位置-CtlMoveDown</option>
                <option value="CtlMoveUp">向上滚动一行不改变插入点位置-CtlMoveUp</option>
                <option value="Cut">剪切-Cut</option>
                <option value="date">插入当前日期-date</option>
                <option value="Delete">删除-Delete</option>
                <option value="DeleteAbsolute">物理删除，可以删除逻辑删除的内容-DeleteAbsolute</option>
                <option value="DeleteAllComment">删除所有批注-DeleteAllComment</option>
                <option value="DeleteComment">删除批注-DeleteComment</option>
                <option value="DeleteField">删除文本域-DeleteField</option>
                <option value="DeleteLine">删除一行文本-DeleteLine</option>
                <option value="DeleteRedundant">删除文档中后面的空白内容-DeleteRedundant</option>
                <option value="DeleteSection">删除文档节-DeleteSection</option>
                <option value="DesignMode">设计模式-DesignMode</option>
                <option value="DisplayWhole">显示所有隐藏的元素-DisplayWhole</option>
                <option value="DocumentValueValidate">对文档中的数据进行校验-DocumentValueValidate</option>
                <option value="DocumentValueValidateWithCreateDocumentComments">
                    对文档中的数据进行批注式校验-DocumentValueValidateWithCreateDocumentComments</option>
                <option value="EditComment">编辑批注-EditComment</option>
                <option value="ElementProperties">修改元素属性-ElementProperties</option>
                <option value="EmphasisMark">着重号-EmphasisMark</option>
                <option value="FileNew">新建-FileNew</option>
                <option value="FileOpen">打开本地文件-FileOpen</option>
                <option value="FirstLineIndent">首行缩进-FirstLineIndent</option>
                <option value="FormatBrush">格式刷-FormatBrush</option>
                <option value="fontborder">字符边框-fontborder</option>
                <option value="Header1">设置标准的标题1样式-Header1</option>
                <option value="Header1WithMultiNumberlist">设置标题的数字列表样式1-Header1WithMultiNumberlist</option>
                <option value="HeaderBottomLineVisible">设置是否显示页眉下边缘横线-HeaderBottomLineVisible</option>
                <option value="HiddenFormButton">隐藏表单按钮-HiddenFormButton</option>
                <option value="HideElementMarkAutoHide">隐藏被标记为自动隐藏的元素-HideElementMarkAutoHide</option>
                <option value="Indent">四代首行缩进-Indent</option>
                <option value="Insertorderedlist">四代有序列表-Insertorderedlist</option>
                <option value="Insertunorderedlist">四代无序列表-Insertunorderedlist</option>
                <option value="IncreaseFirstLineIndent">特别的首行缩进-IncreaseFirstLineIndent</option>
                <option value="InsertButton">插入按钮-InsertButton</option>
                <option value="InsertCheckBox">插入复选框-InsertCheckBox</option>
                <option value="InsertCheckBoxes">插入多个单选框复选框-InsertCheckBoxes</option>
                <option value="InsertComment">插入批注-InsertComment</option>
                <option value="InsertHorizontalLine">插入水平线-InsertHorizontalLine</option>
                <option value="InsertImage">插入图片-InsertImage</option>
                <option value="InsertInputField">插入文本域元素-InsertInputField</option>
                <option value="InsertLabel">插入文本标签元素-InsertLabel</option>
                <option value="InsertLineBreak">插入软回车-InsertLineBreak</option>
                <option value="InsertNewBarcode">插入条码元素-InsertNewBarcode</option>
                <option value="InsertNewMedicalExpression">插入医学表达式元素-InsertNewMedicalExpression</option>
                <option value="InsertPageBreak">插入分页符-InsertPageBreak</option>
                <option value="InsertPageInfo">插入页码元素-InsertPageInfo</option>
                <option value="InsertParagrahFlag">插入段落符号-InsertParagrahFlag</option>
                <option value="InsertRadioBox">插入单选框-InsertRadioBox</option>
                <option value="InsertTDBarcode">插入二维码元素-InsertTDBarcode</option>
                <option value="InsertWhiteSpaceForAlignRight">插入空格使后面的内容右对齐-InsertWhiteSpaceForAlignRight</option>
                <option value="Italic">斜体-Italic</option>
                <option value="MoveDown">向下移动一行-MoveDown</option>
                <option value="MoveUp">向上移动一行-MoveUp</option>
                <option value="MoveEnd">移动到行尾-MoveEnd</option>
                <option value="MoveHome">移动到行首-MoveHome</option>
                <option value="MoveLeft">向左移动一列-MoveLeft</option>
                <option value="MoveRight">向右移动一列-MoveRight</option>
                <option value="MovePageDown">向下翻页-MovePageDown</option>
                <option value="MovePageUp">向上翻页-MovePageUp</option>
                <option value="NumberedList">数字列表-NumberedList</option>
                <option value="ParagraphFormat">段落格式-ParagraphFormat</option>
                <option value="Paste">粘贴-Paste</option>
                <option value="PasteAsText">纯文本粘贴-PasteAsText</option>
                <option value="ReadViewMode">阅读视图模式-ReadViewMode</option>
                <option value="Redo">重做-Redo</option>
                <option value="RefreshDocument">刷新-RefreshDocument</option>
                <option value="Replace">替换-Replace</option>
                <option value="ResetFormValue">重置表单数据-ResetFormValue</option>
                <option value="RuleVisible">显示标尺-RuleVisible</option>
                <option value="Search">搜索-Search</option>
                <option value="SearchReplace">搜索和替换-SearchReplace</option>
                <option value="SelectAll">全选-SelectAll</option>
                <option value="SelectLine">选中当前光标所在行-SelectLine</option>
                <option value="ShiftMoveDown">带选择的向下移动一行-ShiftMoveDown</option>
                <option value="ShiftMoveUp">带选择的向上移动一行-ShiftMoveUp</option>
                <option value="ShiftMoveEnd">带选择的移动到行尾-ShiftMoveEnd</option>
                <option value="ShiftMoveHome">带选择的移动到行首-ShiftMoveHome</option>
                <option value="ShiftMoveLeft">带选择的向左移动-ShiftMoveLeft</option>
                <option value="ShiftMoveRight">带选择的向右移动-ShiftMoveRight</option>
                <option value="ShiftMovePageDown">带选择的向下移动一页-ShiftMovePageDown</option>
                <option value="ShiftMovePageUp">带选择的向上移动一页-ShiftMovePageUp</option>
                <option value="ShowBackgroundCellID">显示单元格背景编号-ShowBackgroundCellID</option>
                <option value="ShowElementMarkAutoHide">显示被标记为自动隐藏的元素-ShowElementMarkAutoHide</option>
                <option value="ShowFormButton">显示表单按钮-ShowFormButton</option>
                <option value="SimplifiedSwapTraditional">简体和繁体相互互换-SimplifiedSwapTraditional</option>
                <option value="SimplifiedToTraditional">简体转换为繁体-SimplifiedToTraditional</option>
                <option value="TraditionalToSimplified">繁体转换为简体-TraditionalToSimplified</option>
                <option value="SpecifyPageIndex">设置是否显示页眉下边缘横线-SpecifyPageIndex</option>
                <option value="Strikeout">删除线-Strikeout</option>
                <option value="Subscript">下标-Subscript</option>
                <option value="Superscript">上标-Superscript</option>
                <option value="Table_DeleteColumn">删除表格列-Table_DeleteColumn</option>
                <option value="Table_DeleteRow">删除表格行-Table_DeleteRow</option>
                <option value="Table_DeleteTable">删除表格-Table_DeleteTable</option>
                <option value="Table_HeaderRow">设置标题行-Table_HeaderRow</option>
                <option value="Table_IncreaseRowHeightToPageBottom">
                    修改表格行的高度，使其扩展到页面底端-Table_IncreaseRowHeightToPageBottom</option>
                <option value="Table_InsertColumnLeft">往左插入表格列-Table_InsertColumnLeft</option>
                <option value="Table_InsertColumnRight">往右插入表格列-Table_InsertColumnRight</option>
                <option value="Table_InsertRowDown">向下插入表格行-Table_InsertRowDown</option>
                <option value="Table_InsertRowUp">向上插入表格行-Table_InsertRowUp</option>
                <option value="Table_InsertRowsToPageBottom">在一个表格后面插入新表格行，使得表格延伸到当前页面的最下面-Table_InsertRowsToPageBottom
                </option>
                <option value="InsertTable">插入表格-InsertTable</option>
                <option value="Table_MergeCell">合并单元格-Table_MergeCell</option>
                <option value="Table_SplitCellExt">拆分单元格-Table_SplitCellExt</option>
                <option value="Table_RemoveEmptyRowsInLastPage">删除最后一页中的空白行-Table_RemoveEmptyRowsInLastPage</option>
                <option value="time">插入当前时间-time</option>
                <option value="ToupperCase">小写字母转成大写-ToupperCase</option>
                <option value="TolowerCase">大写字母转成小写-TolowerCase</option>
                <option value="Underline">下划线-Underline</option>
                <option value="Undo">撤销-Undo</option>
                <option value="WordCount">字数统计-WordCount</option>
                <option value="ZoomAuto">自动缩放-ZoomAuto</option>
                <option value="ZoomIn">放大视图-ZoomIn</option>
                <option value="ZoomOut">缩小视图-ZoomOut</option>
                <option value="ZoomReset">原始视图-ZoomReset</option>
            </select>
            <br />
            <br />
            <br />
            <!--<input type="button" value="第三个需要参数使用的命令" onclick="ArgumentDCExecuteCommand();" />--> 命令名称：
            第三个需要参数的命令测试:
            <br />
            背景色：<input type="color" style="height:30px;" id="BackColor" oninput="BackColor()" />
            <br />
            前景色：<input type="color" style="height:30px;" id="Color" oninput="Color()" />
            <br />
            内容保护：<input type="button" value="内容保护" onclick="ContentProtect();" />
            <select id="ContentProtect">
                <option value="None">无设置，不保护，管理员模式下启动该功能-None</option>
                <option value="Content">保护内容，但可以在中间插入内容，管理员模式下启动该功能-Content</option>
                <option value="Range">保护区域，这个区域中间不可插入内容，管理员模式下启动该功能-Range</option>
            </select>
            <br />
            边框和底纹：<input type="button" value="边框和底纹" onclick="BorderBackgroundFormat();" />
            <br />
            设置文档的默认字体：<input type="button" value="设置文档的默认字体" onclick="DocumentDefaultFont();" />
            <br />
            字体样式设置：<input type="button" value="字体样式设置" onclick="Font();" />
            <select id="Font">
                <option value="宋体">设置宋体</option>
                <option value="楷体">设置楷体</option>
                <option value="黑体">设置黑体</option>
            </select>
            <br />
            字体设置：<input type="button" value="字体设置" onclick="FontName();" />
            <select id="FontName">
                <option value="宋体">宋体</option>
                <option value="楷体">楷体</option>
                <option value="黑体">黑体</option>
                <option value="微软雅黑">微软雅黑</option>
                <option value="微软正黑体">微软正黑体</option>
                <option value="新宋体">新宋体</option>
                <option value="仿宋">仿宋</option>
                <option value="幼圆">幼圆</option>
                <option value="隶书">隶书</option>
                <option value="华文细黑">华文细黑</option>
                <option value="华文楷体">华文楷体</option>
                <option value="华文宋体">华文宋体</option>
                <option value="华文中宋">华文中宋</option>
                <option value="华文彩云">华文彩云</option>
                <option value="华文琥珀">华文琥珀</option>
                <option value="华文彩云">华文彩云</option>
                <option value="方正舒体">方正舒体</option>
                <option value="方正姚体">方正姚体</option>
            </select>
            <br />
            字号设置：<input type="button" value="字号设置" onclick="FontSize();" />
            <select id="FontSize">
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="14">14</option>
                <option value="16">16</option>
                <option value="18">18</option>
                <option value="20">20</option>
                <option value="22">22</option>
                <option value="24">24</option>
                <option value="26">26</option>
                <option value="28">28</option>
                <option value="36">36</option>
                <option value="48">48</option>
                <option value="72">72</option>
            </select>
            <br />
            表单模式：<input type="button" value="表单模式" onclick="FormViewMode();" />
            <select id="FormViewMode">
                <option value="Disable">退出表单模式</option>
                <option value="Normal">普通表单模式</option>
                <option value="Strict">严格表单模式</option>
            </select>
            <br />
            当前光标处插入文本内容：<input type="button" value="插入文本内容" onclick="InsertString();" />
            <br />
            当前光标处插入xml片段内容：<input type="button" value="插入xml片段" onclick="InsertXML();" />
            <br />
            MoveTo-移动焦点到指定位置：<input type="button" value="移动焦点到指定位置" onclick="MoveTo();" />
            <select id="MoveTo">
                <option value="None">不进行任何操作-None</option>
                <option value="DocumentHome">文档的开头-DocumentHome</option>
                <option value="CellHome">当前插入点所在表格单元格的开头-CellHome</option>
                <option value="ParagraphHome">当前插入点所在的段落的开头-ParagraphHome</option>
                <option value="PreLine">上一行-PreLine</option>
                <option value="Home">行首-Home</option>
                <option value="End">行尾-End</option>
                <option value="NextLine">下一行-NextLine</option>
                <option value="ParagraphEnd">当前段落的结尾-ParagraphEnd</option>
                <option value="CellEnd">当前单元格的结尾-CellEnd</option>
                <option value="DocumentEnd">文档的结尾-DocumentEnd</option>
                <option value="BeforeTable">在表格前面-BeforeTable</option>
                <option value="AfterTable">在表格后面-AfterTable</option>
                <option value="BeforeField">在文档域的前面-BeforeField</option>
                <option value="AfterField">在文档域的后面-AfterField</option>
                <option value="PreCell">前一个表格单元格-PreCell</option>
                <option value="AfterCell">在后一个表格单元格-AfterCell</option>
            </select>
            <br />
            MoveToPage：跳转到指定页<input type="button" value="跳转到指定页" onclick="MoveToPage();" /><input type="text"
                id="MoveToPage" />
            <br />
            打印用背景色：<input type="color" style="height:30px;" id="PrintBackColor" oninput="PrintBackColor()" />
            <br />
            打印用颜色：<input type="color" style="height:30px;" id="PrintColor" oninput="PrintColor()" />
            <br />
            插入特殊字符-insertspecifycharacter：<input type="button" value="插入特殊字符" onclick="insertspecifycharacter();" />
            <select id="insertspecifycharacter">
                <option value="$">$</option>
                <option value="￥">￥</option>
                <option value=">">></option>
                <option value="<">
                    << /option>
                <option value="#">#</option>
                <option value="√">√</option>
                <option value="♂">♂</option>
                <option value="☆">☆</option>
            </select>
            <br />
            插入特殊字符-Spechars：<input type="button" value="插入特殊字符" onclick="Spechars();" />
            <select id="Spechars">
                <option value="html字符">带有html换行标签</option>
                <option value="文本内容">￥</option>
            </select>
            <br />
            四代设置行间距-lineheight：<input type="button" value="设置行间距" onclick="lineheight();" />
            <select id="lineheight">
                <option value="1">1倍</option>
                <option value="1.5">1.5倍</option>
                <option value="2">2倍</option>
                <option value="3">3倍</option>
                <option value="100px">100px</option>
                <option value="300px">300px</option>
                <option value="600px">600px</option>
                <option value="800px">800px</option>
            </select>
            <br />
            四代设置悬挂缩进：<input type="button" value="悬挂缩进" onclick="hangingIndent();" />
            首行左缩进量：<input type="text" id="firstlineindent" />
            左缩进量：<input type="text" id="leftindent" />
            <br />
            段前距-段后距-rowspacing：<input type="button" value="段前距-段后距" onclick="rowspacing();" />
            <select id="rowspacing">
                <option value="top">段前距-top</option>
                <option value="bottom">段后距-bottom</option>
            </select>
            距离量：<input type="text" id="distance" />
            <br />
            第四代设置输入域下划线--InputFieldUnderLine：<input type="button" value="设置输入域下划线" onclick="InputFieldUnderLine();" />
            <select id="InputFieldUnderLine">
                <option value="true">设置-true</option>
                <option value="false">取消-false</option>
            </select>
            <br />
            <br />
            需要命令搭配的测试：
            <br />
            <input type="button" value="管理员模式" onclick="AdministratorViewMode();" />
            <input type="button" value="张三住院医生登录" onclick="UserLogin();" />
            <br />
            <input type="button" value="需要搭配使用的命令" onclick="CooperateDCExecuteCommand();" /> 命令名称：
            <select id="sst">
                <option value="CommitUserTrace">提交所有用户的痕迹，管理员模式下启动该功能-CommitUserTrace</option>
                <option value="ClearUserTrace">清除用户留下的痕迹，管理员模式下启动该功能-ClearUserTrace</option>
                <option value="ClearAllUserTrace">清空文档中所有的用户痕迹，管理员模式下启动该功能-ClearAllUserTrace</option>
                <option value="AttachCurrentUserTrackToBodyContent">
                    向文档正文添加当前用户痕迹，需要先执行登录接口-AttachCurrentUserTrackToBodyContent</option>
            </select>
            <br />
        </div>
        <div id="main">
            <div id="myWriterControl" dctype="WriterControlForWASM"
                style="height: 100%; background-color: rgb(230, 230, 230); border-bottom: 0px solid black; background-attachment: fixed; background-size: cover; background-position: center top; "
                RuleVisible="true" RuleBackColor="rgb(230, 230, 230)"
                ServicePageUrl="http://www.dcwriter.cn:8099/ServicePage.aspx"
                PageCssString222="box-shadow:3px 3px 3px grey"
                DocumentOptions.BehaviorOptions.OutputFormatedXMLSource="false"
                DocumentOptions.BehaviorOptions.ParagraphFlagFollowTableOrSection="true"
                DocumentOptions.ViewOptions.ShowInputFieldStateTag="true"
                DocumentOptions.ViewOptions.IgnoreFieldBorderWhenPrint="false"
                DocumentOptions.ViewOptions.PrintBackgroundText="false"
                DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint="true"
                DocumentOptions.ViewOptions.FieldBorderPrintVisibility="hidden"
                DocumentOptions.ViewOptions.FieldInvalidateValueForeColor="Blue"
                DocumentOptions.ViewOptions.TagColorForNormalField="Green"
                DocumentOptions.ViewOptions.TagColorForValueInvalidateField="Blue"
                DocumentOptions.ViewOptions.UnEditableFieldBorderColor="Yellow"
                DocumentOptions.SecurityOptions.EnablePermission="true"
                DocumentOptions.SecurityOptions.EnableLogicDelete="true"
                DocumentOptions.SecurityOptions.ShowLogicDeletedContent="true"
                DocumentOptions.SecurityOptions.ShowPermissionTip="true"
                DocumentOptions.SecurityOptions.ShowPermissionMark="true">
                正在加载...</div>
        </div>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="../../js/jquery-1.7.2.min.js"></script>
    <script src="../../DemoApp.js"></script>
    <script language="javascript">
        function ParameterfreeDCExecuteCommand() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("slt");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            //console.log(value);
            var result = ctl.DCExecuteCommand("" + value + "", true, null);
            alert("调用命令为\"" + value + "\"" + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为\"" + value + "\"" + "：" + "  " + "返回结果：" + result)
        }
        function Refresh() {
            let ctl = document.getElementById("myWriterControl");
            ctl.RefreshDocument();
        }

    </script>
    <!--带参数的示例-->
    <script>
        //function FileOpen() {
        //    var ctl = document.getElementById("myWriterControl");
        //    ctl.DCExecuteCommand("FileOpen", true, options);
        //}
        function FileOpen() {
            let file = document.createElement('input');
            file.setAttribute('id', 'dcInputFile');
            file.setAttribute('type', 'file');
            file.setAttribute('accept', '.xml,.json,.rtf,.html,.htm');
            file.style.display = 'none';
            myWriterControl.appendChild(file);
            file.click();
            //file文件选中事件
            file.onchange = function () {
                let fileList = this.files;
                if (fileList.length > 0) {
                    console.log(fileList[0]);
                    let reader = new FileReader();
                    reader.readAsText(fileList[0], "UFT-8");
                    reader.onload = function (e) {
                        //获取到文件内容
                        let strFileContent = e.target.result;
                        //获取文件格式
                        let fileFormat = "xml";
                        var fileName = '新建文档';
                        fileFormat = fileList[0].name.substring(fileList[0].name.lastIndexOf(".") + 1)
                        fileName = fileList[0].name.substring(0, fileList[0].name.lastIndexOf("."));
                        let ctl = document.getElementById("myWriterControl");
                        //window.CreateWriterControlForWASM(newCtl);
                        ctl.LoadDocumentFromString(strFileContent, fileFormat);
                    }
                }
            }
        }
        function BackColor() {
            let value = jQuery('#BackColor').val()
            if (value == null || value == "") {
                return;
            }
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.DCExecuteCommand('BackColor', false, value);
            alert("调用命令为 BackColor" + "：" + " 颜色值为： " + value + "返回结果：" + result)
        }
        function PrintBackColor() {
            let value = jQuery('#PrintBackColor').val()
            if (value == null || value == "") {
                return;
            }
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.DCExecuteCommand('PrintBackColor', false, value);
            alert("调用命令为 PrintBackColor" + "：" + " 颜色值为： " + value + "返回结果：" + result)
        }
        function PrintColor() {
            let value = jQuery('#PrintColor').val()
            if (value == null || value == "") {
                return;
            }
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.DCExecuteCommand('PrintColor', false, value);
            alert("调用命令为 PrintColor" + "：" + " 颜色值为： " + value + "返回结果：" + result)
        }

        function Color() {
            let value = jQuery('#Color').val()
            if (value == null || value == "") {
                return;
            }
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.DCExecuteCommand('Color', false, value);
            alert("调用命令为 Color" + "：" + " 颜色值为： " + value + "返回结果：" + result)
        }
        function ContentProtect() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("ContentProtect");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            //console.log(value)
            var result = ctl.DCExecuteCommand("ContentProtect", false, value);
            alert("调用命令为\"" + value + "\"" + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为\"" + value + "\"" + "：" + "  " + "返回结果：" + result)
        }
        function DocumentDefaultFont() {
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.DCExecuteCommand("DocumentDefaultFont", false, "楷体,1");
            alert("调用命令为DocumentDefaultFont：" + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为\"" + value + "\"" + "：" + "  " + "返回结果：" + result)
        }
        function Font() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("Font");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            //console.log(value)
            var options = {
                fontFamily: "楷体"
            }
            var result = ctl.DCExecuteCommand("Font", false, options);
            alert("调用命令为 Font " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 Font" + "：" + "  " + "返回结果：" + result)
        }
        function FontName() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("FontName");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            var result = ctl.DCExecuteCommand("FontName", false, "" + value + "");
            alert("调用命令为 FontName " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 FontName" + "：" + "  " + "返回结果：" + result)
        }
        function FontSize() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("FontSize");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            var result = ctl.DCExecuteCommand("FontSize", false, "" + value + "");
            alert("调用命令为 FontSize " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 FontSize" + "：" + "  " + "返回结果：" + result)
        }
        function FormViewMode() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("FormViewMode");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            var result = ctl.DCExecuteCommand("FormViewMode", false, "" + value + "");
            alert("调用命令为 FormViewMode " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 FormViewMode" + "：" + "  " + "返回结果：" + result)
        }
        function InsertString() {
            let ctl = document.getElementById('myWriterControl');
            var result = "哈哈哈，我插入内容了";
            var result = ctl.DCExecuteCommand("InsertString", false, result);
            alert("调用命令为 InsertString " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 InsertString" + "：" + "  " + "返回结果：" + result)
        }
        function InsertXML() {
            var xmlstr = `<XTextDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" EditorVersionString="1.2023.4.28">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1848</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>1854</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>1849</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>1876</InnerID>
               <Text>哈哈哈，我是xml片段</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>1853</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>1850</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>1855</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <SerializeParameterValue>true</SerializeParameterValue>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>都昌:都昌旗舰版（100并发）</LicenseText>
      <CreationTime>1980-01-01T00:00:00</CreationTime>
      <LastModifiedTime>2023-07-27T18:56:59.2949606+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:1.2023.4.28</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>哈哈哈，我是xml片段</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.DCExecuteCommand("InsertXML", false, xmlstr);
            alert("调用命令为 InsertXML " + "：" + "  " + "返回结果：" + result)
        }
        function MoveTo() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("MoveTo");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            var result = ctl.DCExecuteCommand("MoveTo", false, value);
            alert("调用命令为 MoveTo " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 MoveTo" + "：" + "  " + "返回结果：" + result)
        }
        function MoveToPage() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("MoveToPage").value;
            alert(obj)
            var result = ctl.DCExecuteCommand("MoveToPage", false, obj);
            alert("调用命令为 MoveToPage " + "：" + "  " + "返回结果：" + result)
        }
        function insertspecifycharacter() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("insertspecifycharacter");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            var result = ctl.DCExecuteCommand("insertspecifycharacter", false, value);
            alert("调用命令为 insertspecifycharacter " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 insertspecifycharacter" + "：" + "  " + "返回结果：" + result)
        }
        function Spechars() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("Spechars");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            if (value == "html字符") {
                value = "哈哈哈<br/>啊啊啊啊";
            }
            var result = ctl.DCExecuteCommand("Spechars", false, value);
            alert("调用命令为 Spechars " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 Spechars" + "：" + "  " + "返回结果：" + result)
        }
        function lineheight() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("lineheight");

            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;
            var result = ctl.DCExecuteCommand("lineheight", false, value);
            alert("调用命令为 lineheight " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 lineheight" + "：" + "  " + "返回结果：" + result)
        }
        function hangingIndent() {
            let ctl = document.getElementById('myWriterControl');

            var firstlineindent = document.getElementById("firstlineindent").value;
            var leftindent = document.getElementById("leftindent").value;
            var options = {
                firstlineindent: firstlineindent,
                leftindent: leftindent
            }
            var result = ctl.DCExecuteCommand("hangingIndent", false, options);
            alert("调用命令为 hangingIndent " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 hangingIndent" + "：" + "  " + "返回结果：" + result)
        }
        function rowspacing() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("rowspacing");
            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;

            var distance = document.getElementById("distance").value;
            var result = ctl.DCExecuteCommand("rowspacing", false, "" + distance + "," + value + "");
            alert("调用命令为 rowspacing " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 rowspacing" + "：" + "  " + "返回结果：" + result)
        }
        function InputFieldUnderLine() {
            let ctl = document.getElementById('myWriterControl');

            var obj = document.getElementById("InputFieldUnderLine");
            var index = obj.selectedIndex;

            var value = obj[parseInt(index)].value;

            var result = ctl.DCExecuteCommand("InputFieldUnderLine", false, { SetUnderline: value });
            alert("调用命令为 InputFieldUnderLine " + "：" + "  " + "返回结果：" + result)
            console.log("调用命令为 InputFieldUnderLine" + "：" + "  " + "返回结果：" + result)
        }
    </script>

    <!--搭配使用命令示例-->
    <script>
        function UserLogin() {
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.UserLoginByUserLoginInfo(
                {
                    ID: "zhansgan",// 用户编号
                    Name: "张三", // 用户名
                    ClientName: '192.103.1.123', // 客户端电脑名称
                    PermissionLevel: 0, // 用户授权等级
                    Description: "俺是住院医生" // 其他说明
                }, true);
            alert("调用方法为 UserLoginByUserLoginInfo " + "：" + "  " + "返回结果：" + result)
        }
        function AdministratorViewMode() {
            let ctl = document.getElementById('myWriterControl');
            var result = ctl.DCExecuteCommand("AdministratorViewMode", true, null);
            alert("调用命令为 AdministratorViewMode " + "：" + "  " + "返回结果：" + result)
        }
        function DownLoadFile(format) {
            if (format == null || format == "") {
                format = "xml";
            }
            if (format == 'doc') {
                DownLoadFiledoc();
            }
            else {
                let ctl = GetCurrentWriterControl();
                ctl.DownLoadFile(format);
            }

            function CooperateDCExecuteCommand() {
                let ctl = document.getElementById('myWriterControl');

                var obj = document.getElementById("sst");

                var index = obj.selectedIndex;

                var value = obj[parseInt(index)].value;
                var result = ctl.DCExecuteCommand("" + value + "", true, null);
                alert("调用命令为\"" + value + "\"" + "：" + "  " + "返回结果：" + result)
                console.log("调用命令为\"" + value + "\"" + "：" + "  " + "返回结果：" + result)
            }
        }

    </script>
</body>

</html>