<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <title></title>
    <base href="/" target="_blank">
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            padding: 0px;
            box-sizing: border-box;
            margin: 0;
        }

        .container {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
        }

        .header-box {
            border-bottom: 1px solid #ccc;
            padding-left: 10px;
            box-sizing: border-box;
            font-weight: 900;
        }

        #main {
            padding: 10px;
            box-sizing: border-box;
            display: block;
            flex: 1;
            overflow: hidden;
        }

        .testButton {
            cursor: pointer;
            height: 24px;
            width: 80px;
            border-radius: 4px;
            color: #fff;
            line-height: 24px;
            text-align: center;
            background-color: #208c99;
            font-size: 14px;
            margin-left: 24px;
        }

        #dialogContainer .dcTool-close {
            line-height: 14px;
        }

        .container .header-box select,
        .container .header-box input {
            width: 100px;
            max-width: 500px;
        }

        .container .header-box input.checkbox {
            width: 14px;
            max-width: 500px;
        }
    </style>


</head>

<body>
    <div class="container">
        <div class="header-box">
            <button onclick="GetCurrentWriterControl().ShowAboutDialog()">关于</button>
            <button onclick="ClearContent()">清空</button>
            <button onclick="FileNew()">新建</button>
            <button onclick="FileOpen()">打开</button>
            <button onclick="Refresh()">刷新</button>
            <button onclick="DownLoadFile('xml');">下载xml</button>
            <br />
            <button onclick="ExecuteCommandInsertTable()">使用ExecuteCommand插入一个表格</button>
            <button onclick="InsertTable()">插入表格</button>
            <button onclick="DeleteTable()">删除表格</button>
            <button onclick="DeleteTableRow()">删除行</button>
            <button onclick="DeleteTableColumn()">删除列</button>

            <button onclick="InsertRowUp()">在上面插入行</button>
            <button onclick="InsertRowDown()">在下面插入行</button>
            <button onclick="InsertColumnLeft()">在左面插入列</button>
            <button onclick="InsertColumnRight()">在右面插入列</button>

            <button onclick="MegeCell()">合并单元格</button>
            <button onclick="SplitCell()">拆分单元格</button>

            <button onclick="ShowBackgroundCellID()">背景编号</button>
            <button onclick="SetTableCellGridLineInfo()">单元格网格线</button>
            <button onclick="SetTableCellSlantSplitlineStyle()">单元格斜分线</button>
            <button onclick="SetTableBorder()">表格边框</button>
            <button onclick="SetTableCellBorder()">单元格边框</button>
            <button onclick="AutoFixTableWidth()">自适应宽度</button>

            <button onclick="CellAlign('AlignTopLeft')">顶端左对齐</button>
            <button onclick="CellAlign('AlignTopRight')">顶端右对齐</button>
            <button onclick="CellAlign('AlignTopCenter')">顶端中间对齐</button>
            <button onclick="CellAlign('AlignMiddleLeft')">垂直居中水平左对齐</button>
            <button onclick="CellAlign('AlignMiddleRight')">垂直居中水平右对齐</button>
            <button onclick="CellAlign('AlignMiddleCenter')">垂直居中水平中间对齐</button>
            <button onclick="CellAlign('AlignBottomLeft')">底端左对齐</button>
            <button onclick="CellAlign('AlignBottomRight')">底端右对齐</button>
            <button onclick="CellAlign('AlignBottomCenter')">底端中间对齐</button>

            <button onclick="TableProperties()">表格属性</button>
            <button onclick="TableRowProperties()">表格行属性</button>
            <button onclick="TableCellProperties()">单元格属性</button>

            <button onclick="CurrentTable()">当前表格id</button>
            <button onclick="CurrentTableCell()">当前单元格id</button>
            <button onclick="CurrentTableRow()">当前单元行id</button>

            <button onclick="GetSelectTableAndCell()">获取当前选择的表格和单元格</button>
            <button onclick="GetTableAttribute()">获取表格的自定义属性</button>
            <button onclick="GetTableCellAttribute()">获取单元格的自定义属性</button>
            <button onclick="GetTableCellExpression()">获取单元格的数值表达式</button>
            <button onclick="SetTableCellExpression()">设置单元格的数值表达式</button>
            <button onclick="SetTableColumnVisible()">设置表格列隐藏</button>
            <button onclick="SetTableHeight()">批量设置表格行高度</button>

            <br />
            <div>
                行：<input type="number" id="row" value="3">
                列：<input type="number" id="column" value="3">
                <button onclick="InsertContentByTableCellD()">在表格table1内追加内容</button>
            </div>

            <div>
                <textarea name="" id="SetTableAttribute" cols="30" rows="10"></textarea>
                <button onclick="SetTableAttribute()">设置表格的自定义属性</button>
                <button onclick="SetTableCellAttribute()">设置单元格的自定义属性</button>
                <button onclick="SetTableRowAttribute()">设置表格行的自定义属性</button>
            </div>
            <div>
                表格id: <input type="text" id="tableID">
                第几行：<input type="text" id="rowIndex">
                第几列：<input type="text" id="colIndex">
                文本内容<input type="text" id="newText">
                <button onclick="SetTableCellText()">设置单元格文本值</button>


            </div>




        </div>
        <div id="main">
            <div id="myWriterControl" dctype="WriterControlForWASM"
                style="height: 100%; background-color: rgb(230, 230, 230); border-bottom: 0px solid black; background-attachment: fixed; background-size: cover; background-position: center top; "
                RuleVisible="true" RuleBackColor="rgb(230, 230, 230)"
                ServicePageUrl="http://www.dcwriter.cn:8099/ServicePage.aspx"
                PageCssString222="box-shadow:3px 3px 3px grey"
                DocumentOptions.BehaviorOptions.OutputFormatedXMLSource="false"
                DocumentOptions.BehaviorOptions.ParagraphFlagFollowTableOrSection="true"
                DocumentOptions.ViewOptions.ShowInputFieldStateTag="true"
                DocumentOptions.ViewOptions.IgnoreFieldBorderWhenPrint="false"
                DocumentOptions.ViewOptions.PrintBackgroundText="false"
                DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint="true"
                DocumentOptions.ViewOptions.FieldBorderPrintVisibility="hidden"
                DocumentOptions.ViewOptions.FieldInvalidateValueForeColor="Blue"
                DocumentOptions.ViewOptions.TagColorForNormalField="Green"
                DocumentOptions.ViewOptions.TagColorForValueInvalidateField="Blue"
                DocumentOptions.ViewOptions.UnEditableFieldBorderColor="Yellow"
                DocumentOptions.SecurityOptions.EnablePermission="true"
                DocumentOptions.SecurityOptions.EnableLogicDelete="true"
                DocumentOptions.SecurityOptions.ShowLogicDeletedContent="true"
                DocumentOptions.SecurityOptions.ShowPermissionTip="true"
                DocumentOptions.SecurityOptions.ShowPermissionMark="true">
                正在加载...</div>
        </div>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="../../js/jquery-1.7.2.min.js"></script>
    <script src="../../DemoApp.js"></script>
    <script language="javascript">
        function SetTableRowAttribute() {
            let jsonObj = null;
            let PageSettingsStr = document.getElementById('SetTableAttribute').value
            try {
                jsonObj = JSON.parse(PageSettingsStr)
            } catch (error) {
                alert('json校验失败，请检查')
            }
            var ctl = document.getElementById("myWriterControl");
            var row = ctl.CurrentTableRow();
            var result = ctl.SetTableRowAttribute(row, jsonObj);
            alert(result);

        }
        function SetTableHeight() {
            var ctl = document.getElementById("myWriterControl");
            var table = ctl.CurrentTable();
            let height = prompt('请输入表格高度', '')
            ctl.SetTableHeight(table, height)
        }
        function SetTableColumnVisible() {
            var ctl = document.getElementById("myWriterControl");
            var table = ctl.CurrentTable();
            var result = ctl.SetTableColumnVisible(table, 0, false);
        }

        function SetTableCellText() {
            var ctl = document.getElementById("myWriterControl");
            var tableID = document.getElementById("tableID").value;
            var rowIndex = document.getElementById("rowIndex").value;
            var colIndex = document.getElementById("colIndex").value;
            var newText = document.getElementById("newText").value;
            ctl.SetTableCellText(tableID, rowIndex, colIndex, newText);
            alert(result);
        }
        function SetTableCellExpression() {
            var ctl = document.getElementById("myWriterControl");
            var cell = ctl.CurrentTableCell();
            let str = prompt('请输入插入的内容', '');
            var result = ctl.SetTableCellExpression(cell, str, false);
            alert(result);
        }
        function SetTableAttribute() {
            let jsonObj = null;
            let PageSettingsStr = document.getElementById('SetTableAttribute').value
            try {
                jsonObj = JSON.parse(PageSettingsStr)
            } catch (error) {
                alert('json校验失败，请检查')
            }
            var ctl = document.getElementById("myWriterControl");
            var table = ctl.CurrentTable();
            var result = ctl.SetTableAttribute(table, jsonObj);
            alert(result);


        }

        function SetTableCellAttribute() {
            let jsonObj = null;
            let PageSettingsStr = document.getElementById('SetTableAttribute').value
            try {
                jsonObj = JSON.parse(PageSettingsStr)
            } catch (error) {
                alert('json校验失败，请检查')
            }
            var ctl = document.getElementById("myWriterControl");
            var table = ctl.CurrentTableCell();
            var result = ctl.SetTableCellAttribute(table, jsonObj);
            alert(result);

        }



        function InsertContentByTableCellD() {
            var ctl = document.getElementById("myWriterControl");
            let row = document.getElementById('row').value
            let column = document.getElementById('column').value
            let str = prompt('请输入插入的内容');
            let result = ctl.InsertContentByTableCellD(str, "", "table1", row - 1, column - 1, false);

            console.log(result);
        }
        function ExecuteCommandInsertTable() {
            var ctl = document.getElementById("myWriterControl");
            ctl.ExecuteCommand("Table_InsertTable", false, '1,2');
        }

        // 插入表格
        function InsertTable() {
            var myWriterControl = GetCurrentWriterControl();

            myWriterControl.DCExecuteCommand('InsertTable', true, null);

        }
        // 删除表格
        function DeleteTable() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableDeleteTable()
            // myWriterControl.DCExecuteCommand("Table_DeleteTable", false, null);
        }

        // 删除行
        function DeleteTableRow() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableDeleteRow();
        }
        //删除列
        function DeleteTableColumn() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableDeleteColumn();
        }
        // 插入行列
        function InsertRowUp() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableInsertRowUp();
        }
        function InsertRowDown() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableInsertRowDown();
        }

        function InsertColumnLeft() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableInsertColumnLeft();
        }
        function InsertColumnRight() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableInsertColumnRight();
        }
        // 单元格
        function MegeCell() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableMergeCell();
        }
        function SplitCell() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("Table_SplitCellExt", true, '2,3');
        }
        //背景编号
        function ShowBackgroundCellID() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.ShowBackgroundCellID();
        }
        //单元格网格线
        function SetTableCellGridLineInfo() {
            var ctl = GetCurrentWriterControl();
            ctl.cellGridlineDialog(null, ctl);
        }
        //单元格斜分线
        function SetTableCellSlantSplitlineStyle() {
            var ctl = GetCurrentWriterControl();
            ctl.cellDiagonalLineDialog(null, ctl);
        }
        //单元格边框
        function SetTableBorder() {
            var ctl = GetCurrentWriterControl();
            ctl.bordersShadingDialog();
        }
        function SetTableCellBorder() {
            var ctl = GetCurrentWriterControl();
            ctl.borderShadingcellDialog();
        }
        function AutoFixTableWidth() {
            var ctl = document.getElementById("myWriterControl");
            ctl.AutoFixTableWidth();
        }
        // 对齐方式
        function CellAlign(value) {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.TableCellAlign(value)
        }

        function TableProperties() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("TableProperties", true, null);
        }

        function TableRowProperties() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("TableRowProperties", true, null);
        }
        function TableCellProperties() {
            var myWriterControl = GetCurrentWriterControl();
            myWriterControl.DCExecuteCommand("TableCellProperties", true, null);
        }

        function CurrentTable() {
            var ctl = document.getElementById("myWriterControl");
            var table = ctl.CurrentTable();
            if (!table) {
                alert(false)
            } else {
                alert('当前表格id： ' + table._id)
            }

        }
        function CurrentTableCell() {
            var ctl = document.getElementById("myWriterControl");
            var table = ctl.CurrentTableCell();
            if (!table) {
                alert(false)
            } else {
                alert('当前单元格id： ' + table._id)
            }
        }
        function CurrentTableRow() {
            var ctl = document.getElementById("myWriterControl");
            var row = ctl.CurrentTableRow();
            if (!row) {
                alert(false)
            } else {
                alert('当前单元行id： ' + row._id)
            }
        }
        function GetSelectTableAndCell() {
            var ctl = document.getElementById("myWriterControl");
            var result = ctl.GetSelectTableAndCell();
            console.log('获取当前选择的表格和单元格:', result);
            alert('请打开控制台查看获取当前选择的表格和单元格')
        }
        function GetTableAttribute() {
            var ctl = document.getElementById("myWriterControl");
            var table = ctl.CurrentTable();
            var result = ctl.GetTableAttribute(table);
            console.log('获取表格的自定义属性:', result);
            alert('请打开控制台查看获取表格的自定义属性')
        }
        function GetTableCellAttribute() {
            var ctl = document.getElementById("myWriterControl");
            var cell = ctl.CurrentTableCell();
            var result = ctl.GetTableCellAttribute(cell);
            console.log('获取单元格的自定义属性:', result);
            alert('请打开控制台查看获取单元格的自定义属性')
        }
        function GetTableCellExpression() {
            var ctl = document.getElementById("myWriterControl");
            var cell = ctl.CurrentTableCell();
            console.log(cell)
            var result = ctl.GetTableCellExpression(cell);
            console.log('获取单元格的数值表达式:', result);
            alert('请打开控制台查看获取单元格的数值表达式')
        }
        function WriterControl_OnLoad(rootElement) {
        }


        function ClearContent() {
            var ctl = document.getElementById("myWriterControl");
            var result = ctl.ClearContent();
            console.log(result);
        }
        function FileNew() {
            var ctl = document.getElementById("myWriterControl");
            var result = ctl.DCExecuteCommand("FileNew", false, null);
            console.log(result);
        }
        function FileOpen() {
            var ctl = document.getElementById("myWriterControl");
            ctl.DCExecuteCommand("FileOpen", true, null);
        }
        /**获得当前的编辑器控件对象 */
        function GetCurrentWriterControl() {
            return document.getElementById("myWriterControl");
        }
        function Refresh() {
            let ctl = document.getElementById("myWriterControl");
            ctl.RefreshDocument();
        }
        function DownLoadFile(format) {
            if (format == null || format == "") {
                format = "xml";
            }
            if (format == 'doc') {
                DownLoadFiledoc();
            }
            else {
                let ctl = GetCurrentWriterControl();
                ctl.DownLoadFile(format);
            }

        }

    </script>
</body>

</html>