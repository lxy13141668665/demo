<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>DCSoft.WASM</title>
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link222 href="DCSoft.WASM.styles.css" rel="stylesheet"></link222>
    <style>
        html,
        body {
            height: 100%;
            overflow: hidden;
        }

        #ulContainer {
            float: left;
            width: 20%;
            height: calc(100% - 151px);
            padding-top: 30px;
            overflow-y: auto;
        }

        #myWriterControl {
            float: left;
            width: 78%;
        }
    </style>

</head>

<body>
    <div id="ulContainer">
        <button onclick="GetCurrentWriterControl().ShowAboutDialog()">关于</button>
        <button onclick="ClearContent()">清空</button>
        <button onclick="FileNew()">新建</button>
        <button onclick="FileOpen()">打开</button>
        <button onclick="Refresh()">刷新</button>
        <button onclick="DownLoadFile('xml');">下载xml</button>
    </div>
    <div id="myWriterControl" dctype="WriterControlForWASM"
        style="height: calc(100% - 151px); background-color: rgb(177, 202, 235); border-bottom: 1px solid black;background-image: url(Workspace-Background.png); background-attachment: fixed; background-size: cover; background-position: center top; "
        RuleVisible="true" AllowDrop="true" AllowDragContent="true" RuleBackColor="rgb(155, 187, 227)"
        ServicePageUrl="http://www.dcwriter.cn:8099/ServicePage.aspx" PageCssString222="box-shadow:1px 1px 1px grey"
        DocumentOptions.BehaviorOptions.OutputFormatedXMLSource="false"
        DocumentOptions.BehaviorOptions.ParagraphFlagFollowTableOrSection="true"
        DocumentOptions.ViewOptions.ShowInputFieldStateTag="true"
        DocumentOptions.ViewOptions.IgnoreFieldBorderWhenPrint="false"
        DocumentOptions.ViewOptions.PrintBackgroundText="false"
        DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint="true"
        DocumentOptions.ViewOptions.FieldBorderPrintVisibility="hidden"
        DocumentOptions.ViewOptions.FieldInvalidateValueForeColor="Blue"
        DocumentOptions.ViewOptions.TagColorForNormalField="Green"
        DocumentOptions.ViewOptions.TagColorForValueInvalidateField="Blue"
        DocumentOptions.ViewOptions.UnEditableFieldBorderColor="Yellow"
        DocumentOptions.SecurityOptions.EnablePermission="true" DocumentOptions.SecurityOptions.EnableLogicDelete="true"
        DocumentOptions.SecurityOptions.ShowLogicDeletedContent="true"
        DocumentOptions.SecurityOptions.ShowPermissionTip="true"
        DocumentOptions.SecurityOptions.ShowPermissionMark="true">
        正在加载...
    </div>
    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">🗙</a>
    </div>

    <script src="_framework/blazor.webassembly.js"></script>
    <script src="DemoApp.js"></script>
    <script src="js/jquery-1.7.2.min.js"></script>
    <script>
        function WriterControl_OnLoad(rootElement) {

            rootElement.EventShowContextMenu = Handle_EventShowContextMenu;// 这个函数定义在DemoApp.js中
            rootElement.EventUpdateToolarState = Handle_EventUpdateToolarState;// 这个函数定义在DemoApp.js中
            rootElement.EventCanInsertObject = function (eventSender, eventArgs) {
                eventArgs.Result = true;
            };


            rootElement.ondocumentmousedown = function (e) {
                console.log('鼠标按下：ondocumentmousedown==>', e)
            }
            rootElement.ondocumentmouseup = function (e) {
                console.log('鼠标抬起：ondocumentmouseup==>', e)
            }
            rootElement.ondocumentmousemove = function (e) {
                // console.log('鼠标移动：ondocumentmousemove==>', e)
            }
            rootElement.ondocumentkeydown = function (e) {
                console.log("键盘按下：ondocumentkeydown==>", e);
            }
            rootElement.ondocumentkeypress = function (e) {
                console.log("键盘按下：ondocumentkeypress==>", e);
            }
            rootElement.ondocumentkeyup = function (e) {
                console.log("键盘抬起：ondocumentkeyup==>", e);
            }
            rootElement.ondocumentclick = function (e) {
                console.log("点击事件,ondocumentclick");
            }
            rootElement.ondocumentdblclick = function (e) {
                console.log("双击事件,ondocumentdblclick");
            }
            rootElement.DocumentLoad = function (eventSender, args) {
                console.log("加载文档后事件DocumentLoad");
            };
            rootElement.DocumentContentChanged = function (e) {
                console.log("内容发生改变,WriterControl_DocumentContentChanged");
            }
            rootElement.SelectionChanged = function (eventSender, args) {
                console.log("选择内容发生改变,SelectionChanged==>", eventSender, args);
            }

            rootElement.EventBeforeCopy = function (e, copydata) {
                console.log(e + " 复制前事件EventBeforeCopy  " + copydata)
                //return false;//拦截复制
            }
            rootElement.EventBeforePaste = function (copydata) {
                console.log(" 粘贴前事件EventBeforePaste  " + copydata)
                //return false;//拦截粘贴
            }
            rootElement.EventBeforePrint = function (printDoc) {
                console.log(rootElement.id + " 打印前事件EventBeforePrint ");
            }
            rootElement.EventBeforePrintPreview = function (PrintPreviewDiv) {
                console.log(rootElement.id + "打印预览前事件EventBeforePrintPreview ");
            }
            rootElement.EventAfterPrintPreview = function (ele) {
                console.log("EventAfterPrintPreview打印预览后事件", ele)
            }
            rootElement.EventBeforeCut = function (e, data) {
                console.log("EventBeforeCut剪切事件", e, data);
            }
            function WriterControl_EventElementLostFocus(eventSender, args) {
                console.log("LostFocus");
                console.log(args);
            }
            function WriterControl_EventElementGotFocus(eventSender, args) {
                console.log("GotFocus");
                console.log(args);
            }
            rootElement.EventAfterInsertSubDocuments = function (arr) {
                console.log("添加病程回调函数EventAfterInsertSubDocuments:", arr);
            }
        }
        function WriterControl_EventElementMouseClick(rootElement, args) {
            console.log(rootElement.id + " 元素点击事件EventElementMouseClick " + args.ElementID)
        }
        function WriterControl_EventElementMouseDblClick(rootElement, args) {
            console.log(rootElement.id + " 元素双击事件EventElementMouseDblClick " + args.ElementID)
        }
        function WriterControl_EventContentChanged(rootElement, args) {
            console.log(rootElement.id + " 改变事件EventContentChanged " + args.Element)
        }
        function ClearContent() {
            var ctl = document.getElementById("myWriterControl");
            var result = ctl.ClearContent();
            console.log(result);
        }
        function FileNew() {
            var ctl = document.getElementById("myWriterControl");
            var result = ctl.DCExecuteCommand("FileNew", false, null);
            console.log(result);
        }
        function FileOpen() {
            var ctl = document.getElementById("myWriterControl");
            ctl.DCExecuteCommand("FileOpen", true, null);
        }
        /**获得当前的编辑器控件对象 */
        function GetCurrentWriterControl() {
            return document.getElementById("myWriterControl");
        }
        function Refresh() {
            let ctl = document.getElementById("myWriterControl");
            ctl.RefreshDocument();
        }
        function DownLoadFile(format) {
            if (format == null || format == "") {
                format = "xml";
            }
            if (format == 'doc') {
                DownLoadFiledoc();
            }
            else {
                let ctl = GetCurrentWriterControl();
                ctl.DownLoadFile(format);
            }

        }
    </script>
</body>

</html>