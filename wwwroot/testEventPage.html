<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>DCSoft.WASM</title>
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link222 href="DCSoft.WASM.styles.css" rel="stylesheet"></link222>
    <style>
        html,
        body {
            height: 100%;
            overflow: hidden;
        }

        #ulContainer {
            float: left;
            width: 20%;
            height: calc(100% - 151px);
            padding-top: 30px;
            overflow-y: auto;
        }

        #myWriterControl {
            float: left;
            width: 78%;
        }
    </style>

</head>

<body>
    <div id="ulContainer">
        <button onclick="GetCurrentWriterControl().ShowAboutDialog()">å…³äº</button>
        <button onclick="ClearContent()">æ¸…ç©º</button>
        <button onclick="FileNew()">æ–°å»º</button>
        <button onclick="FileOpen()">æ‰“å¼€</button>
        <button onclick="Refresh()">åˆ·æ–°</button>
        <button onclick="DownLoadFile('xml');">ä¸‹è½½xml</button>
    </div>
    <div id="myWriterControl" dctype="WriterControlForWASM"
        style="height: calc(100% - 151px); background-color: rgb(177, 202, 235); border-bottom: 1px solid black;background-image: url(Workspace-Background.png); background-attachment: fixed; background-size: cover; background-position: center top; "
        RuleVisible="true" AllowDrop="true" AllowDragContent="true" RuleBackColor="rgb(155, 187, 227)"
        ServicePageUrl="http://www.dcwriter.cn:8099/ServicePage.aspx" PageCssString222="box-shadow:1px 1px 1px grey"
        DocumentOptions.BehaviorOptions.OutputFormatedXMLSource="false"
        DocumentOptions.BehaviorOptions.ParagraphFlagFollowTableOrSection="true"
        DocumentOptions.ViewOptions.ShowInputFieldStateTag="true"
        DocumentOptions.ViewOptions.IgnoreFieldBorderWhenPrint="false"
        DocumentOptions.ViewOptions.PrintBackgroundText="false"
        DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint="true"
        DocumentOptions.ViewOptions.FieldBorderPrintVisibility="hidden"
        DocumentOptions.ViewOptions.FieldInvalidateValueForeColor="Blue"
        DocumentOptions.ViewOptions.TagColorForNormalField="Green"
        DocumentOptions.ViewOptions.TagColorForValueInvalidateField="Blue"
        DocumentOptions.ViewOptions.UnEditableFieldBorderColor="Yellow"
        DocumentOptions.SecurityOptions.EnablePermission="true" DocumentOptions.SecurityOptions.EnableLogicDelete="true"
        DocumentOptions.SecurityOptions.ShowLogicDeletedContent="true"
        DocumentOptions.SecurityOptions.ShowPermissionTip="true"
        DocumentOptions.SecurityOptions.ShowPermissionMark="true">
        æ­£åœ¨åŠ è½½...
    </div>
    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ğŸ—™</a>
    </div>

    <script src="_framework/blazor.webassembly.js"></script>
    <script src="DemoApp.js"></script>
    <script src="js/jquery-1.7.2.min.js"></script>
    <script>
        function WriterControl_OnLoad(rootElement) {

            rootElement.EventShowContextMenu = Handle_EventShowContextMenu;// è¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨DemoApp.jsä¸­
            rootElement.EventUpdateToolarState = Handle_EventUpdateToolarState;// è¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨DemoApp.jsä¸­
            rootElement.EventCanInsertObject = function (eventSender, eventArgs) {
                eventArgs.Result = true;
            };


            rootElement.ondocumentmousedown = function (e) {
                console.log('é¼ æ ‡æŒ‰ä¸‹ï¼šondocumentmousedown==>', e)
            }
            rootElement.ondocumentmouseup = function (e) {
                console.log('é¼ æ ‡æŠ¬èµ·ï¼šondocumentmouseup==>', e)
            }
            rootElement.ondocumentmousemove = function (e) {
                // console.log('é¼ æ ‡ç§»åŠ¨ï¼šondocumentmousemove==>', e)
            }
            rootElement.ondocumentkeydown = function (e) {
                console.log("é”®ç›˜æŒ‰ä¸‹ï¼šondocumentkeydown==>", e);
            }
            rootElement.ondocumentkeypress = function (e) {
                console.log("é”®ç›˜æŒ‰ä¸‹ï¼šondocumentkeypress==>", e);
            }
            rootElement.ondocumentkeyup = function (e) {
                console.log("é”®ç›˜æŠ¬èµ·ï¼šondocumentkeyup==>", e);
            }
            rootElement.ondocumentclick = function (e) {
                console.log("ç‚¹å‡»äº‹ä»¶,ondocumentclick");
            }
            rootElement.ondocumentdblclick = function (e) {
                console.log("åŒå‡»äº‹ä»¶,ondocumentdblclick");
            }
            rootElement.DocumentLoad = function (eventSender, args) {
                console.log("åŠ è½½æ–‡æ¡£åäº‹ä»¶DocumentLoad");
            };
            rootElement.DocumentContentChanged = function (e) {
                console.log("å†…å®¹å‘ç”Ÿæ”¹å˜,WriterControl_DocumentContentChanged");
            }
            rootElement.SelectionChanged = function (eventSender, args) {
                console.log("é€‰æ‹©å†…å®¹å‘ç”Ÿæ”¹å˜,SelectionChanged==>", eventSender, args);
            }

            rootElement.EventBeforeCopy = function (e, copydata) {
                console.log(e + " å¤åˆ¶å‰äº‹ä»¶EventBeforeCopy  " + copydata)
                //return false;//æ‹¦æˆªå¤åˆ¶
            }
            rootElement.EventBeforePaste = function (copydata) {
                console.log(" ç²˜è´´å‰äº‹ä»¶EventBeforePaste  " + copydata)
                //return false;//æ‹¦æˆªç²˜è´´
            }
            rootElement.EventBeforePrint = function (printDoc) {
                console.log(rootElement.id + " æ‰“å°å‰äº‹ä»¶EventBeforePrint ");
            }
            rootElement.EventBeforePrintPreview = function (PrintPreviewDiv) {
                console.log(rootElement.id + "æ‰“å°é¢„è§ˆå‰äº‹ä»¶EventBeforePrintPreview ");
            }
            rootElement.EventAfterPrintPreview = function (ele) {
                console.log("EventAfterPrintPreviewæ‰“å°é¢„è§ˆåäº‹ä»¶", ele)
            }
            rootElement.EventBeforeCut = function (e, data) {
                console.log("EventBeforeCutå‰ªåˆ‡äº‹ä»¶", e, data);
            }
            function WriterControl_EventElementLostFocus(eventSender, args) {
                console.log("LostFocus");
                console.log(args);
            }
            function WriterControl_EventElementGotFocus(eventSender, args) {
                console.log("GotFocus");
                console.log(args);
            }
            rootElement.EventAfterInsertSubDocuments = function (arr) {
                console.log("æ·»åŠ ç—…ç¨‹å›è°ƒå‡½æ•°EventAfterInsertSubDocuments:", arr);
            }
        }
        function WriterControl_EventElementMouseClick(rootElement, args) {
            console.log(rootElement.id + " å…ƒç´ ç‚¹å‡»äº‹ä»¶EventElementMouseClick " + args.ElementID)
        }
        function WriterControl_EventElementMouseDblClick(rootElement, args) {
            console.log(rootElement.id + " å…ƒç´ åŒå‡»äº‹ä»¶EventElementMouseDblClick " + args.ElementID)
        }
        function WriterControl_EventContentChanged(rootElement, args) {
            console.log(rootElement.id + " æ”¹å˜äº‹ä»¶EventContentChanged " + args.Element)
        }
        function ClearContent() {
            var ctl = document.getElementById("myWriterControl");
            var result = ctl.ClearContent();
            console.log(result);
        }
        function FileNew() {
            var ctl = document.getElementById("myWriterControl");
            var result = ctl.DCExecuteCommand("FileNew", false, null);
            console.log(result);
        }
        function FileOpen() {
            var ctl = document.getElementById("myWriterControl");
            ctl.DCExecuteCommand("FileOpen", true, null);
        }
        /**è·å¾—å½“å‰çš„ç¼–è¾‘å™¨æ§ä»¶å¯¹è±¡ */
        function GetCurrentWriterControl() {
            return document.getElementById("myWriterControl");
        }
        function Refresh() {
            let ctl = document.getElementById("myWriterControl");
            ctl.RefreshDocument();
        }
        function DownLoadFile(format) {
            if (format == null || format == "") {
                format = "xml";
            }
            if (format == 'doc') {
                DownLoadFiledoc();
            }
            else {
                let ctl = GetCurrentWriterControl();
                ctl.DownLoadFile(format);
            }

        }
    </script>
</body>

</html>