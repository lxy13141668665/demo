<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>DCSoft.WASM</title>
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link222 href="DCSoft.WASM.styles.css" rel="stylesheet"></link222>
   
    <style>
        html, body {
            height: 100%;
            overflow: hidden;
        }
        #tt {
            height: calc(100% - 161px);
            overflow: hidden;
            background-color: white;
        }
        .tabs-panels {
            height: calc(100% - 34px);
        }
        .tabs-panels>.panel-htop, .panel-body {
            height: 100%;
        }
        .tabs-title-change::after {
            content: '*';
            margin-left: 5px;
        }
        .colour {
            background-color: yellow;
        }
    </style>
   
</head>

<body style="text-align:center;">
    <div style="text-align:left;border-bottom:1px solid black">
        <button onclick="GetCurrentWriterControl().ShowAboutDialog()">关于</button>
        <button onclick="GetCurrentWriterControl().ClearContent()">新建</button>
        <button onclick="FileOpen()">打开</button>
        <button onclick="DownLoad('xml')">下载XML</button>
        <button onclick="Refresh()">刷新</button>
        <button onclick="AddSubUsingBinding(true)">插入病程</button>
        <button onclick="AddSubUsingBinding(false)">追加病程</button>
        <button onclick="CurrentSubDoc()">当前病程编号</button>
        <button onclick="DeleteSubDoc()">删除当前病程</button>
        <button onclick="DeleteCurrentSubDoc()">删除指定病程</button>
        <!--<button onclick="LoadSubDocumentFromString()">追加单个</button>
    <button onclick="SaveSubDocumentToBase64String()">单个base64</button>
    <button onclick="SaveSubDocumentToString()">单个保存</button>-->
        <button onclick="GetAllSubDocumentIDs()">病程编号</button>
        <button onclick="SelectSubDocumentByID()">根据编号定位病程</button>
        <button onclick="SelectSubDocument()">根据序号定位病程</button>
        <button onclick="SetCurrentSubDocumentReadOnly(true)">病程只读</button>
        <button onclick="SetCurrentSubDocumentReadOnly(false)">取消只读</button>
        <button onclick="SubDocCrossPage(true)">设置跨页</button>
        <button onclick="SubDocCrossPage(false)">取消跨页</button>
    </div>
    <div style="text-align:left;border-bottom:1px solid black">
        <button onclick="InsertTable3()">1.插入tabletest表格</button>
        <button onclick="AddSubAfterTableTest()">2.在tabletest表格后插入病程</button>
    </div>

    <div id="myWriterControl"
         dctype="WriterControlForWASM"
         style="height: 1168px; background-color: rgb(177, 202, 235); border-bottom: 1px solid black;background-image: url(Workspace-Background.png); background-attachment: fixed; background-size: cover; background-position: center top; "
         RuleVisible="true" AllowDrop="true" AllowDragContent="true"
         RuleBackColor="rgb(155, 187, 227)"
         ServicePageUrl="http://www.dcwriter.cn:6788/ServicePage.aspx"
         PageCssString222="box-shadow:1px 1px 1px grey"
         DocumentOptions.BehaviorOptions.OutputFormatedXMLSource="false"
         DocumentOptions.BehaviorOptions.ParagraphFlagFollowTableOrSection="true"
         DocumentOptions.ViewOptions.ShowInputFieldStateTag="true"
         DocumentOptions.ViewOptions.IgnoreFieldBorderWhenPrint="false"
         DocumentOptions.ViewOptions.PrintBackgroundText="false"
         DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint="true"
         DocumentOptions.ViewOptions.FieldBorderPrintVisibility="hidden"
         DocumentOptions.ViewOptions.FieldInvalidateValueForeColor="Blue"
         DocumentOptions.ViewOptions.TagColorForNormalField="Green"
         DocumentOptions.ViewOptions.TagColorForValueInvalidateField="Blue"
         DocumentOptions.ViewOptions.UnEditableFieldBorderColor="Yellow"
         DocumentOptions.SecurityOptions.EnablePermission="true"
         DocumentOptions.SecurityOptions.EnableLogicDelete="true"
         DocumentOptions.SecurityOptions.ShowLogicDeletedContent="true"
         DocumentOptions.SecurityOptions.ShowPermissionTip="true"
         DocumentOptions.SecurityOptions.ShowPermissionMark="true"
         OnLoad="this.LoadDocumentFromString(strDemoFileXml, 'xml');">正在加载...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">🗙</a>
    </div>
    <div style="text-align:left;background-color:lightblue;border-bottom:1px solid black">状态：<span id="lblStatus">...</span></div>   
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="DemoApp.js"></script>    
    <script src="js/jquery-1.7.2.min.js"></script>
    <script language="javascript">

        function SubDocCrossPage(value) {
            let ctl = document.getElementById("myWriterControl");
            let id = ctl.CurrentSubDoc();
            let result = ctl.SubDocCrossPage(id,value);
            alert(result)
        }
        function SelectSubDocumentByID() {
            let ctl = document.getElementById("myWriterControl");
            let result = ctl.SelectSubDocumentByID('subdoc1');
            alert(result)
        }
        function SelectSubDocument() {
            let ctl = document.getElementById("myWriterControl");
            let result = ctl.SelectSubDocument(1);
            alert(result)
        }

        function GetAllSubDocumentIDs() {
            let ctl = document.getElementById("myWriterControl");
            let result = ctl.GetAllSubDocuments();
            console.log(result)
        }

        function SaveSubDocumentToString() {
            let ctl = document.getElementById("myWriterControl");

            var options = {
                FileFormat: 'xml',
                SubDocID: 'subdoc2',
                Usebase64: false,
                CommitUserTrace: true,
                OutputFormatXML:false,
                SaveHeaderFooter:true
            };
            let result = ctl.SaveSubDocumentToString(options);
            console.log(result)
        }

        function SaveSubDocumentToBase64String(){
            let ctl = document.getElementById("myWriterControl");
            let result = ctl.SaveSubDocumentToBase64String('xml','subdoc2');
            console.log(result)
        }

        function LoadSubDocumentFromString() {
            let ctl = document.getElementById("myWriterControl");
            var xml2 = ``;


            var options = {
                FileContentXML: xml2,
                ID: '123',
                Usebase64: false,
                ShowMaskUI: true
            };
            let result = ctl.LoadSubDocumentFromString(options);
            alert(result)
        }
        function DeleteSubDoc()
        {            
            let ctl = document.getElementById("myWriterControl");
            let result = ctl.DeleteSubDoc('subdoc2');
            alert(result)
        }
        function DeleteCurrentSubDoc()
        {
            let ctl = document.getElementById("myWriterControl");
            let result = ctl.DeleteCurrentSubDoc();
            alert(result)
        }
        function CurrentSubDoc()
        {
            let ctl = document.getElementById("myWriterControl");
            let id = ctl.CurrentSubDoc();
            alert(id)
        }

        function GetAllSub()
        {
            let ctl = document.getElementById("myWriterControl");
            let arr = ctl.SubDocuments;
            console.log(arr)
        }

        function SetCurrentSubDocumentReadOnly (isReadOnly) {
            let ctl = document.getElementById("myWriterControl");
            ctl.SetCurrentSubDocumentReadOnly(isReadOnly, '#FFFFCD');
        };
        //rootElement.SetSubDocumentReadOnly = function (subID, isReadOnly) {
        //    return rootElement.__DCWriterReference.invokeMethod("SetSubDocumentReadOnly", subID, isReadOnly);
        //};
        //rootElement.GetCurrentSubDoumentContentXmlByID = function () {
        //    return rootElement.__DCWriterReference.invokeMethod("GetCurrentSubDoumentContentXmlByID");
        //};
        //rootElement.GetSubDoumentContentXmlByID = function (subID) {
        //    return rootElement.__DCWriterReference.invokeMethod("GetSubDoumentContentXmlByID", subID);
        //};



        function AppendSub() {
            var file = new Array();
            var xml1 = ``;
            file.push(xml1);
            var xml2 = ``;
            file.push(xml2);
            var options = new Array();
            var attr1 = {
                //"Attributes": { "姓名": "张三", "科室": "胸外科", "床号": "12345" }, //自定义属性
                "NewPage": false, //是否新起一页
                "ReadOnly": false, //是否可编辑
                "Title": "张三的病程记录", //病程收缩时显示的文档标题
                "ToolTip": "提示：张三的病程记录", //病程鼠标移上去时的提示文本
                "ID": "subdoc1",//
                "BackgroundColorValue": "#F0FFFF",
                "TitleLevel": 0,//导航级别，从0到7的整数
                //"CSSStyle": "border: 3px solid #FF0000; background-color: #FFFF00;", //自定义的样式
                "Parameters": { "emr.DE02.01.052.00": "汪汪汪", "fieldMedic": "王二麻子" },//绑定的数据格式
                //"DataBindingXML": "<DataSourceName><Name>张三</Name></DataSourceName><DataSourceName2><Name>李四</Name></DataSourceName2>",
                "EnablePermission": false
            };
            var attr2 = {
                //"Attributes": { "姓名": "李四", "科室": "太平间", "床号": "45678" }, //自定义属性
                "NewPage": false, //是否新起一页
                "ReadOnly": true, //是否可编辑
                "Title": "李四的病程记录", //文档标题
                "ToolTip": "提示：李四的病程记录", //文档标题
                "ID": "subdoc2",//
                "BackgroundColorValue":"#C0C0C0",
                "TitleLevel": 0,//导航级别，从0到7的整数
                //"CSSStyle": "border: 1px solid #0000FF; background-color: #FFF0F5;", //自定义的样式
                "Parameters": { "emr.DE02.01.052.00": "喵喵喵", "fieldMedic": "刘三姐" }, //绑定的数据格式
                //"DataBindingXML": "<DataSourceName><Name>李四</Name></DataSourceName>",
                "EnablePermission": false
            };
            options.push(attr1);
            options.push(attr2);
            var options = {
                Files: file,
                Parameters: options,
                Usebase64: false,
                ShowMaskUI: true
            };
            let ctl = document.getElementById("myWriterControl");
             ctl.AppendSubDocuments(options);
            
             ctl.RefreshDocument();
        }






        function AddSubUsingBinding(inserted, afterElement) {
            alert("演示批量插入四个子病程并直接绑定数据。请注意选框元素和输入域元素不同的绑定写法。");
            let ctl = document.getElementById("myWriterControl");
            var file = new Array();
            file.push(xmlForSubBinding);
            file.push(xmlForSubBinding);
            file.push(xmlForSubBinding);
            file.push(xmlForSubBinding);

            //构造两个选项分别对应两个子文档
            var options = new Array();
            var attr1 = {
                "ID": "subdoc1",//
                "Parameters": { "rdogroup": "V3", "chkgroup": "V2,V3" },//绑定的数据格式
                "DataBindingXML": "<DataSourceName><Name>王五</Name><Sex>男</Sex></DataSourceName>"
            };
            var attr2 = {
                "ID": "subdoc2",//
                "Parameters": { "rdogroup": "V1", "chkgroup": "V1,V4" }, //绑定的数据格式
                "DataBindingXML": "<DataSourceName><Name>刘六</Name><Sex>女</Sex></DataSourceName>"
            };
            var attr3 = {
                "ID": "subdoc3",//
                "Parameters": { "rdogroup_2": true, "chkgroup_1": true, "chkgroup_2": true } ,//绑定的数据格式
                "DataBindingXML": "<DataSourceName><Name>李四</Name><Sex>女</Sex></DataSourceName>"
            };
            var attr4 = {
                "ID": "subdoc4",//
                "Parameters": { "rdogroup_0": true, "chkgroup_0": true, "chkgroup_3": true }, //绑定的数据格式
                "DataBindingXML": "<DataSourceName><Name>张三</Name><Sex>男</Sex></DataSourceName>"
            };
            options.push(attr1);
            options.push(attr2);
            options.push(attr3);
            options.push(attr4);
            var options = {
                Files: file,
                Options: options,
                Usebase64: "false"
            };


            let result = null;
            if (inserted === true) {
                result = ctl.InsertSubDocuments(options, afterElement);
            } else {
                result = ctl.AppendSubDocuments(options);
            }
            
            if (result) {
                ctl.RefreshDocument();
            }
        }


        /**获得当前的编辑器控件对象 */
        function GetCurrentWriterControl() {
            return document.getElementById("myWriterControl");
        }
        function FileOpen() {
            let file = document.createElement('input');
            file.setAttribute('id', 'dcInputFile');
            file.setAttribute('type', 'file');
            file.setAttribute('accept', '.xml,.json,.rtf,.html,.htm');
            file.style.display = 'none';
            myWriterControl.appendChild(file);
            file.click();
            //file文件选中事件
            file.onchange = function () {
                let fileList = this.files;
                if (fileList.length > 0) {
                    console.log(fileList[0]);
                    let reader = new FileReader();
                    reader.readAsText(fileList[0], "UFT-8");
                    reader.onload = function (e) {
                        //获取到文件内容
                        let strFileContent = e.target.result;
                        //获取文件格式
                        let fileFormat = "xml";
                        var fileName = '新建文档';
                        fileFormat = fileList[0].name.substring(fileList[0].name.lastIndexOf(".") + 1)
                        fileName = fileList[0].name.substring(0, fileList[0].name.lastIndexOf("."));
                        let ctl = document.getElementById("myWriterControl");                        
                        //window.CreateWriterControlForWASM(newCtl);
                        ctl.LoadDocumentFromString(strFileContent, fileFormat);
                    }
                }
            }
        }
        function DownLoad(format) {
            if (format == null || format == "") {
                format = "xml";
            }
            let ctl = document.getElementById("myWriterControl");
            ctl.DownLoadFile(format);
        }
        function SaveXmlString() {
            let ctl = document.getElementById("myWriterControl");
            var result = ctl.SaveDocumentToString('xml');
            console.log(result);
        }
        function Refresh() {
            let ctl = document.getElementById("myWriterControl");
            ctl.RefreshDocument();
        }

        function InsertTable3() {
            var ctl = document.getElementById("myWriterControl");
            var parameter = {
                'RowCount': 4,//行数    
                'ColumnCount': 4,//列数    
                'TableID': 'tabletest'//表格id  
            };
            ctl.DCExecuteCommand('InsertTable', false, parameter);// 插入表格
        }

        function AddSubAfterTableTest() {
            var ctl = document.getElementById("myWriterControl");
            //要拿到表格元素的后台引用对象
            var table = ctl.GetElementByIdExt("tabletest");
            AddSubUsingBinding(true, table);
            
        }

        /**
         * 控件加载完毕后会自动执行名为 WriterControl_OnLoad 的函数.该函数内的this变量指向HTML根元素
         * @param { WriterControl } rootElement
         */
        function WriterControl_OnLoad(rootElement) {
            console.log('WriterControl_OnLoad')
            
            rootElement.SelectionChanged = function (eventSender, args) {
                var txt =
                    "第" + (this.FocusedPageIndexBase0 + 1) + "页,第" +
                    this.CurrentLineIndexInPage + "行，第" +
                    this.CurrentColumnIndex + "列.";
                if (this.SelectionLength != 0) {
                    txt = txt + "选择了" +
                        Math.abs(this.SelectionLength) + "个元素";
                }
                var p = this.SelectionStartPosition;
                txt = txt + " X:" + p.x + " Y:" + p.y;
                document.getElementById('lblStatus').innerText =
                    txt + " 当前字体:" + this.CurrentFontName + "," + this.CurrentFontSize;
            };
            rootElement.DocumentLoad = function (eventSender, args) {
                //LogHightTime("文件加载完毕");
            };
            rootElement.EventShowContextMenu = Handle_EventShowContextMenu;// 这个函数定义在DemoApp.js中
            rootElement.EventUpdateToolarState = Handle_EventUpdateToolarState;// 这个函数定义在DemoApp.js中
        };
        /** 文档内容发生改变事件*/
        function WriterControl_DocumentContentChanged(rootElement) {
            //console.log(rootElement.id + " 内容发生改变");
            //var pp = $('#tt').tabs('getSelected');
            //var tab = pp.panel('options').tab;
            //var titleEle = tab[0].querySelector('.tabs-title');
            //titleEle.classList.add('tabs-title-change');
            //titleEle.classList.remove('tabs-title-change');
        };

        var xmlForSubBinding = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>101</InnerID>
               <Text>FASDASDFSFASF</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>15</InnerID>
            </Element>
            <Element xsi:type="XTextRadioBox">
               <InnerID>11</InnerID>
               <ID>rdogroup_0</ID>
               <Name>rdogroup</Name>
               <Caption>T1</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>rdogroup</GroupName>
               <ControlStyle>RadioBox</ControlStyle>
               <CheckedValue>V1</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextRadioBox">
               <InnerID>12</InnerID>
               <ID>rdogroup_1</ID>
               <Name>rdogroup</Name>
               <Caption>T2</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>rdogroup</GroupName>
               <ControlStyle>RadioBox</ControlStyle>
               <CheckedValue>V2</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextRadioBox">
               <InnerID>13</InnerID>
               <ID>rdogroup_2</ID>
               <Name>rdogroup</Name>
               <Caption>T3</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>rdogroup</GroupName>
               <ControlStyle>RadioBox</ControlStyle>
               <CheckedValue>V3</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextRadioBox">
               <InnerID>14</InnerID>
               <ID>rdogroup_3</ID>
               <Name>rdogroup</Name>
               <Caption>T4</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>rdogroup</GroupName>
               <ControlStyle>RadioBox</ControlStyle>
               <CheckedValue>V4</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>30</InnerID>
            </Element>
            <Element xsi:type="XString" StyleIndex="1">
               <InnerID>102</InnerID>
               <Text>ASFASDFASDFASDFSDAF</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>50</InnerID>
            </Element>
            <Element xsi:type="XTextCheckBox">
               <InnerID>51</InnerID>
               <ID>chkgroup_0</ID>
               <Name>chkgroup</Name>
               <Caption>T1</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>chkgroup</GroupName>
               <CheckedValue>V1</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextCheckBox">
               <InnerID>52</InnerID>
               <ID>chkgroup_1</ID>
               <Name>chkgroup</Name>
               <Caption>T2</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>chkgroup</GroupName>
               <CheckedValue>V2</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextCheckBox">
               <InnerID>53</InnerID>
               <ID>chkgroup_2</ID>
               <Name>chkgroup</Name>
               <Caption>T3</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>chkgroup</GroupName>
               <CheckedValue>V3</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextCheckBox">
               <InnerID>54</InnerID>
               <ID>chkgroup_3</ID>
               <Name>chkgroup</Name>
               <Caption>T4</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>chkgroup</GroupName>
               <CheckedValue>V4</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>55</InnerID>
            </Element>
            <Element xsi:type="XString" StyleIndex="1">
               <InnerID>103</InnerID>
               <Text>ASFASDFASDFDASFASF</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>84</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>104</InnerID>
               <Text>姓名：</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>88</InnerID>
               <ID>field1</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <ValueBinding>
                  <DataSource>DataSourceName</DataSource>
                  <BindingPath>Name</BindingPath>
               </ValueBinding>
               <BorderElementColor />
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>94</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>105</InnerID>
               <Text>性别：</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>98</InnerID>
               <ID>field2</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <ValueBinding>
                  <DataSource>DataSourceName</DataSource>
                  <BindingPath>Sex</BindingPath>
               </ValueBinding>
               <BorderElementColor />
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
         <Style Index="1">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>都昌:都昌旗舰版（100并发）</LicenseText>
      <CreationTime>2023-03-31T14:11:29.5513345+08:00</CreationTime>
      <LastModifiedTime>2023-06-09T09:47:08.6478054+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>FASDASDFSFASF
○T1○T2○T3○T4
ASFASDFASDFASDFSDAF
□T1□T2□T3□T4
ASFASDFASDFDASFASF
姓名：
性别：</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;
        var strDemoFileXml = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>4226</InnerID>
               <Text>插入病程的示例代码类似如下：完整兼容第四代的插病程接口。</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4225</InnerID>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4223</InnerID>
            </Element>
            <Element xsi:type="HorizontalLine">
               <InnerID>4224</InnerID>
               <ID>hl1</ID>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4192</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4227</InnerID>
               <Text>var ctl = document.getElementById("myWriterControl"); </Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2523</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4228</InnerID>
               <Text>var file = new Array();</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2547</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4229</InnerID>
               <Text>var xml = 假设这里是加载子文档的xml字符串;</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2578</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4230</InnerID>
               <Text>file.push(xml);</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2594</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4231</InnerID>
               <Text>file.push(xml);</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2610</InnerID>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2611</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4232</InnerID>
               <Text>//构造两个选项分别对应两个子文档</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2629</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4233</InnerID>
               <Text>var options = new Array();</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2656</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4234</InnerID>
               <Text>var attr1 = {</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2670</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4235</InnerID>
               <Text>    "Attributes": { "姓名": "张三", "科室": "胸外科", "床号": "12345" }, //自定义属性</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2740</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4236</InnerID>
               <Text>    //"NewPage": "false", //是否新起一页</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2775</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4237</InnerID>
               <Text>    //"ReadOnly": "false", //是否可编辑</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2810</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4238</InnerID>
               <Text>    "Title": "张三的病程记录", //病程收缩时显示的文档标题</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2849</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4239</InnerID>
               <Text>    "ToolTip": "提示：张三的病程记录", //病程鼠标移上去时的提示文本</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2894</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4240</InnerID>
               <Text>    "ID": "subdoc1",//</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2917</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4241</InnerID>
               <Text>    "TitleLevel": "0",//导航级别，从0到7的整数</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>2954</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4242</InnerID>
               <Text>    "CSSStyle": "border: 3px solid #FF0000; background-color: #FFFF00;", //自定义的样式</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3036</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4243</InnerID>
               <Text>    "Parameters": { "emr.DE02.01.052.00": "汪汪汪", "fieldMedic": "王二麻子" },//绑定的数据格式</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3118</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4244</InnerID>
               <Text>    //"DataBindingXML": "&lt;DataSourceName&gt;&lt;Name&gt;张三&lt;/Name&gt;&lt;/DataSourceName&gt;&lt;DataSourceName2&gt;&lt;Name&gt;李四&lt;/Name&gt;&lt;/DataSourceName2&gt;",</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3244</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4245</InnerID>
               <Text>    //"EnablePermission": "false",</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3279</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4246</InnerID>
               <Text>    "LoadOriginHeaderFooter": "false",</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3318</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4247</InnerID>
               <Text>    "AutoFitTableWidth": "false" //设置子文档内的表格列宽进行缩放适应主文档宽度</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3376</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4248</InnerID>
               <Text>};</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3379</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4249</InnerID>
               <Text>var attr2 = {</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3393</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4250</InnerID>
               <Text>    "Attributes": { "姓名": "李四", "科室": "太平间", "床号": "45678" }, //自定义属性</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3463</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4251</InnerID>
               <Text>    //"NewPage": "true", //是否新起一页</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3497</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4252</InnerID>
               <Text>    //"ReadOnly": "true", //是否可编辑</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3531</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4253</InnerID>
               <Text>    "Title": "李四的病程记录", //文档标题</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3562</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4254</InnerID>
               <Text>    "ToolTip": "提示：李四的病程记录", //文档标题</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3598</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4255</InnerID>
               <Text>    "ID": "subdoc2",//</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3621</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4256</InnerID>
               <Text>    "TitleLevel": "0",//导航级别，从0到7的整数</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3658</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4257</InnerID>
               <Text>    "CSSStyle": "border: 1px solid #0000FF; background-color: #FFF0F5;", //自定义的样式</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3740</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4258</InnerID>
               <Text>    "Parameters": { "emr.DE02.01.052.00": "喵喵喵", "fieldMedic": "刘三姐" }, //绑定的数据格式</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3822</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4259</InnerID>
               <Text>    //"DataBindingXML": "&lt;DataSourceName&gt;&lt;Name&gt;李四&lt;/Name&gt;&lt;/DataSourceName&gt;",</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3898</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4260</InnerID>
               <Text>    //"EnablePermission": "false",</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3933</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4261</InnerID>
               <Text>    "LoadOriginHeaderFooter": "false",</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3972</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4262</InnerID>
               <Text>    "AutoFitTableWidth": "false" //设置子文档内的表格列宽进行缩放适应主文档宽度</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4030</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4263</InnerID>
               <Text>};</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4033</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4264</InnerID>
               <Text>options.push(attr1);</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4054</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4265</InnerID>
               <Text>options.push(attr2);</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4075</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4266</InnerID>
               <Text>var options = {</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4091</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4267</InnerID>
               <Text>    Files: file,</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4108</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4268</InnerID>
               <Text>    Options: options,</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4130</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4269</InnerID>
               <Text>    Usebase64: "false",</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4154</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4270</InnerID>
               <Text>};</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4157</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>4271</InnerID>
               <Text>ctl.AppendSubDocuments(options);</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>都昌:都昌旗舰版（100并发）</LicenseText>
      <CreationTime>2023-06-09T09:59:57.2198476+08:00</CreationTime>
      <LastModifiedTime>2023-06-09T10:02:24.2702932+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>2</NumOfPage>
   </Info>
   <BodyText>插入病程的示例代码类似如下：完整兼容第四代的插病程接口。


var ctl = document.getElementById("myWriterControl"); 
var file = new Array();
var xml = 假设这里是加载子文档的xml字符串;
file.push(xml);
file.push(xml);

//构造两个选项分别对应两个子文档
var options = new Array();
var attr1 = {
    "Attributes": { "姓名": "张三", "科室": "胸外科", "床号": "12345" }, //自定义属性
    //"NewPage": "false", //是否新起一页
    //"ReadOnly": "false", //是否可编辑
    "Title": "张三的病程记录", //病程收缩时显示的文档标题
    "ToolTip": "提示：张三的病程记录", //病程鼠标移上去时的提示文本
    "ID": "subdoc1",//
    "TitleLevel": "0",//导航级别，从0到7的整数
    "CSSStyle": "border: 3px solid #FF0000; background-color: #FFFF00;", //自定义的样式
    "Parameters": { "emr.DE02.01.052.00": "汪汪汪", "fieldMedic": "王二麻子" },//绑定的数据格式
    //"DataBindingXML": "&lt;DataSourceName&gt;&lt;Name&gt;张三&lt;/Name&gt;&lt;/DataSourceName&gt;&lt;DataSourceName2&gt;&lt;Name&gt;李四&lt;/Name&gt;&lt;/DataSourceName2&gt;",
    //"EnablePermission": "false",
    "LoadOriginHeaderFooter": "false",
    "AutoFitTableWidth": "false" //设置子文档内的表格列宽进行缩放适应主文档宽度
};
var attr2 = {
    "Attributes": { "姓名": "李四", "科室": "太平间", "床号": "45678" }, //自定义属性
    //"NewPage": "true", //是否新起一页
    //"ReadOnly": "true", //是否可编辑
    "Title": "李四的病程记录", //文档标题
    "ToolTip": "提示：李四的病程记录", //文档标题
    "ID": "subdoc2",//
    "TitleLevel": "0",//导航级别，从0到7的整数
    "CSSStyle": "border: 1px solid #0000FF; background-color: #FFF0F5;", //自定义的样式
    "Parameters": { "emr.DE02.01.052.00": "喵喵喵", "fieldMedic": "刘三姐" }, //绑定的数据格式
    //"DataBindingXML": "&lt;DataSourceName&gt;&lt;Name&gt;李四&lt;/Name&gt;&lt;/DataSourceName&gt;",
    //"EnablePermission": "false",
    "LoadOriginHeaderFooter": "false",
    "AutoFitTableWidth": "false" //设置子文档内的表格列宽进行缩放适应主文档宽度
};
options.push(attr1);
options.push(attr2);
var options = {
    Files: file,
    Options: options,
    Usebase64: "false",
};
ctl.AppendSubDocuments(options);</BodyText>
   <LocalConfig />
   <PageSettings>
      <Landscape>true</Landscape>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;

    </script>
</body>

</html>
