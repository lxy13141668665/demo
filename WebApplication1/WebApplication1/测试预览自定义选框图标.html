<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
     <script type="text/javascript" src="jquery-1.7.2.min.js"></script> 
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <title></title>
</head>
<body>
    <div>
        <input type="button" value="打印预览" onclick="document.WriterControl.LoadPrintPreview();" />
        <input type="button" value="关闭预览" onclick="document.WriterControl.ClosePrintPreview();" />
    </div>

    <div id="myWriterControl" style="width: 100%; border: 2px solid black; border-radius: 5px;height:900px;"
         LocalServerPort="2345"
         TransformUseBase64="false"
         FieldBorderPrintVisibility="None"
         FormView="Disable"
         ReadOnly="false"
         PreviewUseAdvancedLayout="false"
         BackgroundTextOutputMode="Underline"
         contentrendermode="NormalHTMLEditable"
         AutoSaveIntervalInSecond="0"
         workspacebackcolorstring="#B1CAEB"
         servicepageurl="ServicePage.aspx"
         useclassattribute="false"
         heightcompress="true"
         imagedataembedinhtml="true"
         ExcludeLogicDeleted="false"
         HeaderFooterEditable="true"
         UseDCWriterMiniJS="false"
         serversleepfordebug="0"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="5"
         clientcontextmenutype="Custom"
         showdebuginfo="false"
         ismobiledevice="False"
         IndentHtmlCode="false"
         FreeSelection="true"
         urlencodecountforpostdata="0"
         AutoZoom="false"
         registercodeindex="0" />


    <script type="text/javascript">
        // HTML页面加载后执行本函数
        function BuildDCWriterControlFrame() {
            // 获得控件容器元素
            var ctl = document.getElementById("myWriterControl");
            // 绑定控件
            BindingDCWriterClientControl(ctl);

            //ctl.Options.CheckBoxCheckedImageBase64 = `iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAIAAAC0D9CtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAEGSURBVDhPY/z//z8DKSD7dDsTlEkcSD7R6CVlwwC0h0jw5sd7pY2+QAYJeuQ3eH34+QnIINZtax7tdhY342fjBXEgZhAEbMvNoCwi3ZZ2snnVw11QDjF6gH4A+gTKAQPCepQ3+gJDDMoBAyb9beFgT2IHm54ctBY1EGYXgPIh4PDLc+JrnaEmYABkr8MByG1n315jWWYC4SOD3NOdi+9tgXKQANQ/z769Yl5m8uvvLwgXCL79/i69zh3KQQWIMHj/8xP7cnMgCeFqbQl++u0VhI0GUMLt599f7MvN3v/8uP/F6fDD5VBRDIAlL4iudWJiZHoZtAfKxwQQrWhgwo2lUBYm+P8fALqHUq04mGDRAAAAAElFTkSuQmCC`;
            //ctl.Options.CheckBoxUnCheckedImageBase64 = `iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAE8SURBVDhPY3yrrv9f6MYFBnLAl+IKBkYODgaGv69e/X/NzPOfVPApLef/x9BoMJsBRPx58pQkg762df3/4OQJ5UENAQFiDfra1ff/vb0blAcBcENAgJBB2AwAARRDQODP02f/XzIw/P/3+zdUBAK+9kz4/97CHspDBRiGgMDf589RDPq+bOX/t8paYDY2gNUQEAAZ9JqN///35av+v9M2gopiBzgNAYHvM+f+fw50ESGAU8WPdRv/v9Mz/f/v69f/r7CEETLAasivg4f/v+YWgfKQwujXL6gIKsAw5NepM//fCEhCeQjw99lzoIvY///7+RMqggAohoAN4JeA8jAByIBXDBwYBsEN+XXmHNAFuA2AAWwGgQ35c/sOUIIVLEAMQDcIkotZeMEcUgDcIGBgM4DKE3IByID3Du7/AXKe+uyHxsQvAAAAAElFTkSuQmCC`;

            // 创建编辑器框架
            ctl.BuildFrame(function () {
                ctl.LoadDocumentFromString(xmlforload, "xml");
                ctl.Options.CheckBoxCheckedImageBase64 = null;
                ctl.Options.CheckBoxUnCheckedImageBase64 = null;

            });
        }
        BuildDCWriterControlFrame();


        function exp() {
            var ctl = document.WriterControl;
            var win = ctl.GetContentWindow();
            if (win != null) {
                var input = win.DCSelectionManager.GetCurrentInputField();
                if (input == null) {
                    alert("当前输入域为空");
                    return;
                }
                var obj = {
                    "id": "img1",
                    "base64Img": picturebase64string,
                    "scope": "InputField",
                    "userID": "zhangsan",
                    "userName": "zhangsan",
                    "imageInFrontOfText": "false",
                    "clientName": "(local)",
                    "width": "80",
                    "height": "30",
                    "providerName": "1" //1:软签 2：诺安签名
                };

                ctl.CASignature(obj, function (result) {
                    if (result.success == "true") {
                        ctl.LoadDocumentFromString(result.result, "xml");
                    } else {
                        alert("签名失败：" + result.message);
                    }
                });
            }
        }

        function exp2(show) {
            var ctl = document.WriterControl;
            ctl.DocumentOptions.SecurityOptions.ShowFlagForOnlySoftwareSign = show;
            ctl.ApplyDocumentOptions();
        }

        var xmlforload = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XTextCheckBox">
               <InnerID>12</InnerID>
               <ID>chkgroup_0</ID>
               <Name>chkgroup</Name>
               <Caption>T1</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>chkgroup</GroupName>
               <CheckedValue>V1</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextCheckBox">
               <InnerID>13</InnerID>
               <ID>chkgroup_1</ID>
               <Name>chkgroup</Name>
               <Caption>T2</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>chkgroup</GroupName>
               <Checked>true</Checked>
               <CheckedValue>V2</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XTextCheckBox">
               <InnerID>14</InnerID>
               <ID>chkgroup_2</ID>
               <Name>chkgroup</Name>
               <Caption>T3</Caption>
               <Width>122</Width>
               <Height>57.0312424</Height>
               <GroupName>chkgroup</GroupName>
               <CheckedValue>V3</CheckedValue>
               <VisualStyle>SystemDefault</VisualStyle>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
      <CreationTime>2023-03-06T09:38:40.3979965+08:00</CreationTime>
      <LastModifiedTime>2023-03-06T09:41:26.2396553+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>□T1■T2□T3</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>
`;

        
    </script>
</body>
</html>