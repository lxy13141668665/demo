<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试输入域同步xml</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }

        body {
            height: 100vh;
            overflow: hidden;
        }

        #tools {
            height: 60px;
            padding: 5px;
        }

        #myWriterControl {
            width: 100%;
            height: calc(100% - 60px);
            border: 1px solid black;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <div id="tools">
        <input type="button" name="name" value="编辑器打开本地文件"
            onclick="document.getElementById('myWriterControl').DCExecuteCommand('fileopen', true, null)" />
            <input type="button" value="插入xml" onclick="tbXml()">
    </div>
    <div id="myWriterControl" AutoGenerateCABFile="false" AutoLine="false" AutoPostBack="true" bordercolor="red"
        BorderWidth="1px" contentrendermode="NormalHtmlEditable" FixedHeader="false" IndentHtmlCode="false"
        IsMobileDevice="False" PixelPageSpacing="5" PageViewInMobileDevice="true"
        servicepageurl="ServicePage.aspx" ShowDebugInfo="false" UseClassAttribute="true"
        UseDCWriterMiniJS="false" WorkSpaceBackColor="#B1CAEB" workspacebackcolorstring="#B1CAEB"
        HeaderFooterEditable="true" autozoom1="true" fileprintautoclose="false">
    </div>
</body>
<script src="jquery-1.7.2.min.js"></script>
<script src="ServicePage.aspx?js=1&nojq=1"></script>
<script>
    var saveString = `<XTextDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" EditorVersionString="1.2021.11.15"><XElements><Element xsi:type="XTextHeader"><InnerID>3556</InnerID><AcceptTab>true</AcceptTab><XElements><Element xsi:type="XParagraphFlag" StyleIndex="0"><InnerID>3562</InnerID><AutoCreate>true</AutoCreate></Element></XElements></Element><Element xsi:type="XTextBody"><InnerID>3557</InnerID><AcceptTab>true</AcceptTab><XElements><Element xsi:type="XString"><InnerID>95</InnerID><Text>同步xml</Text></Element><Element xsi:type="XParagraphFlag"><InnerID>3576</InnerID></Element><Element xsi:type="XInputField"><InnerID>3578</InnerID><ID>field1</ID><EnableValueValidate>true</EnableValueValidate><XElements><Element xsi:type="XString"><InnerID>97</InnerID><Text>前面</Text></Element><Element xsi:type="XString" StyleIndex="1"><InnerID>98</InnerID><Text>的文本</Text></Element><Element xsi:type="XInputField"><InnerID>36</InnerID><ID>field3</ID><EnableValueValidate>true</EnableValueValidate><XElements><Element xsi:type="XString"><InnerID>101</InnerID><Text>第一个输入域</Text></Element></XElements><BorderElementColor /><InnerValue>第一个输入域</InnerValue><BackgroundText>gg</BackgroundText></Element><Element xsi:type="XString" StyleIndex="2"><InnerID>99</InnerID><Text>后面的</Text></Element><Element xsi:type="XString" StyleIndex="3"><InnerID>100</InnerID><Text>文本</Text></Element></XElements><BorderElementColor /><InnerValue>前面的文本第一个输入域后面的文本</InnerValue><BackgroundText>有数据的</BackgroundText></Element><Element xsi:type="XParagraphFlag"><InnerID>3600</InnerID></Element><Element xsi:type="XParagraphFlag"><InnerID>23</InnerID></Element><Element xsi:type="XString"><InnerID>96</InnerID><Text>需要同步的输入域</Text></Element><Element xsi:type="XParagraphFlag"><InnerID>3601</InnerID></Element><Element xsi:type="XInputField"><InnerID>3578</InnerID><ID>field2</ID><EnableValueValidate>true</EnableValueValidate><XElements /><BorderElementColor /><InnerValue /><BackgroundText>无数据的</BackgroundText></Element><Element xsi:type="XParagraphFlag"><InnerID>3561</InnerID><AutoCreate>true</AutoCreate></Element></XElements></Element><Element xsi:type="XTextFooter"><InnerID>3558</InnerID><AcceptTab>true</AcceptTab><XElements><Element xsi:type="XParagraphFlag"><InnerID>3563</InnerID><AutoCreate>true</AutoCreate></Element></XElements></Element></XElements><FileName>C:\Users\admin\Desktop\测试同步xml.xml</FileName><FileFormat>XML</FileFormat><ContentStyles><Default xsi:type="DocumentContentStyle"><FontName>宋体</FontName><FontSize>12</FontSize></Default><Styles><Style Index="0"><FontName>宋体</FontName><FontSize>12</FontSize><Align>Center</Align></Style><Style Index="1"><Color>#EA161E</Color><FontName>宋体</FontName><FontSize>12</FontSize></Style><Style Index="2"><FontName>宋体</FontName><FontSize>15</FontSize></Style><Style Index="3"><FontName>楷体</FontName><FontSize>12</FontSize></Style></Styles></ContentStyles><Info><LicenseText>南京都昌信息科技有限公司:南京都昌信息科技有限公司内测版</LicenseText><CreationTime>1980-01-01T00:00:00</CreationTime><LastModifiedTime>2022-07-18T09:13:38.7299811+08:00</LastModifiedTime><LastPrintTime>1980-01-01T00:00:00</LastPrintTime><Operator>DCSoft.Writer Version:1.2021.11.15</Operator><NumOfPage>1</NumOfPage></Info><BodyText>同步xml
前面的文本第一个输入域后面的文本

需要同步的输入域
</BodyText><LocalConfig /><PageSettings><StrictUsePageSize>false</StrictUsePageSize></PageSettings></XTextDocument>`;
    var insertxmlStr = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>6</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>164</InnerID>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>8</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>183</InnerID>
               <Text>（患者）坐位背部探测：于</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>44</InnerID>
               <ID>field1375</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>192</InnerID>
                     <Text>右</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <InnerValue>左</InnerValue>
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>右</Text>
                        </Item>
                        <Item>
                           <Text>左</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>184</InnerID>
               <Text>侧胸腔下部探及无回声区，其上缘达第</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>63</InnerID>
               <ID>field1452</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>193</InnerID>
                     <Text>1</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <InnerValue>1</InnerValue>
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>1</Text>
                        </Item>
                        <Item>
                           <Text>2</Text>
                        </Item>
                        <Item>
                           <Text>3</Text>
                        </Item>
                        <Item>
                           <Text>4</Text>
                        </Item>
                        <Item>
                           <Text>5</Text>
                        </Item>
                        <Item>
                           <Text>6</Text>
                        </Item>
                        <Item>
                           <Text>7</Text>
                        </Item>
                        <Item>
                           <Text>8</Text>
                        </Item>
                        <Item>
                           <Text>9</Text>
                        </Item>
                        <Item>
                           <Text>10</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>185</InnerID>
               <Text>肋</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>66</InnerID>
               <ID>field1694</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString" StyleIndex="0">
                     <InnerID>194</InnerID>
                     <Text>，</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>，</Text>
                        </Item>
                        <Item>
                           <Text>间，</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>186</InnerID>
               <Text>上下径约cm，前后径约cm，左右径约cm，透声</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>91</InnerID>
               <ID>field1061</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>195</InnerID>
                     <Text>差</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <InnerValue>差</InnerValue>
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>好</Text>
                        </Item>
                        <Item>
                           <Text>欠佳</Text>
                        </Item>
                        <Item>
                           <Text>差</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>187</InnerID>
               <Text>。最佳穿刺点位于第</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>102</InnerID>
               <ID>field1795</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>196</InnerID>
                     <Text>1</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <InnerValue>1</InnerValue>
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>1</Text>
                        </Item>
                        <Item>
                           <Text>2</Text>
                        </Item>
                        <Item>
                           <Text>3</Text>
                        </Item>
                        <Item>
                           <Text>4</Text>
                        </Item>
                        <Item>
                           <Text>5</Text>
                        </Item>
                        <Item>
                           <Text>6</Text>
                        </Item>
                        <Item>
                           <Text>7</Text>
                        </Item>
                        <Item>
                           <Text>8</Text>
                        </Item>
                        <Item>
                           <Text>9</Text>
                        </Item>
                        <Item>
                           <Text>10</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>188</InnerID>
               <Text>肋间</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>106</InnerID>
               <ID>field1529</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>197</InnerID>
                     <Text>右</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <InnerValue>右</InnerValue>
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>右</Text>
                        </Item>
                        <Item>
                           <Text>左</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>189</InnerID>
               <Text>侧</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>109</InnerID>
               <ID>field1914</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>198</InnerID>
                     <Text>肩胛下角线</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <InnerValue>肩胛下角线</InnerValue>
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>肩胛下角线</Text>
                        </Item>
                        <Item>
                           <Text>腋后线</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>190</InnerID>
               <Text>（见体表标志点），该体表穿刺点距暗区前缘约cm，此处暗区前后径约cm。</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>150</InnerID>
               <ID>field1157</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>199</InnerID>
                     <Text>左</Text>
                  </Element>
               </XElements>
               <StartBorderText>[</StartBorderText>
               <EndBorderText>]</EndBorderText>
               <BorderElementColor />
               <InnerValue>左</InnerValue>
               <EditorActiveMode>MouseClick</EditorActiveMode>
               <FieldSettings>
                  <EditStyle>DropdownList</EditStyle>
                  <ListSource>
                     <Items>
                        <Item>
                           <Text>左</Text>
                        </Item>
                        <Item>
                           <Text>右</Text>
                        </Item>
                     </Items>
                  </ListSource>
               </FieldSettings>
            </Element>
            <Element xsi:type="XString">
               <InnerID>191</InnerID>
               <Text>侧胸腔未探及无回声区。</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>161</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>10</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>168</InnerID>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <SerializeParameterValue>true</SerializeParameterValue>
   <FileName>C:\Users\DCSOFTWU\Desktop\aaaaaa.xml</FileName>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <Color>#FFFF00</Color>
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
         </Style>
         <Style Index="1">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌信息科技有限公司:南京都昌信息科技有限公司内测版</LicenseText>
      <CreationTime>1980-01-01T00:00:00</CreationTime>
      <LastModifiedTime>2022-10-31T09:41:11.5995246+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:1.2019.1.29</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>（患者）坐位背部探测：于[右]侧胸腔下部探及无回声区，其上缘达第[1]肋[，]上下径约cm，前后径约cm，左右径约cm，透声[差]。最佳穿刺点位于第[1]肋间[右]侧[肩胛下角线]（见体表标志点），该体表穿刺点距暗区前缘约cm，此处暗区前后径约cm。[左]侧胸腔未探及无回声区。</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;
</script>
<script>
    var ctl = document.getElementById("myWriterControl");
    var servicepageurl = "ServicePage.aspx";
    function Build() {
        if (ctl) {
            // ctl.setAttribute("servicepageurl", servicepageurl);
            BindingDCWriterClientControl(ctl);
            ctl.BuildFrame(function () {
                ctl.LoadDocumentFromString(saveString, "xml");
                //ctl.DocumentLoad = function () {
                //    tbXml();
                //}
            });
        }
    }
    Build();
    function tbXml() {
        var doc = ctl.GetContentDocument();
        var tb_el = doc.getElementById("field2");
        if (tb_el) {
            var obj = {
                "file": insertxmlStr, //xml文档
                "format": "xml", //xml文档格式
                "base64": "false", //是否是base64字符串
                "type": "two",
                "position": "end",
            };
            //先赋空值再覆盖
            ctl.SetElementTextByID(tb_el, "");
            ctl.InsertXmlById(obj, tb_el, false);
            insertxmlStr = ctl.GetElementInnerXmlById(tb_el);
        }
    }
</script>

</html>