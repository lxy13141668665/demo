<!DOCTYPE html >
<html>
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <title>表格数据源绑定图片测试页</title>
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <style>
        html, body {
            height: 100%;

        }
    </style>
</head>
<body style="overflow: hidden;">
    <div>
        <input type="button" value="直接加载原文档" onclick="exp();" />
        <input type="button" value="加载后台绑定数据源的文档" onclick="exp7adv();" />
        <input type="button" value="加载后台绑定数据源的预览文档" onclick="exp7adv(true);" />
    </div>
    <div>
        <input type="button" value="加载原文档并附加子文档" onclick="loaduseapendsubdoc();" />
        <input type="button" value="修改点内容后留痕预览" onclick="document.WriterControl.LoadPrintPreviewWithPermissionMark();" />
        <input type="button" value="修改点内容后获取痕迹" onclick="document.WriterControl.GetDocumentUserTrackInfos(true);" />
    </div>
    <div>
        <input type="button" value="Url加载文档" onclick="expurl();" />
    </div>


    <div id="myWriterControl"
         style="width: 100%; height: 100%"
         contentrendermode="NormalHtmlEditable"
         workspacebackcolorstring="#F1F3F5"
         useclassattribute="false"
         FormView="Disable"
         ClientContextMenuType="Custom"
         UseDCWriterMiniJS="false"
         LogUserEditTrack="false"
         heightcompress="true"
         backgroundtextoutputmode="Whitespace"
         imagedataembedinhtml="true"
         serversleepfordebug="0"
         ShowPageBorderLine="false"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="1"
         showdebuginfo="false"
         HeaderFooterEditable="true"
         registercodeindex="0"
         fileprintautoclose="false"
         servicepageurl="ServicePage.aspx">

    </div>
    <script type="text/javascript">

        // 获得控件容器元素
        var ctl = document.getElementById("myWriterControl");

        // 绑定控件
        BindingDCWriterClientControl(ctl);

        ctl.Options.LogUserEditTrack = true;
        ctl.Options.CurrentUserID = "zhangsan";
        ctl.Options.CurrentUserName = "张三主任医师";
        ctl.Options.CurrentUserPermissionLevel = "2";
        ctl.Options.ClientMachineName = "123";
        ctl.Options.ExcludeLogicDeleted = false;
        ctl.DocumentOptions.SecurityOptions.EnablePermission = true;
        ctl.DocumentOptions.SecurityOptions.EnableLogicDelete = true;
        ctl.DocumentOptions.SecurityOptions.ShowLogicDeletedContent = true;
        ctl.DocumentOptions.SecurityOptions.ShowPermissionMark = true;
        ctl.DocumentOptions.SecurityOptions.ShowPermissionTip = true;
        ctl.Options.OutputOriginUserTrackInfos = true;

        // 创建编辑器框架
        ctl.BuildFrame(function () {
            //ctl.LoadDocumentFromString(saveString, "xml");
            //menu()
        });



        function exp() {
            var ctl = document.WriterControl;
            var obj = {
                FileContent: simplefile,      //加载的文档XML字符串
                FileFormat: "xml",          //加载的文档格式
                UseBase64String: "false",       //是否加载的是BASE64字符串
                LoadPrintPreivew: "true",          //是否直接加载打印预览的界面而不是编辑界面
                DataBindingXML: null,       //加载时附带的数据源XML，后台会绑定好再展示到前端
                CommitUserTrace: "true"     //是否将文档在后台提交完痕迹后再展示 到前端
            };
            ctl.LoadDocumentFromString2(obj);
        }

        function exp2() {
            var ctl = document.WriterControl;

        }

        function exp7adv(preview) {
            var ctl = document.getElementById("myWriterControl");
            if (ctl != null) {
                var xml1 = "<EMR_Patients><NAME>张三</NAME><BirthPlace>南京</BirthPlace><sex>女</sex><Job>护士</Job><age>23</age><indate>2019-3-27</indate></EMR_Patients>";
                var xml2 = "<radiodatasource>单选值1</radiodatasource>";
                var xml3 = "<checkdatasource>复选值3,复选值4</checkdatasource>";
                var xml4 = "<datasourceforbarcode>5555555555</datasourceforbarcode>";

                var lpp = preview === true ? "true" : "false";
                var obj = {
                    FileContent: data,
                    FileFormat: "xml",
                    UseBase64String: "false",
                    LoadPrintPreivew: lpp,
                    DataBindingXML: xml1 + xml2 + xml3 + xml4,
                    CommitUserTrace: "false"
                };
                ctl.LoadDocumentFromString2(obj);
            }
        }

        var data = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
           <XElements>
              <Element xsi:type="XTextHeader">
                 <InnerID>1</InnerID>
                 <AcceptTab>true</AcceptTab>
                 <XElements>
                    <Element xsi:type="XParagraphFlag" StyleIndex="0">
                       <InnerID>6</InnerID>
                       <AutoCreate>true</AutoCreate>
                    </Element>
                 </XElements>
              </Element>
              <Element xsi:type="XTextBody">
                 <InnerID>2</InnerID>
                 <AcceptTab>true</AcceptTab>
                 <XElements>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>74</InnerID>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>75</InnerID>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>73</InnerID>
                    </Element>
                    <Element xsi:type="XTextSubDocument" StyleIndex="1">
                       <InnerID>121</InnerID>
                       <ID>subdoc1</ID>
                       <AcceptTab>true</AcceptTab>
                       <EnablePermission>False</EnablePermission>
                       <ContentReadonly>False</ContentReadonly>
                       <XElements>
                          <Element xsi:type="XString">
                             <InnerID>220</InnerID>
                             <Text>asdfasfsadfd</Text>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>72</InnerID>
                          </Element>
                          <Element xsi:type="XString">
                             <InnerID>221</InnerID>
                             <Text>一次性绑定域 ： </Text>
                          </Element>
                          <Element xsi:type="XInputField">
                             <InnerID>11</InnerID>
                             <ID>field1</ID>
                             <EnableValueValidate>true</EnableValueValidate>
                             <ValueBinding>
                                <Enabled>false</Enabled>
                                <DataSource>EMR_Patients</DataSource>
                                <FormatString>格式化</FormatString>
                                <BindingPath>NAME</BindingPath>
                                <BindingPathForText>TEXTBINDING</BindingPathForText>
                                <ProcessState>Once</ProcessState>
                                <AutoUpdate>true</AutoUpdate>
                                <Readonly>true</Readonly>
                             </ValueBinding>
                             <BorderElementColor />
                             <BackgroundText>绑定域</BackgroundText>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>174</InnerID>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>41</InnerID>
                          </Element>
                          <Element xsi:type="XInputField">
                             <InnerID>11</InnerID>
                             <ID>field2</ID>
                             <EnableValueValidate>true</EnableValueValidate>
                             <ValueBinding>
                                <DataSource>EMR_Patients</DataSource>
                                <BindingPath>BirthPlace</BindingPath>
                             </ValueBinding>
                             <BorderElementColor />
                             <BackgroundText>绑定域</BackgroundText>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>23</InnerID>
                          </Element>
                          <Element xsi:type="XInputField">
                             <InnerID>11</InnerID>
                             <ID>field3</ID>
                             <EnableValueValidate>true</EnableValueValidate>
                             <ValueBinding>
                                <DataSource>EMR_Patients</DataSource>
                                <BindingPath>sex</BindingPath>
                             </ValueBinding>
                             <BorderElementColor />
                             <BackgroundText>绑定域</BackgroundText>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>23</InnerID>
                          </Element>
                          <Element xsi:type="XInputField">
                             <InnerID>11</InnerID>
                             <ID>field4</ID>
                             <EnableValueValidate>true</EnableValueValidate>
                             <ValueBinding>
                                <DataSource>EMR_Patients</DataSource>
                                <BindingPath>Job</BindingPath>
                             </ValueBinding>
                             <BorderElementColor />
                             <BackgroundText>绑定域</BackgroundText>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>23</InnerID>
                          </Element>
                          <Element xsi:type="XInputField">
                             <InnerID>11</InnerID>
                             <ID>field5</ID>
                             <EnableValueValidate>true</EnableValueValidate>
                             <ValueBinding>
                                <DataSource>EMR_Patients</DataSource>
                                <BindingPath>age</BindingPath>
                             </ValueBinding>
                             <BorderElementColor />
                             <BackgroundText>绑定域</BackgroundText>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>23</InnerID>
                          </Element>
                          <Element xsi:type="XInputField">
                             <InnerID>11</InnerID>
                             <ID>field6</ID>
                             <EnableValueValidate>true</EnableValueValidate>
                             <ValueBinding>
                                <DataSource>EMR_Patients</DataSource>
                                <BindingPath>icon</BindingPath>
                             </ValueBinding>
                             <BorderElementColor />
                             <BackgroundText>绑定域</BackgroundText>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>179</InnerID>
                          </Element>
                          <Element xsi:type="XString">
                             <InnerID>222</InnerID>
                             <Text>adfasfsdfsdff</Text>
                          </Element>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>132</InnerID>
                             <AutoCreate>true</AutoCreate>
                          </Element>
                       </XElements>
                       <ForeColorForCollapsed />
                       <ForeColorValueForCollapsed>#00000000</ForeColorValueForCollapsed>
                       <DocumentInfo>
                          <Title>病程记录2022年07月08日 14时42分27秒</Title>
                          <CreationTime>1980-01-01T00:00:00</CreationTime>
                          <LastModifiedTime>1980-01-01T00:00:00</LastModifiedTime>
                          <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
                          <Author>DCSOFTWU</Author>
                          <Operator>DCSoft.Writer Version:1.2022.5.5</Operator>
                       </DocumentInfo>
                       <FileName>D:\Winform演示程序2022年5月\Debug\DemoFile\病程记录内容\病程记录2022年07月08日 14时42分27秒.xml</FileName>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>76</InnerID>
                    </Element>
                    <Element xsi:type="XTextSubDocument" StyleIndex="1">
                       <InnerID>58</InnerID>
                       <ID>subdoc2</ID>
                       <AcceptTab>true</AcceptTab>
                       <EnablePermission>False</EnablePermission>
                       <ContentReadonly>False</ContentReadonly>
                       <XElements>
                          <Element xsi:type="XParagraphFlag">
                             <InnerID>69</InnerID>
                             <AutoCreate>true</AutoCreate>
                          </Element>
                       </XElements>
                       <ForeColorForCollapsed />
                       <ForeColorValueForCollapsed>#00000000</ForeColorValueForCollapsed>
                       <DocumentInfo>
                          <Title>病程记录2022年07月08日 14时43分11秒</Title>
                          <CreationTime>1980-01-01T00:00:00</CreationTime>
                          <LastModifiedTime>1980-01-01T00:00:00</LastModifiedTime>
                          <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
                          <Author>DCSOFTWU</Author>
                          <Operator>DCSoft.Writer Version:1.2022.5.5</Operator>
                       </DocumentInfo>
                       <FileName>D:\Winform演示程序2022年5月\Debug\DemoFile\病程记录内容\病程记录2022年07月08日 14时43分11秒.xml</FileName>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>67</InnerID>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>67</InnerID>
                    </Element>
                    <Element xsi:type="XTextRadioBox">
                       <InnerID>68</InnerID>
                       <ID>radiogroup_0</ID>
                       <Deleteable>false</Deleteable>
                       <Name>radiogroup</Name>
                       <Caption>单选1</Caption>
                       <ValueBinding>
                          <DataSource>radiodatasource</DataSource>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>radiogroup</GroupName>
                       <ControlStyle>RadioBox</ControlStyle>
                       <CheckedValue>单选值1</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XTextRadioBox">
                       <InnerID>69</InnerID>
                       <ID>radiogroup_1</ID>
                       <Deleteable>false</Deleteable>
                       <Name>radiogroup</Name>
                       <Caption>单选2</Caption>
                       <ValueBinding>
                          <DataSource>radiodatasource</DataSource>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>radiogroup</GroupName>
                       <ControlStyle>RadioBox</ControlStyle>
                       <CheckedValue>单选值2</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XTextRadioBox">
                       <InnerID>70</InnerID>
                       <ID>radiogroup_2</ID>
                       <Deleteable>false</Deleteable>
                       <Name>radiogroup</Name>
                       <Caption>单选3</Caption>
                       <ValueBinding>
                          <DataSource>radiodatasource</DataSource>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>radiogroup</GroupName>
                       <ControlStyle>RadioBox</ControlStyle>
                       <CheckedValue>单选值3</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XTextRadioBox">
                       <InnerID>71</InnerID>
                       <ID>radiogroup_3</ID>
                       <Deleteable>false</Deleteable>
                       <Name>radiogroup</Name>
                       <Caption>单选4</Caption>
                       <ValueBinding>
                          <DataSource>radiodatasource</DataSource>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>radiogroup</GroupName>
                       <ControlStyle>RadioBox</ControlStyle>
                       <CheckedValue>单选值4</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>66</InnerID>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>67</InnerID>
                    </Element>
                    <Element xsi:type="XString">
                       <InnerID>218</InnerID>
                       <Text>一次性绑定选框组：</Text>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>72</InnerID>
                    </Element>
                    <Element xsi:type="XTextCheckBox">
                       <InnerID>73</InnerID>
                       <ID>checkgroup_0</ID>
                       <Name>checkgroup</Name>
                       <Caption>复选1</Caption>
                       <ValueBinding>
                          <DataSource>checkdatasource</DataSource>
                          <ProcessState>Once</ProcessState>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>checkgroup</GroupName>
                       <Checked>true</Checked>
                       <CheckedValue>复选值1</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XTextCheckBox">
                       <InnerID>74</InnerID>
                       <ID>checkgroup_1</ID>
                       <Name>checkgroup</Name>
                       <Caption>复选2</Caption>
                       <ValueBinding>
                          <DataSource>checkdatasource</DataSource>
                          <ProcessState>Once</ProcessState>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>checkgroup</GroupName>
                       <Checked>true</Checked>
                       <CheckedValue>复选值2</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XTextCheckBox">
                       <InnerID>75</InnerID>
                       <ID>checkgroup_2</ID>
                       <Name>checkgroup</Name>
                       <Caption>复选3</Caption>
                       <ValueBinding>
                          <DataSource>checkdatasource</DataSource>
                          <ProcessState>Once</ProcessState>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>checkgroup</GroupName>
                       <Checked>true</Checked>
                       <CheckedValue>复选值3</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XTextCheckBox">
                       <InnerID>76</InnerID>
                       <ID>checkgroup_3</ID>
                       <Name>checkgroup</Name>
                       <Caption>复选4</Caption>
                       <ValueBinding>
                          <DataSource>checkdatasource</DataSource>
                          <ProcessState>Once</ProcessState>
                       </ValueBinding>
                       <Width>196.999985</Width>
                       <Height>57.0312424</Height>
                       <GroupName>checkgroup</GroupName>
                       <Checked>true</Checked>
                       <CheckedValue>复选值4</CheckedValue>
                       <VisualStyle>SystemDefault</VisualStyle>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>26</InnerID>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>243</InnerID>
                    </Element>
                    <Element xsi:type="XString">
                       <InnerID>219</InnerID>
                       <Text>带数据原绑定的条形码：</Text>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>244</InnerID>
                    </Element>
                    <Element xsi:type="NewBarcode">
                       <InnerID>245</InnerID>
                       <ID>barcode1</ID>
                       <ValueBinding>
                          <DataSource>datasourceforbarcode</DataSource>
                       </ValueBinding>
                       <Width>1366</Width>
                       <Height>222</Height>
                       <BarcodeStyle2>Code128B</BarcodeStyle2>
                    </Element>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>7</InnerID>
                       <AutoCreate>true</AutoCreate>
                    </Element>
                 </XElements>
              </Element>
              <Element xsi:type="XTextFooter">
                 <InnerID>3</InnerID>
                 <AcceptTab>true</AcceptTab>
                 <XElements>
                    <Element xsi:type="XParagraphFlag">
                       <InnerID>8</InnerID>
                       <AutoCreate>true</AutoCreate>
                    </Element>
                 </XElements>
              </Element>
           </XElements>
           <FileName>C:\Users\DCSOFTWU\Desktop\aaaaaaaaaaaaaaaaa.xml</FileName>
           <FileFormat>XML</FileFormat>
           <ContentStyles>
              <Default xsi:type="DocumentContentStyle">
                 <FontName>宋体</FontName>
                 <FontSize>12</FontSize>
              </Default>
              <Styles>
                 <Style Index="0">
                    <FontName>宋体</FontName>
                    <FontSize>12</FontSize>
                    <Align>Center</Align>
                 </Style>
                 <Style Index="1">
                    <FontName>宋体</FontName>
                    <FontSize>12</FontSize>
                    <PrintBackColor>#00FFFFFF</PrintBackColor>
                 </Style>
              </Styles>
           </ContentStyles>
           <Info>
              <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
              <CreationTime>2022-07-06T10:34:58.2354245+08:00</CreationTime>
              <LastModifiedTime>2023-03-17T16:42:24.4086329+08:00</LastModifiedTime>
              <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
              <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
              <NumOfPage>1</NumOfPage>
           </Info>
           <BodyText>


asdfasfsadfd
一次性绑定域 ：






adfasfsdfsdff


○单选1○单选2○单选3○单选4

一次性绑定选框组：
■复选1■复选2■复选3■复选4

带数据原绑定的条形码：
</BodyText>
           <LocalConfig />
           <PageSettings>
              <StrictUsePageSize>false</StrictUsePageSize>
           </PageSettings>
</XTextDocument>`;

        var simplefile = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
       <XElements>
          <Element xsi:type="XTextHeader">
             <InnerID>1</InnerID>
             <AcceptTab>true</AcceptTab>
             <XElements>
                <Element xsi:type="XParagraphFlag" StyleIndex="0">
                   <InnerID>6</InnerID>
                   <AutoCreate>true</AutoCreate>
                </Element>
             </XElements>
          </Element>
          <Element xsi:type="XTextBody">
             <InnerID>2</InnerID>
             <AcceptTab>true</AcceptTab>
             <XElements>
                <Element xsi:type="XString">
                   <InnerID>37</InnerID>
                   <Text>asdfasf</Text>
                </Element>
                <Element xsi:type="XInputField">
                   <InnerID>30</InnerID>
                   <ID>field1</ID>
                   <EnableValueValidate>true</EnableValueValidate>
                   <BorderElementColor />
                   <BackgroundText>背景文字</BackgroundText>
                </Element>
                <Element xsi:type="XString">
                   <InnerID>38</InnerID>
                   <Text>asdfdasfasdf</Text>
                </Element>
                <Element xsi:type="XParagraphFlag">
                   <InnerID>7</InnerID>
                   <AutoCreate>true</AutoCreate>
                </Element>
             </XElements>
          </Element>
          <Element xsi:type="XTextFooter">
             <InnerID>3</InnerID>
             <AcceptTab>true</AcceptTab>
             <XElements>
                <Element xsi:type="XParagraphFlag">
                   <InnerID>8</InnerID>
                   <AutoCreate>true</AutoCreate>
                </Element>
             </XElements>
          </Element>
       </XElements>
       <FileFormat>XML</FileFormat>
       <ContentStyles>
          <Default xsi:type="DocumentContentStyle">
             <FontSize>12</FontSize>
          </Default>
          <Styles>
             <Style Index="0">
                <FontSize>12</FontSize>
                <Align>Center</Align>
             </Style>
          </Styles>
       </ContentStyles>
       <Info>
          <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
          <CreationTime>2023-04-10T13:24:55.7603672+08:00</CreationTime>
          <LastModifiedTime>2023-04-10T13:27:03.6105597+08:00</LastModifiedTime>
          <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
          <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
          <NumOfPage>1</NumOfPage>
       </Info>
       <BodyText>asdfasfasdfdasfasdf</BodyText>
       <LocalConfig />
       <PageSettings>
          <StrictUsePageSize>false</StrictUsePageSize>
       </PageSettings>
</XTextDocument>`;

        function loaduseapendsubdoc() {
            var file = new Array();

            var xml = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0"><XElements><Element xsi:type="XTextHeader"><InnerID>1</InnerID><AcceptTab>true</AcceptTab><XElements><Element xsi:type="XParagraphFlag" StyleIndex="0"><InnerID>6</InnerID><AutoCreate>true</AutoCreate></Element></XElements></Element><Element xsi:type="XTextBody"><InnerID>2</InnerID><AcceptTab>true</AcceptTab><XElements><Element xsi:type="XString"><InnerID>81</InnerID><Text>AAAAAA</Text></Element><Element xsi:type="XInputField"><InnerID>44</InnerID><ID>field1</ID><EnableValueValidate>true</EnableValueValidate><BorderElementColor /></Element><Element xsi:type="XString"><InnerID>82</InnerID><Text>AAAAAAAA</Text></Element><Element xsi:type="XTextCheckBox"><InnerID>47</InnerID><ID>checkbox1</ID><Name>chkgroup1</Name><Caption>BBB</Caption><Width>166.0104</Width><Height>57.0312424</Height><GroupName>chkgroup1</GroupName><VisualStyle>SystemDefault</VisualStyle></Element><Element xsi:type="XString"><InnerID>83</InnerID><Text>AAAAAAAAAA</Text></Element><Element xsi:type="XParagraphFlag"><InnerID>48</InnerID></Element><Element xsi:type="XTextTable" NumOfRows="1" NumOfColumns="3"><InnerID>50</InnerID><ID>table1</ID><XElements><Element xsi:type="XTextTableRow"><InnerID>54</InnerID><XElements><Element xsi:type="XTextTableCell" StyleIndex="1"><InnerID>55</InnerID><XElements><Element xsi:type="XInputField"><InnerID>61</InnerID><ID>field2</ID><EnableValueValidate>true</EnableValueValidate><BorderElementColor /></Element><Element xsi:type="XParagraphFlag"><InnerID>56</InnerID></Element></XElements></Element><Element xsi:type="XTextTableCell" StyleIndex="1"><InnerID>57</InnerID><XElements><Element xsi:type="XString"><InnerID>84</InnerID><Text>CCCC</Text></Element><Element xsi:type="XParagraphFlag"><InnerID>58</InnerID></Element></XElements></Element><Element xsi:type="XTextTableCell" StyleIndex="1"><InnerID>59</InnerID><XElements><Element xsi:type="XTextCheckBox"><InnerID>72</InnerID><ID>checkbox2</ID><Caption>DDD</Caption><Width>166.0104</Width><Height>57.0312424</Height><VisualStyle>SystemDefault</VisualStyle></Element><Element xsi:type="XParagraphFlag"><InnerID>60</InnerID></Element></XElements></Element></XElements></Element></XElements><Columns><Element xsi:type="XTextTableColumn"><InnerID>51</InnerID><Width>624.9167</Width></Element><Element xsi:type="XTextTableColumn"><InnerID>52</InnerID><Width>624.9167</Width></Element><Element xsi:type="XTextTableColumn"><InnerID>53</InnerID><Width>624.9167</Width></Element></Columns></Element><Element xsi:type="XParagraphFlag"><InnerID>7</InnerID><AutoCreate>true</AutoCreate></Element></XElements></Element><Element xsi:type="XTextFooter"><InnerID>3</InnerID><AcceptTab>true</AcceptTab><XElements><Element xsi:type="XParagraphFlag"><InnerID>8</InnerID><AutoCreate>true</AutoCreate></Element></XElements></Element></XElements><FileName>C:\Users\DCSOFTWU\Desktop\子文档.xml</FileName><FileFormat>XML</FileFormat><ContentStyles><Default xsi:type="DocumentContentStyle"><FontSize>12</FontSize></Default><Styles><Style Index="0"><FontSize>12</FontSize><Align>Center</Align></Style><Style Index="1"><FontSize>12</FontSize><BorderWidth>1</BorderWidth><BorderLeft>true</BorderLeft><BorderBottom>true</BorderBottom><BorderTop>true</BorderTop><BorderRight>true</BorderRight><PaddingLeft>15</PaddingLeft><PaddingTop>10</PaddingTop><PaddingRight>15</PaddingRight><PaddingBottom>10</PaddingBottom></Style></Styles></ContentStyles><Info><LicenseText>南京都昌信息科技有限公司:南京都昌信息科技有限公司内测版</LicenseText><CreationTime>2022-11-01T13:04:24.6111908+08:00</CreationTime><LastModifiedTime>2022-11-01T13:25:16.050188+08:00</LastModifiedTime><LastPrintTime>1980-01-01T00:00:00</LastPrintTime><Operator>DCSoft.Writer Version:0.0.0.0</Operator><NumOfPage>1</NumOfPage></Info><BodyText></BodyText><LocalConfig /><PageSettings><StrictUsePageSize>false</StrictUsePageSize></PageSettings></XTextDocument>`;
            file.push(xml);
            file.push(xml);

            //构造两个选项分别对应两个子文档
            var options = new Array();
            var attr1 = {
                "Attributes": { "姓名": "张三", "科室": "胸外科", "床号": "12345" }, //自定义属性
                //"NewPage": "false", //是否新起一页
                //"ReadOnly": "false", //是否可编辑
                "Title": "张三的病程记录", //病程收缩时显示的文档标题
                "ToolTip": "提示：张三的病程记录", //病程鼠标移上去时的提示文本
                "ID": "subdoc1",//
                "TitleLevel": "0",//导航级别，从0到7的整数
                "CSSStyle": "border: 3px solid #FF0000; background-color: #FFFF00;", //自定义的样式
                "Parameters": { "emr.DE02.01.052.00": "汪汪汪", "fieldMedic": "王二麻子" },//绑定的数据格式
                //"DataBindingXML": "<DataSourceName><Name>张三</Name></DataSourceName><DataSourceName2><Name>李四</Name></DataSourceName2>",
                //"EnablePermission": "true",
                "LoadOriginHeaderFooter": "false",
                "AutoFitTableWidth": "false" //设置子文档内的表格列宽进行缩放适应主文档宽度
            };
            var attr2 = {
                "Attributes": { "姓名": "李四", "科室": "太平间", "床号": "45678" }, //自定义属性
                //"NewPage": "true", //是否新起一页
                //"ReadOnly": "true", //是否可编辑
                "Title": "李四的病程记录", //文档标题
                "ToolTip": "提示：李四的病程记录", //文档标题
                "ID": "subdoc2",//
                "TitleLevel": "0",//导航级别，从0到7的整数
                "CSSStyle": "border: 1px solid #0000FF; background-color: #FFF0F5;", //自定义的样式
                "Parameters": { "emr.DE02.01.052.00": "喵喵喵", "fieldMedic": "刘三姐" }, //绑定的数据格式
                //"DataBindingXML": "<DataSourceName><Name>李四</Name></DataSourceName>",
                //"EnablePermission": "true",
                "LoadOriginHeaderFooter": "false",
                "AutoFitTableWidth": "false" //设置子文档内的表格列宽进行缩放适应主文档宽度
            };
            options.push(attr1);
            options.push(attr2);
            var apendsubdocoptions = {
                Files: file,
                Options: options
            };

            var obj = {
                FileContent: data,
                FileFormat: "xml",
                UseBase64String: "false",
                LoadPrintPreivew: "false",
                DataBindingXML: null,
                CommitUserTrace: "true",
                AppendSubDocuments: apendsubdocoptions  //加载时附加的子文档，后台会将子文档附加好后再展示到前端
            };
            ctl.LoadDocumentFromString2(obj);
        }


        function expurl() {
            var ctl = document.WriterControl;
            var obj = {
                LoadFromUrl: "http://www.dcwriter.cn/Download/%E6%BC%94%E7%A4%BA%E8%B5%84%E6%96%99/%E8%A1%A8%E6%A0%BC%E5%90%88%E5%B9%B6%E7%AE%80%E5%8C%96%E6%96%87%E6%A1%A3.xml"
            };
            ctl.LoadDocumentFromString2(obj);
        }
    </script>

</body>
</html>