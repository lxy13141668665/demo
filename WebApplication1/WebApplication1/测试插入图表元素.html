<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <!--<script type="text/javascript" src="ServicePage.aspx?js=1"></script>-->

    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <title></title>
</head>
<body>
    <div>
        <input type="button" value="前端插入图表" onclick="exp25();" />
        <input type="button" value="前端插入饼图" onclick="exp25_2();" />
        <input type="button" value="修改图表数据并刷新1" onclick="exp26();;" />
        <input type="button" value="修改图表数据并刷新2" onclick="exp27();" />
    </div>


    <div id="myWriterControl" style="width: 100%; border: 2px solid black; border-radius: 5px;height:900px;"
         LocalServerPort="2345"
         TidyHTMLForEdit="false"
         TransformUseBase64="true"
         FieldBorderPrintVisibility="None"
         FormView="Disable"
         ReadOnly="false"
         PreviewUseAdvancedLayout="false"
         BackgroundTextOutputMode="Output"
         contentrendermode="NormalHTMLEditable"
         AutoSaveIntervalInSecond="0"
         workspacebackcolorstring="#B1CAEB"
         servicepageurl="ServicePage.aspx"
         useclassattribute="false"
         heightcompress="true"
         ExcludeLogicDeleted="false"
         HeaderFooterEditable="true"
         HeaderFooterReadonly="false"
         UseDCWriterMiniJS="false"
         serversleepfordebug="0"

         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="5"
         clientcontextmenutype="Custom"
         showdebuginfo="false"
         ismobiledevice="False"
         IndentHtmlCode="false"
         FreeSelection="true"
         urlencodecountforpostdata="0"
         AutoZoom="false"
         RegisterCodeIndex="0"
         ondocumentdblclick="MyDocumentDblClick"
         ToolbarForPrintPreview="btrPrintPreview"
         ButtonForUndo="btnUndo" ,
         ButtonForRedo="btnRedo"
         StatusUIElement="lblServerTime"
         fileprintautoclose="false"
         registercodeindex="0" />




    <script type="text/javascript">
        // HTML页面加载后执行本函数
        function BuildDCWriterControlFrame() {
            // 获得控件容器元素
            var ctl = document.getElementById("myWriterControl");
            // 绑定控件
            BindingDCWriterClientControl(ctl);
            
            // 创建编辑器框架
            ctl.BuildFrame(function () {
               
            });
        }
        BuildDCWriterControlFrame();


        function exp25_2() {
            var ctl = document.getElementById("myWriterControl");
            if (ctl != null) {
                var options = {
                    ID: "pie1",
                    Name: "pieName",
                    Width: 300,//注意这里给的是数字，单位是像素
                    Height: 300, //注意这里给的是数字，单位是像素
                    ShowLegend: "false",//是否显示图例
                    Thickness: 100,//饼图的厚度
                    PieDatas: [
                        {
                            Text: "aa",
                            Value: 10
                        },
                        {
                            Text: "bb",
                            Value: 20
                        },
                        {
                            Text: "cc",
                            Value: 40
                        }
                    ]
                };
                ctl.DCExecuteCommand("InsertPieElement", false, options);
            }
        }

        function exp25() {
            var ctl = document.getElementById("myWriterControl");
            if (ctl != null) {
                //为插入图表元素创建参数对象
                var options = new Object();
                //设置图表元素的ID，NAME，宽与高
                options.ID = "chart1";
                options.Name = "chartName";
                options.Width = 600;//注意这里给的是数字，单位是像素
                options.Height = 300; //注意这里给的是数字，单位是像素
                //设置图表元素的图表数据
                options.ChartDatas = new Object();
                options.ChartDatas.GridYSplitNum = 8;//设置纵向网格分割数
                options.ChartDatas.LegendVisible = false;//设置图例是否显示
                //设置内边距
                options.ChartDatas.PaddingBottom = 50;
                options.ChartDatas.PaddingLeft = 30;
                options.ChartDatas.PaddingRight = 30;
                options.ChartDatas.PaddingTop = 30;
                //设置图表类型
                options.ChartDatas.ViewStyle = "Line";

                //为图表元素添加Y轴
                options.ChartDatas.YAxises = new Array();//初始化Y轴列表
                //创建第一个Y轴
                var yaxis1 = new Object();
                yaxis1.Color = "#FF0000";//设置Y轴的颜色，从属该Y轴的数据点都使用这个颜色
                yaxis1.GridStep = 10;//设置Y轴坐标刻度的步长
                yaxis1.LeftSide = true;//设置Y轴刻度是否在数据轴左侧，为false则在右侧
                yaxis1.MaxValue = 100;//设置Y轴坐标刻度的最大值
                yaxis1.MinValue = 0;//设置Y轴坐标刻度的最小值
                yaxis1.Name = "Y轴名称1";//设置Y轴名称，从属该Y轴的数据点的序列名必须要指向该名称
                yaxis1.Visible = true;//设置Y轴刻度是否显示
                //创建第二个Y轴
                var yaxis2 = new Object();
                yaxis2.Color = "#00FFFF";//设置Y轴的颜色，从属该Y轴的数据点都使用这个颜色
                yaxis2.GridStep = 10;//设置Y轴坐标刻度的步长
                yaxis2.LeftSide = false;//设置Y轴刻度是否在数据轴左侧，为false则在右侧
                yaxis2.MaxValue = 50;//设置Y轴坐标刻度的最大值
                yaxis2.MinValue = 0;//设置Y轴坐标刻度的最小值
                yaxis2.Name = "Y轴名称2";//设置Y轴名称，从属该Y轴的数据点的序列名必须要指向该名称
                yaxis2.Visible = true;//设置Y轴刻度是否显示
                //添加Y轴到列表
                options.ChartDatas.YAxises.push(yaxis1);
                options.ChartDatas.YAxises.push(yaxis2);

                //为图表元素添加数据点
                options.ChartDatas.Values = new Array();//初始化图表元素数据集
                //为名称为"Y轴名称1"的Y轴添加数据点
                for (var i = 0; i < 5; i++) {
                    var value = new Object();
                    value.SeriesName = "Y轴名称1";//指定该数据点所属的Y轴
                    value.GroupName = "分组" + i.toString();//指定该数据点所属的X轴
                    value.SymbolType = "Diamond";//Bar类型无效，在Line类型里有效
                    value.Value = Math.random() * (100 - 0) + 0;//生成0到100之间的随机数
                    options.ChartDatas.Values.push(value);
                }
                //为名称为"Y轴名称2"的Y轴添加数据点
                for (var i = 0; i < 5; i++) {
                    var value = new Object();
                    value.SeriesName = "Y轴名称2";//指定该数据点所属的Y轴
                    value.GroupName = "分组" + i.toString();//指定该数据点所属的X轴
                    value.SymbolType = "Circle";//Bar类型无效，在Line类型里有效
                    value.Value = Math.random() * (50 - 0) + 0;//生成0到50之间的随机数
                    options.ChartDatas.Values.push(value);
                }

                //图表数据整备完毕，添加元素
                ctl.DCExecuteCommand("InsertChartElement", false, options);
            }
        }

        function exp26() {
            var ctl = document.getElementById("myWriterControl");
            if (ctl != null) {
                //为简单起见，这里只是改变一下图表的Y轴的显示全部到左侧
                var datas = ctl.GetChartElementDataByID("chart1");
                for (var i = 0; i < datas.YAxises.length; i++) {
                    var yaxis = datas.YAxises[i];
                    yaxis.LeftSide = true;
                }
                ctl.SetChartElementDataByID("chart1", datas);
            }
        }

        function exp27() {
            var ctl = document.getElementById("myWriterControl");
            if (ctl != null) {
                //为简单起见，这里只是改变一下图表的Y轴的显示全部到右侧
                var datas = ctl.GetChartElementDataByID("chart1");
                for (var i = 0; i < datas.YAxises.length; i++) {
                    var yaxis = datas.YAxises[i];
                    yaxis.LeftSide = false;
                }
                ctl.SetChartElementDataByID("chart1", datas);
            }
        }
    </script>
</body>
</html>