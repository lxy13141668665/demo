<!DOCTYPE html >
<html>
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <title>科大讯飞</title>
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <style>
        html, body {
            height: 100%;

        }
    </style>
</head>
<body style="overflow: hidden;">
    <input type="button" value="加载文档" onclick="document.WriterControl.LoadDocumentFromString(xmlstr,'xml');" />
    <input type="button" value="首次绑定表格数据" onclick="exp();" />
    <input type="button" value="更新表格数据" onclick="exp2();" />

    <div id="myWriterControl"
         style="width: 100%; height: 100%"
         contentrendermode="NormalHtmlEditable"
         workspacebackcolorstring="#F1F3F5"
         useclassattribute="true"
         FormView="Disabled"
         ClientContextMenuType="Custom"
         UseDCWriterMiniJS="false"
         TidyHtmlForEdit="true"
         TidyHtmlForPrint="true"
         UrlEncodeCountForPostData="0"
         LogUserEditTrack="false"
         heightcompress="true"
         backgroundtextoutputmode="None"
         imagedataembedinhtml="true"
         serversleepfordebug="0"
         ShowPageBorderLine="false"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="1"
         showdebuginfo="false"
         HeaderFooterEditable="true"
         registercodeindex="0"
         fileprintautoclose="false"
         servicepageurl="ServicePage.aspx">

    </div>
    <script type="text/javascript">

        // 获得控件容器元素
        var ctl = document.getElementById("myWriterControl");

        // 绑定控件
        BindingDCWriterClientControl(ctl);

        // 创建编辑器框架
        ctl.BuildFrame(function () {
            //ctl.LoadDocumentFromString(saveString, "xml");
            //menu()
        });



        function exp21(append) {
            var ctl = document.getElementById("myWriterControl");
            if (ctl != null) {
                ctl.GetContentContainer().focus();
                var file = new Array();

                //构造两个选项分别对应两个子文档
                var options = new Array();
                var attr1 = {
                    "Attributes": { "姓名": "张三", "科室": "胸外科", "床号": "12345" }, //自定义属性
                    //"NewPage": "false", //是否新起一页
                    //"ReadOnly": "false", //是否可编辑
                    "Title": "张三的病程记录", //病程收缩时显示的文档标题
                    "ToolTip": "提示：张三的病程记录", //病程鼠标移上去时的提示文本
                    "ID": "subdoc1",//
                    "TitleLevel": "0",//导航级别，从0到7的整数
                    "CSSStyle": "border: 3px solid #FF0000; background-color: #FFFF00;", //自定义的样式
                    "Parameters": { "emr.DE02.01.052.00": "汪汪汪", "fieldMedic": "王二麻子" },//绑定的数据格式
                    //"DataBindingXML": "<DataSourceName><Name>张三</Name></DataSourceName><DataSourceName2><Name>李四</Name></DataSourceName2>",
                    "LoadOriginHeaderFooter": "false"
                };
                var attr2 = {
                    "Attributes": { "姓名": "李四", "科室": "太平间", "床号": "45678" }, //自定义属性
                    //"NewPage": "true", //是否新起一页
                    //"ReadOnly": "true", //是否可编辑
                    "Title": "李四的病程记录", //文档标题
                    "ToolTip": "提示：李四的病程记录", //文档标题
                    "ID": "subdoc2",//
                    "TitleLevel": "0",//导航级别，从0到7的整数
                    "CSSStyle": "border: 1px solid #0000FF; background-color: #FFF0F5;", //自定义的样式
                    "Parameters": { "emr.DE02.01.052.00": "喵喵喵", "fieldMedic": "刘三姐" }, //绑定的数据格式
                    //"DataBindingXML": "<DataSourceName><Name>李四</Name></DataSourceName>",
                    "LoadOriginHeaderFooter": "false"
                };
                options.push(attr1);
                options.push(attr2);
                var options = {
                    Files: file,
                    Options: options,
                    Usebase64: "false",
                    ShowMaskUI: "true"
                };

                ctl.AppendSubDocuments(options);
            }
        }


        var xmlstr = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XTextTable" NumOfRows="2" NumOfColumns="4">
               <InnerID>11</InnerID>
               <ID>table1</ID>
               <XElements>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>16</InnerID>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>17</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>43</InnerID>
                                 <Text>姓名</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>18</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>19</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>44</InnerID>
                                 <Text>性别</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>20</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>21</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>45</InnerID>
                                 <Text>年龄</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>22</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>23</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>46</InnerID>
                                 <Text>地址</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>24</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                     <HeaderStyle>true</HeaderStyle>
                  </Element>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>25</InnerID>
                     <ValueBinding>
                        <DataSource>peopledatasource</DataSource>
                     </ValueBinding>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>26</InnerID>
                           <ValueBinding>
                              <BindingPath>name</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>27</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>28</InnerID>
                           <ValueBinding>
                              <BindingPath>sex</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>29</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>30</InnerID>
                           <ValueBinding>
                              <BindingPath>age</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>31</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>32</InnerID>
                           <ValueBinding>
                              <BindingPath>address</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>33</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                  </Element>
               </XElements>
               <Columns>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>12</InnerID>
                     <Width>468.6875</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>13</InnerID>
                     <Width>468.6875</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>14</InnerID>
                     <Width>468.6875</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>15</InnerID>
                     <Width>468.6875</Width>
                  </Element>
               </Columns>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileName>C:\Users\DCSOFTWU\Desktop\数据源绑定B端测试文档.xml</FileName>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
         <Style Index="1">
            <FontSize>12</FontSize>
            <BorderWidth>1</BorderWidth>
            <BorderLeft>true</BorderLeft>
            <BorderBottom>true</BorderBottom>
            <BorderTop>true</BorderTop>
            <BorderRight>true</BorderRight>
            <PaddingLeft>15</PaddingLeft>
            <PaddingTop>10</PaddingTop>
            <PaddingRight>15</PaddingRight>
            <PaddingBottom>10</PaddingBottom>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌信息科技有限公司:南京都昌信息科技有限公司内测码</LicenseText>
      <CreationTime>2022-06-15T17:39:35.1111124+08:00</CreationTime>
      <LastModifiedTime>2022-06-15T17:43:35.7227056+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>姓名 性别 年龄 地址
        </BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;


    </script>

</body>
</html>