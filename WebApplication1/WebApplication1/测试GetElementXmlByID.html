<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <title></title>
</head>
<body>
    <div>
        <input type="button" value="获取文档中的表格元素的XML并保存" onclick="exp();" />
        <input type="button" value="插入保存的表格到当前位置" onclick="exp2();" />
        <input type="button" value="保存后加载" onclick="document.WriterControl.LoadSave();" />
    </div>
    <div id="myWriterControl" style="width: 100%; border: 2px solid black; border-radius: 5px;height:900px;"
         LocalServerPort="2345"
         TransformUseBase64="false"
         FieldBorderPrintVisibility="None"
         FormView="Disabled"
         ReadOnly="false"
         PreviewUseAdvancedLayout="false"
         BackgroundTextOutputMode="Underline"
         contentrendermode="NormalHTMLEditable"
         AutoSaveIntervalInSecond="0"
         workspacebackcolorstring="#B1CAEB"
         servicepageurl="ServicePage.aspx"
         useclassattribute="false"
         heightcompress="true"
         imagedataembedinhtml="true"
         ExcludeLogicDeleted="false"
         HeaderFooterEditable="true"
         UseDCWriterMiniJS="false"
         serversleepfordebug="0"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="5"
         clientcontextmenutype="Custom"
         showdebuginfo="false"
         ismobiledevice="False"
         IndentHtmlCode="false"
         FreeSelection="true"
         urlencodecountforpostdata="0"
         AutoZoom="false"
         registercodeindex="0" />


    <script type="text/javascript">
        // HTML页面加载后执行本函数
        function BuildDCWriterControlFrame() {
            // 获得控件容器元素
            var ctl = document.getElementById("myWriterControl");
            // 绑定控件
            BindingDCWriterClientControl(ctl);

            // 创建编辑器框架
            ctl.BuildFrame(function () {
                ctl.LoadDocumentFromString(xmlforload, "xml");
            });
        }
        BuildDCWriterControlFrame();

        var xmlforinsert = null;

        function exp() {
            var ctl = document.WriterControl;
            var doc = ctl.GetContentDocument();
            var win = ctl.GetContentWindow();
            var table = doc.getElementById("table1");
            debugger;
            xmlforinsert = ctl.GetElementXmlByID(table);
        }

        function exp2() {
            var ctl = document.WriterControl;
            if (xmlforinsert != null) {
                ctl.InsertXmlString(xmlforinsert);
            }
        }

        var xmlforload = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>64</InnerID>
               <Text>adfasfdasfsdaf</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>25</InnerID>
            </Element>
            <Element xsi:type="XTextTable" NumOfRows="3" NumOfColumns="3">
               <InnerID>27</InnerID>
               <ID>table1</ID>
               <XElements>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>31</InnerID>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>32</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>33</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>34</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>35</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>36</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>37</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                  </Element>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>38</InnerID>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>39</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>40</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>41</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>42</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>43</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>44</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                  </Element>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>45</InnerID>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>46</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>47</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>48</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>49</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>50</InnerID>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>51</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                  </Element>
               </XElements>
               <Columns>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>28</InnerID>
                     <Width>624.9167</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>29</InnerID>
                     <Width>624.9167</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>30</InnerID>
                     <Width>624.9167</Width>
                  </Element>
               </Columns>
            </Element>
            <Element xsi:type="XString">
               <InnerID>65</InnerID>
               <Text>asfsdfasdfsd</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
         <Style Index="1">
            <FontSize>12</FontSize>
            <BorderWidth>1</BorderWidth>
            <BorderLeft>true</BorderLeft>
            <BorderBottom>true</BorderBottom>
            <BorderTop>true</BorderTop>
            <BorderRight>true</BorderRight>
            <PaddingLeft>15</PaddingLeft>
            <PaddingTop>10</PaddingTop>
            <PaddingRight>15</PaddingRight>
            <PaddingBottom>10</PaddingBottom>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
      <CreationTime>2023-03-28T15:07:49.417431+08:00</CreationTime>
      <LastModifiedTime>2023-03-28T15:14:31.8167811+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>adfasfdasfsdaf



      asfsdfasdfsd</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;
    </script>
</body>
</html>