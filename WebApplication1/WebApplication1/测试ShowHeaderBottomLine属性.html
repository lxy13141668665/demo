<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
     <script type="text/javascript" src="jquery-1.7.2.min.js"></script> 
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <title></title>
</head>
<body>
    <div>
        <input type="button" value="加载原文档" onclick="document.WriterControl.LoadDocumentFromString(xmlforload,'xml');" />
        <input type="button" value="保存当前文档" onclick="xmlforsave = document.WriterControl.SaveDocumentToString();" />
        <input type="button" value="加载保存的文档" onclick="document.WriterControl.LoadDocumentFromString(xmlforsave,'xml');" />
        <input type="button" value="刷新当前" onclick="document.WriterControl.LoadSave();" />
    </div>
    <div>
        <input type="button" value="全局文档选项显示页眉下边线" onclick="exp3(true);" />
        <input type="button" value="全局文档选项不显示页眉下边线" onclick="exp3(false);" />
    </div>
    <div>
        <input type="button" value="当前文档显示页眉下边线" onclick="exp2('True');" />
        <input type="button" value="当前文档不显示页眉下边线" onclick="exp2('False');" />
        <input type="button" value="当前文档页眉下边线继承全局选项" onclick="exp2('Inherit');" />
    </div>
    <div>
        <input type="button" value="打印预览" onclick="document.WriterControl.LoadPrintPreview();" />
        <input type="button" value="关闭预览" onclick="document.WriterControl.ClosePrintPreview();" />
    </div>

    <div id="myWriterControl" style="width: 100%; border: 2px solid black; border-radius: 5px;height:900px;"
         LocalServerPort="2345"
         TransformUseBase64="false"
         FieldBorderPrintVisibility="None"
         FormView="Disable"
         ReadOnly="false"
         PreviewUseAdvancedLayout="false"
         BackgroundTextOutputMode="Underline"
         contentrendermode="NormalHTMLEditable"
         AutoSaveIntervalInSecond="0"
         workspacebackcolorstring="#B1CAEB"
         servicepageurl="ServicePage.aspx"
         useclassattribute="false"
         heightcompress="true"
         imagedataembedinhtml="true"
         ExcludeLogicDeleted="false"
         HeaderFooterEditable="true"
         UseDCWriterMiniJS="false"
         serversleepfordebug="0"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="5"
         clientcontextmenutype="Custom"
         showdebuginfo="false"
         ismobiledevice="False"
         IndentHtmlCode="false"
         FreeSelection="true"
         urlencodecountforpostdata="0"
         AutoZoom="false"
         registercodeindex="0" />


    <script type="text/javascript">
        // HTML页面加载后执行本函数
        function BuildDCWriterControlFrame() {
            // 获得控件容器元素
            var ctl = document.getElementById("myWriterControl");
            // 绑定控件
            BindingDCWriterClientControl(ctl);
            // 创建编辑器框架
            ctl.BuildFrame(function () {
                ctl.LoadDocumentFromString(xmlforload, "xml");
            });
        }
        BuildDCWriterControlFrame();

        function exp() {
            var ctl = document.WriterControl;

        }

        function exp2(str) {
            var ctl = document.WriterControl;
            var options = {
                ShowHeaderBottomLine: str
            };
            ctl.SetDocumentInfos(options);
        }

        function exp3(parameter) {
            var ctl = document.WriterControl;
            ctl.DocumentOptions.ViewOptions.ShowHeaderBottomLine = parameter;
            ctl.ApplyDocumentOptions();
        }

        var xmlforsave = ``;
        var xmlforload = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
               <XElements>
                  <Element xsi:type="XTextHeader">
                     <InnerID>1</InnerID>
                     <AcceptTab>true</AcceptTab>
                     <XElements>
                        <Element xsi:type="XString" StyleIndex="0">
                           <InnerID>33</InnerID>
                           <Text>测试文档的页眉</Text>
                        </Element>
                        <Element xsi:type="XParagraphFlag" StyleIndex="0">
                           <InnerID>6</InnerID>
                           <AutoCreate>true</AutoCreate>
                        </Element>
                     </XElements>
                  </Element>
                  <Element xsi:type="XTextBody">
                     <InnerID>2</InnerID>
                     <AcceptTab>true</AcceptTab>
                     <XElements>
                        <Element xsi:type="XString">
                           <InnerID>34</InnerID>
                           <Text>测试文档的文档体</Text>
                        </Element>
                        <Element xsi:type="XParagraphFlag">
                           <InnerID>7</InnerID>
                           <AutoCreate>true</AutoCreate>
                        </Element>
                     </XElements>
                  </Element>
                  <Element xsi:type="XTextFooter">
                     <InnerID>3</InnerID>
                     <AcceptTab>true</AcceptTab>
                     <XElements>
                        <Element xsi:type="XParagraphFlag">
                           <InnerID>8</InnerID>
                           <AutoCreate>true</AutoCreate>
                        </Element>
                     </XElements>
                  </Element>
               </XElements>
               <ContentStyles>
                  <Default xsi:type="DocumentContentStyle">
                     <FontSize>12</FontSize>
                  </Default>
                  <Styles>
                     <Style Index="0">
                        <FontSize>12</FontSize>
                        <Align>Center</Align>
                     </Style>
                  </Styles>
               </ContentStyles>
               <Info>
                  <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
                  <CreationTime>2023-04-20T16:08:30.4924374+08:00</CreationTime>
                  <LastModifiedTime>2023-04-20T16:09:08.4287038+08:00</LastModifiedTime>
                  <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
                  <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
                  <NumOfPage>1</NumOfPage>
               </Info>
               <BodyText>测试文档的文档体</BodyText>
               <LocalConfig />
               <PageSettings>
                  <StrictUsePageSize>false</StrictUsePageSize>
               </PageSettings>
</XTextDocument>`;

    </script>
</body>
</html>