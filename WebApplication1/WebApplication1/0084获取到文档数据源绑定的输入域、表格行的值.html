<!DOCTYPE html>
<html>

<head>
    <script type="text/javascript" src="http://www.dcwriter.cn:6788/static/js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <meta charset="utf-8" />
    <title></title>
    <style>
        html {
            height: 100%;
        }

        body {
            height: calc(100% - 37px);
        }
    </style>
</head>

<body>
    <input type="button" value="加载文档" onclick="exp();" />
    <input type="button" value="表格数据源绑定" onclick="dcdatabinding();" />
    <input type="button" value="输入域数据源绑定" onclick="dcdatabinding1();" />
    <button onclick="GetFn()">获取到文档数据源绑定的表格行的值</button>
    <button onclick="GetFn1()">获取到文档数据源绑定的表格行的值</button>
    <div id="myWriterControl" style="width: 100%; border: 2px solid black; border-radius: 5px;height:100%;"
        ContentRenderMode="NormalHtmlEditable" workspacebackcolorstring="#DEDEDE"
        servicepageurl="ServicePage.aspx" useclassattribute="true" heightcompress="true"
        backgroundtextoutputmode="None" imagedataembedinhtml="true" HeaderFooterEditable="true" pixelpagespacing="5"
        clientcontextmenutype="Custom" usedcwriterminijs="True" showdebuginfo="false" registercodeindex="0"
        AutoSaveIntervalInSecond="1000" ctl.DocumentOptions.BehaviorOptions.AcceptDataFormats="Text" ;>
    </div>
    <script type="text/javascript">

        function dcdatabinding() {
            let obj1 = {
                name: "张三",
                sex: "男",
                age: "22",
                address: "上海路",
                sign: "data:image/png;base64,Qk3gDAAAAAAAAD4AAAAoAAAAxgAAAHMAAAABAAEAAAAAAJQMAAATCwAAEwsAAAAAAAAAAAAAAAAAAP///wD////////////////////////////////8AAAA/////////////////////////////////AAAAP////////////////////////////////wAAAD///////8f///////////////////////8AAAA///////+H///////////////////7////AAAAP///////g///////////////////+P///wAAAD///////wP///////////////////h///8AAAA///////8D///////////////////8P///AAAAP///////A////////////////////B///wAAAD///////wP///////////////////4P//8AAAA///////8D////////////////////B///AAAAP///////A////////////////////wP//wAAAD///////wP///////////////////+D//8AAAA///////8B////////////////////gf//AAAAP///////Af///////////////////8D//wAAAD///////4H////////////////////gf/8AAAA///////+B////////////////////4D//AAAAP///////gf////////////////////Af/wAAAD3//////4H////////////////////wH/8AAAA8H/////+B////////////////////+A//AAAAOAf/////gf////////////////////wH/wAAADgB/////4H////////////////////8A/8AAAA4AP////+A/////////////////////gH/AAAAOAAf////wP////////////////////8B/wAAADwAA////8D/////////////////////AP8AAAA+AAD////A/////////////////////4B/AAAAP8AAf///wP/////////////////////APwAAAD/gAB///8D/////////////////////wB8AAAA/8AAD///A/////////////////////+AfAAAAP/gAAP//wP/////////////////////wHwAAAD/+AAAf/8D/////////////////////8A8AAAA//wAAB//A//////////////////////gHAAAAP/+AAAD/wH/////////////////////4BwAAAD//4AAAH8B/////////////////////+AcAAAA///AAAAfgf/////////////////////wHAAAAP//8AAAB4H/////////////////////8AwAAAD///gGAAAB//////////////////////AMAAAA///+A8AAAf/////////////////////wDAAAAP///wHwAAH/////////////////////4BwAAAD///+A/AAAf////////////////////+AcAAAA////4H8AAB/////////////////////gHAAAAP////Af4AAD////////////////////4BwAAAD////8B/gAAH///////////////////8A8AAAA/////AP/AAAP///////////////////APAAAAP////8B/8AAAf/////////////7////wDwAAAD/////wP/AAAAf////////////4H///4B8AAAA/////+A/wAAAD////////8P//8Af//+AfAAAAP/////wH+BgAAH///////+A///gB///gHwAAAD//////A/gfAAA////////gH//4AP//4D8AAAA//////4H4H/AAP///////wA///gA//+A/AAAAP////7/A+B/8AD///////4AH//+AH//APwAAAD////8P4Dgf/8Af//////8AB///4A//wD8AAAA/////B/AcH//4P//////+AAP///AH/8A/AAAAP////wf4DA//+D///////gAB///8Af/APwAAAD////8H/AAP//h///////wBAH///gD/wD8AAAA/////B/8AD//4///////8AYA///8AP8A/AAAAP////gP/gA//+P//////+APAH///gAAAPwAAAD////4D/8AP//H///////gH4A///8AAAD8AAAA////+AfhwB//////////wD/gH///wAAB/AAAAP////gH4GAf/////B///8A/8B///+AAAfwAAAD////4A+AAH/////wD//+Af/gP///gAAf8AAAA////+APwAA/////4Af//gP/8B///8AAf/AAAAP////gB+AAP////+AD//4D//gH///gB//wAAAD////4APwAD/////gAf/+A//8B///8A//8AAAA////+CD+AA/////wAD//gf//gH///AH//AAAAP////gwf4AP////8AA//4H//8A///gB//wAAAD////4OD/wD/////A4H/+B///gH//4Af/8AAAA////+Dwf/Af////wPA//gP//8A//+AP//AAAAP////wcD/4D////+D4H/4D///gH//gD//wAAAD////8Hgf+AP////g/A//Af//+A//8A//8AAAA/////B8D/gB////4P4H/wH///wH//gH//AAAAP////4/gf4AH///+D/B/+A///+Af/8A//wAAAD//////8D+AA////g/4P/gH///wD//gH/8AAAA///////gPgAH///4P/B/4B////Af/8A//AAAAP//////8B8GA///+D/wP8AP///4D//AP/wAAAD///////gPDwH///gf+B8AD////AP/4D/8AAAA///////8A/8B///4H/wfAA////8B//Af/AAAAP///////gA8AP//+B/+DgAP////gH/wH/wAAAD///////+AAAD///gf/wYAH////8AH+A/8AAAA////////gAAB///4H/8GA//////wAfgH/AAAAP///////8AAA///+D//gAf/////+AAAB/wAAAD////////kAB////g//8AH//////4AAAf8AAAA////////58H////8f//gB///////AAAD/AAAAP////////D/////////8Af//////4AAB/wAAAD////////wf/////////AD///////AAA/8AAAA////////wB/////////4A///////+AB//AAAAP///////8Yf/////////AH///////////wAAAD///////+HD/////////4B///////////8AAAA////////j4//////////Af///////////AAAAP///////8/D/////////4D///////////wAAAD////////Hwf/////////A///////////8AAAA////////x/H/////////4f///////////AAAAP///////8f4//////////////////////wAAAD////////H/H/////////////////////8AAAA////////5/4//////////////////////AAAAP///////+P+H/////////////////////wAAAD////////j/x/////////////////////8AAAA////////4/+P/////////////////////AAAAP///////+P/x/////////////////////wAAAD////////j/8f////////////////////8AAAA////////4//j/////////////////////AAAAP///////+P/4/////////////////////wAAAD////////z//H////////////////////8AAAA////////8f/w/////////////////////AAAAP////////H/+P////////////////////wAAAD////////x//h////////////////////8AAAA////////8f/8P////////////////////AAAAP////////H//D////////////////////wAAAD////////w//w////////////////////8AAAA////////+P/8P////////////////////AAAAP////////j/+D////////////////////wAAAD////////4//g////////////////////8AAAA/////////f/4f////////////////////AAAAP///////////P////////////////////wAAAD////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAA="
            };
            arr = new Array();
            arr.push(obj1);
            ctl = document.getElementById("myWriterControl")
            ctl.SetDocumentParameterValue("peopledatasource", arr)
            ctl.WriteDataFromDataSourceToDocument();


        }
        function dcdatabinding1() {
            var values = {
                Name: "李小四",
            };
            var ctl = document.getElementById("myWriterControl");
            ctl.SetDocumentParameterValue("EMR_Patients", values);
            var result = ctl.WriteDataFromDataSourceToDocument();
        }
        var data = `<XTextDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" EditorVersionString="1.2022.9.1">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>6</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>7</InnerID>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>8</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XTextTable" NumOfRows="2" NumOfColumns="5">
               <InnerID>9</InnerID>
               <ID>table1</ID>
               <XElements>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>10</InnerID>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>11</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>154</InnerID>
                                 <Text>姓名</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>13</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>14</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>155</InnerID>
                                 <Text>性别</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>16</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>17</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>156</InnerID>
                                 <Text>年龄</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>19</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>20</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>157</InnerID>
                                 <Text>地址</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>22</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>23</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>158</InnerID>
                                 <Text>签名</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>25</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                     <HeaderStyle>true</HeaderStyle>
                  </Element>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>26</InnerID>
                     <ValueBinding>
                        <DataSource>peopledatasource</DataSource>
                     </ValueBinding>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>27</InnerID>
                           <ValueBinding>
                              <BindingPath>name</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>28</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>29</InnerID>
                           <ValueBinding>
                              <BindingPath>sex</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>30</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>31</InnerID>
                           <ValueBinding>
                              <BindingPath>age</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>32</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>33</InnerID>
                           <ValueBinding>
                              <BindingPath>address</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>34</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>35</InnerID>
                           <ValueBinding>
                              <BindingPath>sign</BindingPath>
                           </ValueBinding>
                           <XElements>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>36</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                  </Element>
               </XElements>
               <Columns>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>37</InnerID>
                     <Width>249.950012</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>38</InnerID>
                     <Width>268.95</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>39</InnerID>
                     <Width>280.949951</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>40</InnerID>
                     <Width>383.950073</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>41</InnerID>
                     <Width>690.9501</Width>
                  </Element>
               </Columns>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>62</InnerID>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>63</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>153</InnerID>
               <Text>姓名:</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>69</InnerID>
               <ID>field1</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <ValueBinding>
                  <DataSource>EMR_Patients</DataSource>
                  <BindingPath>Name</BindingPath>
               </ValueBinding>
               <BorderElementColor />
               <BackgroundText>姓名</BackgroundText>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>42</InnerID>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>43</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>44</InnerID>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileName>C:\Users\admin\Desktop\新建文本文档.xml</FileName>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
         <Style Index="1">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <BorderWidth>1</BorderWidth>
            <BorderLeft>true</BorderLeft>
            <BorderBottom>true</BorderBottom>
            <BorderTop>true</BorderTop>
            <BorderRight>true</BorderRight>
            <PaddingLeft>15</PaddingLeft>
            <PaddingTop>10</PaddingTop>
            <PaddingRight>15</PaddingRight>
            <PaddingBottom>10</PaddingBottom>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌信息科技有限公司:南京都昌信息科技有限公司内测版</LicenseText>
      <CreationTime>2022-07-06T10:34:58.2354245+08:00</CreationTime>
      <LastModifiedTime>2022-11-28T11:39:47.7343647+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>姓名 性别 年龄 地址 签名 
          

姓名:</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`
        function exp() {
            var ctl = document.WriterControl;
            ctl.LoadDocumentFromString(data, "xml");
        }
        var ctl = document.getElementById("myWriterControl");
        // 绑定控件

        BindingDCWriterClientControl(ctl);
        ctl.DocumentOptions.ViewOptions.ShowHeaderBottomLine = true;
        // 创建编辑器框架
        ctl.BuildFrame(function () { //创建编辑器框架
            if (ctl.Options.ContentRenderMode == "PagePreviewHtml") {
                // 打印页面模式，则鼠标拖拽滚动.
                ctl.setMouseDragScrollMode(true);
            }
            else {
                // 不启用鼠标拖拽滚动。
                ctl.setMouseDragScrollMode(false);
            }
            // AjaxLoad('File/入院记录（中医科）.xml');
            //IsPrint();
        });

        function GetFn() {
            var json1 = ctl.GetDocumentParameterValue('peopledatasource', true)
            console.log(json1);
        }
        function GetFn1() {
            var json2 = ctl.GetDocumentParameterValue('EMR_Patients', true)
            console.log(json2);
        }
    </script>
</body>

</html>