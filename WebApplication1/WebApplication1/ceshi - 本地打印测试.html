<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <title></title>
</head>
<body>
    <div>
        <input type="button" value="打印背景文字且保留背景文字位置" onclick="exp11();" />
        <input type="button" value="打印背景文字且不保留背景文字位置" onclick="exp10();" />
        <input type="button" value="不打印背景文字且保留背景文字位置" onclick="exp01();" />
        <input type="button" value="不打印背景文字且不保留背景文字位置" onclick="exp00();" />
    </div>
    <div>
        <input type="button" value="本地打印" onclick="document.WriterControl.LocalPrintDocument();" />
    </div>

    <div id="myWriterControl" style="width: 100%; border: 2px solid black; border-radius: 5px;height:900px;"
         LocalServerPort="2345"
         TransformUseBase64="false"
         FieldBorderPrintVisibility="None"
         FormView="Disable"
         ReadOnly="false"
         PreviewUseAdvancedLayout="false"
         BackgroundTextOutputMode="None"
         contentrendermode="NormalHTMLEditable"
         AutoSaveIntervalInSecond="0"
         workspacebackcolorstring="#B1CAEB"
         servicepageurl="ServicePage.aspx"
         useclassattribute="false"
         heightcompress="true"
         imagedataembedinhtml="true"
         ExcludeLogicDeleted="false"
         HeaderFooterEditable="true"
         HeaderFooterReadonly="true"
         UseDCWriterMiniJS="true"
         serversleepfordebug="0"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="5"
         clientcontextmenutype="Custom"
         showdebuginfo="false"
         ismobiledevice="False"
         IndentHtmlCode="false"
         FreeSelection="true"
         urlencodecountforpostdata="0"
         AutoZoom="false"
         registercodeindex="0" />


    <script type="text/javascript">
        // HTML页面加载后执行本函数
        function BuildDCWriterControlFrame() {
            // 获得控件容器元素
            var ctl = document.getElementById("myWriterControl");
            // 绑定控件
            BindingDCWriterClientControl(ctl);

            //ctl.Options.HeaderFooterReadonly = "true";

            // 创建编辑器框架
            ctl.BuildFrame(function () {
                ctl.LoadDocumentFromString(loadxml, "xml");
            });


        }
        BuildDCWriterControlFrame();

        function exp11() {
            var ctl = document.WriterControl;
            ctl.DocumentOptions.ViewOptions.PrintBackgroundText = true;
            ctl.DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint = true;
            ctl.ApplyDocumentOptions();
        }
        function exp10() {
            var ctl = document.WriterControl;
            ctl.DocumentOptions.ViewOptions.PrintBackgroundText = true;
            ctl.DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint = false;
            ctl.ApplyDocumentOptions();
        }
        function exp01() {
            var ctl = document.WriterControl;
            ctl.DocumentOptions.ViewOptions.PrintBackgroundText = false;
            ctl.DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint = true;
            ctl.ApplyDocumentOptions();
        }
        function exp00() {
            var ctl = document.WriterControl;
            ctl.DocumentOptions.ViewOptions.PrintBackgroundText = false;
            ctl.DocumentOptions.ViewOptions.PreserveBackgroundTextWhenPrint = false;
            ctl.ApplyDocumentOptions();
        }



        var loadxml = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>53</InnerID>
               <Text>PrintBackgroundText属性</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>11</InnerID>
               <ID>field1</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <BorderElementColor />
               <BackgroundTextColor>#40E0D0</BackgroundTextColor>
               <BackgroundText>背景文字</BackgroundText>
            </Element>
            <Element xsi:type="XString">
               <InnerID>54</InnerID>
               <Text>设置为Inherit</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>73</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>55</InnerID>
               <Text>PrintBackgroundText属性</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>11</InnerID>
               <ID>field2</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <BorderElementColor />
               <BackgroundTextColor>#40E0D0</BackgroundTextColor>
               <PrintBackgroundText>True</PrintBackgroundText>
               <BackgroundText>背景文字</BackgroundText>
            </Element>
            <Element xsi:type="XString">
               <InnerID>56</InnerID>
               <Text>设置为True</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>56</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>57</InnerID>
               <Text>PrintBackgroundText属性</Text>
            </Element>
            <Element xsi:type="XInputField">
               <InnerID>11</InnerID>
               <ID>field3</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <BorderElementColor />
               <BackgroundTextColor>#40E0D0</BackgroundTextColor>
               <PrintBackgroundText>False</PrintBackgroundText>
               <BackgroundText>背景文字</BackgroundText>
            </Element>
            <Element xsi:type="XString">
               <InnerID>58</InnerID>
               <Text>设置为False</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>67</InnerID>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>68</InnerID>
            </Element>
            <Element xsi:type="XString" StyleIndex="1">
               <InnerID>59</InnerID>
               <Text>ViewOptions.PrintBackgroundText=false时，</Text>
            </Element>
            <Element xsi:type="XString">
               <InnerID>60</InnerID>
               <Text>PrintBackgroundText属性为True的域没有打印出颜色</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
         <Style Index="1">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
      <CreationTime>2023-05-29T09:51:22.0359856+08:00</CreationTime>
      <LastModifiedTime>2023-05-29T10:01:22.9046203+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>PrintBackgroundText属性设置为Inherit
PrintBackgroundText属性设置为True
PrintBackgroundText属性设置为False

ViewOptions.PrintBackgroundText=false时，PrintBackgroundText属性为True的域没有打印出颜色</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;
    </script>
</body>
</html>