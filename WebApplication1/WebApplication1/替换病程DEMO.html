<!DOCTYPE html >
<html>
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <title>科大讯飞</title>
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <style>
        html, body {
            height: 100%;

        }
    </style>
</head>
<body style="overflow: hidden;">
    <input type="button" value="插入病程" onclick="exp();" />
    <input type="button" value="替换第一个病程" onclick="exp2();" />
    <input type="button" value="替换第二个病程" onclick="exp3();" />

    <div id="myWriterControl"
         style="width: 100%; height: 100%"
         contentrendermode="NormalHtmlEditable"
         workspacebackcolorstring="#F1F3F5"
         useclassattribute="true"
         FormView="Disabled"
         ClientContextMenuType="Custom"
         UseDCWriterMiniJS="false"
         TidyHtmlForEdit="true"
         TidyHtmlForPrint="true"
         UrlEncodeCountForPostData="0"
         LogUserEditTrack="false"
         heightcompress="true"
         backgroundtextoutputmode="None"
         imagedataembedinhtml="true"
         serversleepfordebug="0"
         ShowPageBorderLine="false"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="1"
         showdebuginfo="false"
         HeaderFooterEditable="true"
         registercodeindex="0"
         fileprintautoclose="false"
         servicepageurl="ServicePage.aspx">

    </div>
    <script type="text/javascript">

        // 获得控件容器元素
        var ctl = document.getElementById("myWriterControl");

        // 绑定控件
        BindingDCWriterClientControl(ctl);

        // 创建编辑器框架
        ctl.BuildFrame(function () {
            //ctl.LoadDocumentFromString(saveString, "xml");
            //menu()
        });



        function exp() {
            var ctl = document.WriterControl;
            ctl.GetContentContainer().focus();
            var file = new Array();
            //获取一个文档字符串用来反复加载subdoc
            file.push(xmlstr);
            file.push(xmlstr);

            //构造两个选项分别对应两个子文档
            var options = new Array();
            var attr1 = {
                "Attributes": { "姓名": "张三", "科室": "胸外科", "床号": "12345" }, //自定义属性
                //"NewPage": "false", //是否新起一页
                //"ReadOnly": "false", //是否可编辑
                "Title": "张三的病程记录", //病程收缩时显示的文档标题
                "ToolTip": "提示：张三的病程记录", //病程鼠标移上去时的提示文本
                "ID": "subdoc1",//
                "TitleLevel": "0",//导航级别，从0到7的整数
                "CSSStyle": "border: 3px solid #FF0000; background-color: #FFFF00;", //自定义的样式
                "Parameters": { "emr.DE02.01.052.00": "汪汪汪", "fieldMedic": "王二麻子" },//绑定的数据格式
                //"DataBindingXML": "<DataSourceName><Name>张三</Name></DataSourceName><DataSourceName2><Name>李四</Name></DataSourceName2>",
                "LoadOriginHeaderFooter": "false"
            };
            var attr2 = {
                "Attributes": { "姓名": "李四", "科室": "太平间", "床号": "45678" }, //自定义属性
                //"NewPage": "true", //是否新起一页
                //"ReadOnly": "true", //是否可编辑
                "Title": "李四的病程记录", //文档标题
                "ToolTip": "提示：李四的病程记录", //文档标题
                "ID": "subdoc2",//
                "TitleLevel": "0",//导航级别，从0到7的整数
                "CSSStyle": "border: 1px solid #0000FF; background-color: #FFF0F5;", //自定义的样式
                //"Parameters": { "emr.DE02.01.052.00": "喵喵喵", "fieldMedic": "刘三姐" }, //绑定的数据格式
                //"DataBindingXML": "<DataSourceName><Name>李四</Name></DataSourceName>",
                "LoadOriginHeaderFooter": "false"
            };
            options.push(attr1);
            options.push(attr2);
            var options = {
                Files: file,
                Options: options,
                Usebase64: "false",
                ShowMaskUI: "true"
            };
            ctl.InsertSubDocuments(options);
        }

        function exp2() {
            var ctl = document.WriterControl;
            var options = {
                ID: "subdoc1",  //被替换的病程ID
                FileContentXML: xmlstrforreplace  //新的的病程xml文档
            }
            ctl.LoadSubDocumentFromString(options);//用于单独加载子文档
        }

        function exp3() {
            var ctl = document.WriterControl;
            var options = {
                ID: "subdoc2",  //被替换的病程ID
                FileContentXML: xmlstrforreplace  //新的的病程xml文档
            }
            ctl.LoadSubDocumentFromString(options);//用于单独加载子文档
        }


        var xmlstr = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XInputField">
               <InnerID>11</InnerID>
               <ID>field1</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <XElements>
                  <Element xsi:type="XString">
                     <InnerID>30</InnerID>
                     <Text>abfg</Text>
                  </Element>
               </XElements>
               <BorderElementColor />
               <SpecifyWidth>590.5512</SpecifyWidth>
               <InnerValue>abfg</InnerValue>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>62</InnerID>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>64</InnerID>
            </Element>
            <Element xsi:type="XString">
               <InnerID>28</InnerID>
               <Text>c</Text>
            </Element>
            <Element xsi:type="XInputField">
               <Attributes>
                  <Attribute>
                     <Name>AAAA</Name>
                     <Value>BBBB</Value>
                  </Attribute>
                  <Attribute>
                     <Name>CCCC</Name>
                     <Value>DDDD</Value>
                  </Attribute>
                  <Attribute>
                     <Name>EEEE</Name>
                     <Value>FFFF</Value>
                  </Attribute>
               </Attributes>
               <InnerID>21</InnerID>
               <ID>field2</ID>
               <EnableValueValidate>true</EnableValueValidate>
               <BorderElementColor />
               <SpecifyWidth>236.220474</SpecifyWidth>
               <BackgroundText>自定义域</BackgroundText>
            </Element>
            <Element xsi:type="XString">
               <InnerID>29</InnerID>
               <Text>de</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileName>C:\Users\DCSOFTWU\Desktop\自定义属性2.xml</FileName>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌信息科技有限公司:南京都昌信息科技有限公司内测版</LicenseText>
      <CreationTime>2022-06-28T11:09:56.2623166+08:00</CreationTime>
      <LastModifiedTime>2022-06-28T11:30:20.0798071+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>abfg

cde</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;

        var xmlstrforreplace = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>4629</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>4635</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>4630</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>42</InnerID>
               <Text>asdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsd</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4634</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>4631</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>4636</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌信息科技有限公司:南京都昌信息科技有限公司内测版</LicenseText>
      <CreationTime>1980-01-01T00:00:00</CreationTime>
      <LastModifiedTime>2022-07-14T13:43:49.4791272+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>asdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsdasdfasdfasdfasdfasdfasfsd</BodyText>
   <LocalConfig />
   <PageSettings>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;
    </script>

</body>
</html>