<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
     <script type="text/javascript" src="jquery-1.7.2.min.js"></script> 
    <!--<script type="text/javascript" src="jquery.min.js"></script>-->
    <script type="text/javascript" src="ServicePage.aspx?js=1"></script>
    <title></title>
</head>
<body>
    <div>
        <input type="button" value="加载A5尺寸的主文档" onclick="document.WriterControl.LoadDocumentFromString(xmlforload, 'xml');" />
        <input type="button" value="查看A4尺寸的子文档" onclick="document.WriterControl.LoadDocumentFromString(xmlforsubdoc, 'xml');" />
        <input type="button" value="正常AppendSubDocument" onclick="exp();" />
        <input type="button" value="自适应AppendSubDocument" onclick="exp('true');" />
    </div>

    <div id="myWriterControl" style="width: 100%; border: 2px solid black; border-radius: 5px;height:900px;"
         LocalServerPort="2345"
         TransformUseBase64="false"
         FieldBorderPrintVisibility="None"
         FormView="Disable"
         ReadOnly="false"
         PreviewUseAdvancedLayout="false"
         BackgroundTextOutputMode="Underline"
         contentrendermode="NormalHTMLEditable"
         AutoSaveIntervalInSecond="0"
         workspacebackcolorstring="#B1CAEB"
         servicepageurl="ServicePage.aspx"
         useclassattribute="false"
         heightcompress="true"
         imagedataembedinhtml="true"
         ExcludeLogicDeleted="false"
         HeaderFooterEditable="true"
         UseDCWriterMiniJS="false"
         serversleepfordebug="0"
         allowcopy="true"
         supportactivex="false"
         pixelpagespacing="5"
         clientcontextmenutype="Custom"
         showdebuginfo="false"
         ismobiledevice="False"
         IndentHtmlCode="false"
         FreeSelection="true"
         urlencodecountforpostdata="0"
         AutoZoom="false"
         registercodeindex="0" />


    <script type="text/javascript">
        // HTML页面加载后执行本函数
        function BuildDCWriterControlFrame() {
            // 获得控件容器元素
            var ctl = document.getElementById("myWriterControl");
            // 绑定控件
            BindingDCWriterClientControl(ctl);
            // 创建编辑器框架
            ctl.BuildFrame(function () {
                ctl.LoadDocumentFromString(xmlforload, "xml");
            });
        }
        BuildDCWriterControlFrame();


        function exp(autofit) {
            var ctl = document.WriterControl;
            if (ctl != null) {
                ctl.GetContentContainer().focus();
                var file = new Array();
                file.push(xmlforsubdoc);

                //构造两个选项分别对应两个子文档
                var options = new Array();
                var attr1 = {
                    "Attributes": { "姓名": "张三", "科室": "胸外科", "床号": "12345" }, //自定义属性
                    //"NewPage": "false", //是否新起一页
                    //"ReadOnly": "false", //是否可编辑
                    "Title": "张三的病程记录", //病程收缩时显示的文档标题
                    "ToolTip": "提示：张三的病程记录", //病程鼠标移上去时的提示文本
                    "ID": "subdoc1",//
                    "TitleLevel": "0",//导航级别，从0到7的整数
                    //"CSSStyle": "border: 3px solid #FF0000; background-color: #FFFF00;", //自定义的样式
                    //"Parameters": { "emr.DE02.01.052.00": "汪汪汪", "fieldMedic": "王二麻子" },//绑定的数据格式
                    //"DataBindingXML": "<DataSourceName><Name>张三</Name></DataSourceName><DataSourceName2><Name>李四</Name></DataSourceName2>",
                    //"EnablePermission": "false",
                    "LoadOriginHeaderFooter": "false",
                    "AutoFitTableWidth": autofit //设置子文档内的表格列宽进行缩放适应主文档宽度
                };
                options.push(attr1);
                var options = {
                    Files: file,
                    Options: options,
                    Usebase64: "false",
                    ShowMaskUI: "true"
                };

                ctl.AppendSubDocuments(options);
            }
        }

        var xmlforsubdoc = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>1</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>6</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>2</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XTextTable" NumOfRows="1" NumOfColumns="2">
               <InnerID>14</InnerID>
               <ID>table1</ID>
               <XElements>
                  <Element xsi:type="XTextTableRow">
                     <InnerID>17</InnerID>
                     <XElements>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>18</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>33</InnerID>
                                 <Text>这是一个左右页边距为0.5的文档这是一个左右页边距为0.5的文档</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>19</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                        <Element xsi:type="XTextTableCell" StyleIndex="1">
                           <InnerID>20</InnerID>
                           <XElements>
                              <Element xsi:type="XString">
                                 <InnerID>34</InnerID>
                                 <Text>这是一个左右页边距为0.5的文档这是一个左右页边距为0.5的文档</Text>
                              </Element>
                              <Element xsi:type="XParagraphFlag">
                                 <InnerID>21</InnerID>
                              </Element>
                           </XElements>
                        </Element>
                     </XElements>
                  </Element>
               </XElements>
               <Columns>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>15</InnerID>
                     <Width>1180.375</Width>
                  </Element>
                  <Element xsi:type="XTextTableColumn">
                     <InnerID>16</InnerID>
                     <Width>1180.375</Width>
                  </Element>
               </Columns>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>7</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>8</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
         <Style Index="1">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <BorderWidth>1</BorderWidth>
            <BorderLeft>true</BorderLeft>
            <BorderBottom>true</BorderBottom>
            <BorderTop>true</BorderTop>
            <BorderRight>true</BorderRight>
            <PaddingLeft>15</PaddingLeft>
            <PaddingTop>10</PaddingTop>
            <PaddingRight>15</PaddingRight>
            <PaddingBottom>10</PaddingBottom>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
      <CreationTime>2023-02-20T11:14:15.2447868+08:00</CreationTime>
      <LastModifiedTime>2023-02-20T11:17:02.7771827+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>这是一个左右页边距为0.5的文档这是一个左右页边距为0.5的文档 这是一个左右页边距为0.5的文档这是一个左右页边距为0.5的文档 </BodyText>
   <LocalConfig />
   <PageSettings>
      <LeftMargin>19</LeftMargin>
      <RightMargin>19</RightMargin>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>`;

        var xmlforload = `<XTextDocument xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" EditorVersionString="0.0.0.0">
   <XElements>
      <Element xsi:type="XTextHeader">
         <InnerID>3104</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag" StyleIndex="0">
               <InnerID>3110</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextBody">
         <InnerID>3105</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XString">
               <InnerID>3126</InnerID>
               <Text>这是一个A5的文档</Text>
            </Element>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3109</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
      <Element xsi:type="XTextFooter">
         <InnerID>3106</InnerID>
         <AcceptTab>true</AcceptTab>
         <XElements>
            <Element xsi:type="XParagraphFlag">
               <InnerID>3111</InnerID>
               <AutoCreate>true</AutoCreate>
            </Element>
         </XElements>
      </Element>
   </XElements>
   <SerializeParameterValue>true</SerializeParameterValue>
   <FileFormat>XML</FileFormat>
   <ContentStyles>
      <Default xsi:type="DocumentContentStyle">
         <FontName>宋体</FontName>
         <FontSize>12</FontSize>
      </Default>
      <Styles>
         <Style Index="0">
            <FontName>宋体</FontName>
            <FontSize>12</FontSize>
            <Align>Center</Align>
         </Style>
      </Styles>
   </ContentStyles>
   <Info>
      <LicenseText>南京都昌公司2023年测试用旗舰版(2并发):南京都昌公司2023年测试用旗舰版(2并发)</LicenseText>
      <CreationTime>1980-01-01T00:00:00</CreationTime>
      <LastModifiedTime>2023-02-20T11:24:48.3640567+08:00</LastModifiedTime>
      <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
      <Operator>DCSoft.Writer Version:0.0.0.0</Operator>
      <NumOfPage>1</NumOfPage>
   </Info>
   <BodyText>这是一个A5的文档</BodyText>
   <LocalConfig />
   <PageSettings>
      <PaperKind>A5</PaperKind>
      <PaperWidth>583</PaperWidth>
      <PaperHeight>827</PaperHeight>
      <StrictUsePageSize>false</StrictUsePageSize>
   </PageSettings>
</XTextDocument>
`;

    </script>
</body>
</html>