<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="ServicePage.aspx?js=2"></script>
</head>
<body>
    <div>
        <div>
            <input type="button" value="前端JSON从头构造文档并直接刷新" onclick="NewDoc();" />
            <input type="button" value="打开本地文件" onclick="document.TemperatureControl.LoadDocumentFromFile();" />
        </div>
    </div>
    <div>
        <div id="WebTemperatureControl1"
             documentbuffername="DCTemperatureDocument"
             contentpixelheight="500"
             servicepageurl="ServicePage.aspx"
             pixelpagespacing="20"
             dc_height="900px"
             pageshadow="True"
             advancedmode= true
             align="center"
             formid="form1"
             style="height:900px;overflow:auto;position:relative;">
        </div>
    </div>
    <script type="text/javascript">

        //临时码申请日期20210507
        //var staticregcode = "04D7F9C7EA2C52F7DEBD43516209A06D255259BAFB265AFA24AFDA5918E2FCC3D22360D99A54B0501BE7160B3ACBAEDEEC42E6D0E5E3BBEC11E5F006F7A4933DE8C00264B192C304DD43AC92F36C87A215B2332C4495AAC4E83EBACB4EEB0ACC2E6A8CB7B3F250B0CB9061752504342AE5F244DD3B97D70878";

        var ctl = document.getElementById("WebTemperatureControl1");
        if (ctl != null) {
            InitializeDCTemperatureControl(ctl);

            //测试EventLinkClick事件
            ctl.EventLinkClick = function (str) {
                alert(str);
            };

            ctl.EventAfterRefreshView = function () {
                console.log("文档刷新了，结构如下：");
                console.log(ctl.Document);
            }
        }

        function NewDoc() {
            var ctl = document.getElementById("WebTemperatureControl1");
            if (ctl != null) {
                ctl.Document = ctl.NewDocument();
                ctl.Document.Config = GetConstructedDocumentConfig();
                ctl.Document.Values = GetConstructedDocumentDatas();
                ctl.RefreshView();
            }
        }


        function GetConstructedDocumentDatas() {
            var datas = new Array();
            //为Y轴"AY"组织数据
            var ay = new Object();
            ay.Name = "AY";
            ay.Datas = new Array();
            for (var i = 0; i < 7; i++) {
                //构造单个数据点
                var valuepoint = new Object();
                var temp = (Math.random() * 100);
                valuepoint.Value = temp.toString();
                valuepoint.Time = "2020-07-1" + (0 + i).toString() + " 14:50:00";  //这里构造一下连续7天的时间
                if (i == 0) {
                    valuepoint.LanternValue = (temp + 5).toString();  //测试灯笼数据点
                    valuepoint.Link = "#";
                }
                if (i == 6) {
                    valuepoint.Title = "测试TITLE属性";
                }
                ay.Datas.push(valuepoint);
            }

            //为Y轴"BY"组织数据
            var by = new Object();
            by.Name = "BY";
            by.Datas = new Array();
            for (var i = 0; i < 7; i++) {
                //构造单个数据点
                var valuepoint = new Object();
                valuepoint.Value = (Math.random() * 100).toString();
                valuepoint.Time = "2020-07-1" + (0 + i).toString() + " 14:50:00";  //这里构造一下连续7天的时间
                by.Datas.push(valuepoint);
            }

            //为Y轴"CY"组织数据，测试同一Y轴上不同的点用不同的图例
            var cy = new Object();
            cy.Name = "CY";
            cy.Datas = new Array();
            for (var i = 0; i < 7; i++) {
                //构造单个数据点
                var valuepoint = new Object();
                valuepoint.Value = (Math.random() * 100).toString();
                valuepoint.Time = "2020-07-1" + (0 + i).toString() + " 14:50:00";  //这里构造一下连续7天的时间
                switch (i) {
                    case 0:
                        valuepoint.SpecifySymbolStyle = "SolidCicle";
                        break;
                    case 1:
                        valuepoint.SpecifySymbolStyle = "SolidTriangle";
                        break;
                    case 2:
                        valuepoint.SpecifySymbolStyle = "Square";
                        break;
                    case 3:
                        valuepoint.SpecifySymbolStyle = "V";
                        break;
                    case 4:
                        valuepoint.SpecifySymbolStyle = "Diamond";
                        break;
                    case 5:
                        valuepoint.SpecifySymbolStyle = "Default";
                        break;
                    case 6:
                        valuepoint.SpecifySymbolStyle = "HollowDiamond";
                        break;
                    default:
                        break;
                }
                cy.Datas.push(valuepoint);
            }


            //为文本Y轴"EY"组织数据(就添加一个文本点看样子)
            var ey = new Object();
            ey.Name = "EY";
            ey.Datas = new Array();
            //构造单个数据点
            var valuepoint = new Object();
            valuepoint.Value = (Math.random() * 100).toString();
            valuepoint.Time = "2020-07-10 14:50:00";
            valuepoint.Text = "汪汪汪汪汪";
            valuepoint.Link = "测试EventLinkClick文本";
            ey.Datas.push(valuepoint);

            //为页脚数据行"NewLine2"组织数据(添加两个文本点测试颜色)
            var newline = new Object();
            newline.Name = "NewLine2";
            newline.Datas = new Array();
            //构造第一个文本数据不设置颜色
            var valuepoint = new Object();
            valuepoint.Time = "2020-07-10 14:50:00";
            valuepoint.Text = "文本点1";
            valuepoint.Link = "测试EventLinkClick文本1";
            //构造第二个文本数据设置颜色
            var valuepoint2 = new Object();
            valuepoint2.Time = "2020-07-11 14:50:00";
            valuepoint2.Text = "文本点2";
            valuepoint2.Link = "测试EventLinkClick文本2";
            valuepoint2.Title = "测试该文本点的自定义悬浮文本";
            valuepoint2.ColorValue = "#FFFF00";  //背景填充色
            valuepoint2.TextColorValue = "#FF0000";//文本色
            newline.Datas.push(valuepoint);
            newline.Datas.push(valuepoint2);

            //为页脚数据行"NewLine3"组织数据(测试甘特图效果)
            var newline2 = new Object();
            newline2.Name = "NewLine3";
            newline2.Datas = new Array();
            //构造第一个文本数据不设置颜色
            var valuepoint = new Object();
            valuepoint.Time = "2020-07-10 14:50:00";
            valuepoint.Text = "甘特图样式文本点";
            valuepoint.ColorValue = "#FF0000";
            valuepoint.EndTime = "2020-07-12 14:50:00";
            newline2.Datas.push(valuepoint);

            datas.push(ay);
            datas.push(by);
            datas.push(cy);
            datas.push(ey);
            datas.push(newline);
            datas.push(newline2);

            return datas;
        }

        function GetConstructedDocumentConfig() {
            var ctl = document.getElementById("WebTemperatureControl1");
            if (ctl != null) {
                //新建CONFIG对象
                var config = ctl.NewConfig();
                config.Title = "测试版大标题";

                //在CONFIG对象中新增三个页眉小标题
                var label = ctl.NewHeaderLabel();
                label.Title = "姓名";
                label.ParameterName = "姓名参数";
                label.Value = "张三";
                var label2 = ctl.NewHeaderLabel();
                label2.Title = "性别";
                label2.ParameterName = "性别参数";
                label2.Value = "男";
                var label3 = ctl.NewHeaderLabel();
                label3.Title = "床号";
                label3.ParameterName = "床号参数";
                label3.Value = "123";
                config.HeaderLabels.push(label);
                config.HeaderLabels.push(label2);
                config.HeaderLabels.push(label3);

                //在CONFIG对象中新增一个页眉数据行
                var line = ctl.NewTitleLine();
                line.Name = "NewLine";
                line.Title = "页眉数据行日期";
                line.ValueType = "SerialDate";//设置为日期

                var line2 = ctl.NewTitleLine();
                line2.ValueType = "HourTick";//设置为小时刻度
                //其它值维持默认
                config.HeaderLines.push(line);
                config.HeaderLines.push(line2);

                //在CONFIG对象中新增两个页脚数据行
                var line2 = ctl.NewTitleLine();
                line2.Name = "NewLine2";
                line2.Title = "TEXT数据行";
                line2.TickStep = "6";
                line2.ValueType = "Text";
                var line3 = ctl.NewTitleLine();
                line3.Name = "NewLine3";
                line3.Title = "DATA页脚数据行";
                line3.TickStep = "6";
                line3.ValueType = "Data";//用于甘特图
                line3.LayoutType = "Free";//自由排版，可用于显示甘特图
                //其它值维持默认
                config.FooterLines.push(line2);
                config.FooterLines.push(line3);

                //在CONFIG对象中新增五个Y轴，四个数据轴一个文本轴
                var yaxis = ctl.NewYAxis();
                yaxis.Name = "AY";
                yaxis.EnableLanternValue = true;
                yaxis.Title = "A轴";
                var yaxis2 = ctl.NewYAxis();
                yaxis2.Name = "BY";
                yaxis2.Title = "B轴";
                yaxis2.SymbolStyle = "Cross" //图例样式
                yaxis2.SymbolColorValue = "#008000";  //图例颜色
                var yaxis3 = ctl.NewYAxis();
                yaxis3.Name = "CY";
                yaxis3.Title = "C轴";
                yaxis3.SymbolStyle = "HollowSquare";
                yaxis3.SymbolColorValue = "#0000FF";
                var yaxis4 = ctl.NewYAxis();
                yaxis4.Name = "DY";
                yaxis4.Title = "D轴";
                yaxis4.SymbolStyle = "VReversed";
                yaxis4.SymbolColorValue = "#000000";
                var yaxis5 = ctl.NewYAxis();
                yaxis5.Name = "EY";
                yaxis5.Title = "文本轴";
                yaxis5.Style = "Text";
                config.YAxisInfos.push(yaxis);
                config.YAxisInfos.push(yaxis2);
                config.YAxisInfos.push(yaxis3);
                config.YAxisInfos.push(yaxis4);
                config.YAxisInfos.push(yaxis5);

                return config;
            }
            return null;
        }

        function RefreshWithRegCode() {
            var ctl = document.getElementById("WebTemperatureControl1");
            if (ctl != null && ctl.Document != null) {
                ctl.Document.RegisterCode = staticregcode;
                ctl.RefreshView();
            }
        }

        function ModifyTicks() {
            var ctl = document.TemperatureControl;
            if (ctl == null) {
                return;
            }
            ctl.Document.Config.TickTexts = "2,6,10,14,18,22";  //修改用于显示的刻度值
            ctl.Document.Config.TickValues = "2,6,10,14,18,22";     //修改用来实际计算刻度时间区域的刻度值
            ctl.RefreshView();
        }

    </script>
</body>
</html>